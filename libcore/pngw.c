/**
* Writer: Xiaolin.liu
* xiaolin.liu@mail.bnu.edu.cn
*
* This module contains basic functions for  calculation.
* Functions list:
* Kernel:
* 20xx.xx.xx, LOC
**/

#include "pngw.h"
#include <pngw_Datatypes.h>
#include <pngw_Upart.h>
#include <pngw_Utils.h>

extern size_t n_scpart_Func;
extern INT scpart_Func_lkList[171][2];

COMPLEX16 calculate_QpcWaveform(REAL8 lval, BBHCore *core)
{
    //SetBBHCoreDynVariables(eVal, vomVal, core);
    REAL8 Q_U, Q_E;
    COMPLEX16 Q_L, Q_LE;
    COMPLEX16 QPlusL, QPlusLE, QCrossL, QCrossLE;
    Q_U = calculate_QUPart_waveform(lval, core->var, core->pms);
    Q_E = calculate_QEPart_waveform(lval, core->var, core->pms);
    Q_L = calculate_QLPart_waveform(lval, core->var, core->pms);
    Q_LE = calculate_QLEPart_waveform(lval, core->var, core->pms);
    QPlusL = Q_L * core->pms->hPlusL;
    QPlusLE = Q_LE * core->pms->hPlusLE;
    QCrossL = Q_L * core->pms->hCrossL;
    QCrossLE = Q_LE * core->pms->hCrossLE;
    // return Q_U*core->pms->hPlusU + Q_E*core->pms->hPlusE + QPlusL + conj(QPlusL) + QPlusLE + conj(QPlusLE) -
    //     I*(QCrossL + conj(QCrossL) + QCrossLE + conj(QCrossLE));
    // return QPlusL + conj(QPlusL) + I*(QCrossL + conj(QCrossL));
    return Q_U*core->pms->hPlusU + Q_E*core->pms->hPlusE + QPlusL + conj(QPlusL) + QPlusLE + conj(QPlusLE) -
        I*(QCrossL + conj(QCrossL) + QCrossLE + conj(QCrossLE));
    // return Q_L;
}

REAL8 calculate_QWaveform(REAL8 tSIval, REAL8 lval, BBHCore *core, AntennaPatternF *apf)
{
    //SetBBHCoreDynVariables(eVal, vomVal, core);
    REAL8 Q_U, Q_E;
    COMPLEX16 Q_L, Q_LE;
    COMPLEX16 QPlusL, QPlusLE, QCrossL, QCrossLE;
    Q_U = calculate_QUPart_waveform(lval, core->var, core->pms);
    Q_E = calculate_QEPart_waveform(lval, core->var, core->pms);
    Q_L = calculate_QLPart_waveform(lval, core->var, core->pms);
    Q_LE = calculate_QLEPart_waveform(lval, core->var, core->pms);
    QPlusL = Q_L * core->pms->hPlusL;
    QPlusLE = Q_LE * core->pms->hPlusLE;
    QCrossL = Q_L * core->pms->hCrossL;
    QCrossLE = Q_LE * core->pms->hCrossLE;
    COMPLEX16 Qplus, Qcross;
    REAL8 Fp, Fc;
    Fp = calculate_barFplus_t(tSIval, apf);
    Fc = calculate_barFcross_t(tSIval, apf);
    // return Q_U*core->pms->hPlusU + Q_E*core->pms->hPlusE + QPlusL + conj(QPlusL) + QPlusLE + conj(QPlusLE) -
    //     I*(QCrossL + conj(QCrossL) + QCrossLE + conj(QCrossLE));
    // return QPlusL + conj(QPlusL) + I*(QCrossL + conj(QCrossL));
    Qplus = Q_U*core->pms->hPlusU + Q_E*core->pms->hPlusE + QPlusL + conj(QPlusL) + QPlusLE + conj(QPlusLE);
    Qcross = QCrossL + conj(QCrossL) + QCrossLE + conj(QCrossLE);
    return creal(Qplus*Fp + Qcross*Fc);
}

INT calculate_QpcWaveform_emode(INT n, INT m, REAL8 lval, BBHCore *core,
    COMPLEX16 *ret_QPlus, COMPLEX16 *ret_QCross)
{
    //SetBBHCoreDynVariables(eVal, vomVal, core);
    REAL8 Q_U, Q_E;
    COMPLEX16 Q_L, Q_LE;
    COMPLEX16 QPlusL, QPlusLE, QCrossL, QCrossLE;
    INT ilk = get_ilk_from_nm(n, m);
    Q_U = calculate_QUPart_waveform_emode(ilk, lval, core->var, core->pms);
    Q_E = calculate_QEPart_waveform_emode(ilk, lval, core->var, core->pms);
    Q_L = calculate_QLPart_waveform_emode(ilk, lval, core->var, core->pms);
    Q_LE = calculate_QLEPart_waveform_emode(ilk, lval, core->var, core->pms);
    QPlusL = Q_L * core->pms->hPlusL;
    QPlusLE = Q_LE * core->pms->hPlusLE;
    QCrossL = Q_L * core->pms->hCrossL;
    QCrossLE = Q_LE * core->pms->hCrossLE;
    *ret_QPlus = Q_U*core->pms->hPlusU + Q_E*core->pms->hPlusE + QPlusL + conj(QPlusL) + QPlusLE + conj(QPlusLE);
    *ret_QCross = QCrossL + conj(QCrossL) + QCrossLE + conj(QCrossLE);
    return X_SUCCESS;
}

COMPLEX16 calculate_QpcWaveform_eexp(INT n, INT m, REAL8 lval, BBHCore *core)
{
    COMPLEX16 Qplus_U, Qplus_E, Qminus_U, Qminus_E, status;
    COMPLEX16 Qplus_L, Qminus_L, Qplus_LE, Qminus_LE;
    COMPLEX16 QPlus, QMinus;
    INT ilk = get_ilk_from_nm(n, m);
    REAL8 k = calculate_k(core->var, core->pms);
    status = calculate_QUPart_waveform_ecoeff(ilk, lval, core->var, core->pms, &Qplus_U, &Qminus_U);
    status = calculate_QEPart_waveform_ecoeff(ilk, lval, core->var, core->pms, &Qplus_E, &Qminus_E);
    status = calculate_QLPart_waveform_ecoeff(ilk, lval, core->var, core->pms, &Qplus_L, &Qminus_L);
    status = calculate_QLEPart_waveform_ecoeff(ilk, lval, core->var, core->pms, &Qplus_LE, &Qminus_LE);
    QPlus = Qplus_U*core->pms->hPlusU + Qplus_E*core->pms->hPlusE +
        Qplus_L * core->pms->hPlusL + conj(Qminus_L * core->pms->hPlusL) +
        Qplus_LE * core->pms->hPlusLE + conj(Qminus_LE * core->pms->hPlusLE) -
        I*(Qplus_L * core->pms->hCrossL + conj(Qminus_L * core->pms->hCrossL) +
        Qplus_LE * core->pms->hCrossLE + conj(Qminus_LE * core->pms->hCrossLE));
    QMinus = Qminus_U*core->pms->hPlusU + Qminus_E*core->pms->hPlusE +
        Qminus_L * core->pms->hPlusL + conj(Qplus_L * core->pms->hPlusL) +
        Qminus_LE * core->pms->hPlusLE + conj(Qplus_LE * core->pms->hPlusLE) -
        I*(Qminus_L * core->pms->hCrossL + conj(Qplus_L * core->pms->hCrossL) +
        Qminus_LE * core->pms->hCrossLE + conj(Qplus_LE * core->pms->hCrossLE));
    // print_debug("Q = %.5e + I %.5e, %.5e + I %.5e\n",
    //     creal(QPlus), cimag(QPlus), creal(QMinus), cimag(QMinus));
    return QPlus * cexp(-I*(m + n*k)*lval) + QMinus * cexp(I*(m + n*k)*lval);
}

INT calculate_QpcWaveform_eexp_emode(INT n, INT m, REAL8 lval, BBHCore *core,
    COMPLEX16 *ret_QMp, COMPLEX16 *ret_QMc)
{
    COMPLEX16 Qplus_U, Qplus_E, Qminus_U, Qminus_E, status;
    COMPLEX16 Qplus_L, Qminus_L, Qplus_LE, Qminus_LE;
    COMPLEX16 QPlus, QMinus;
    INT ilk = get_ilk_from_nm(n, m);
    REAL8 k = calculate_k(core->var, core->pms);
    status = calculate_QUPart_waveform_ecoeff(ilk, lval, core->var, core->pms, &Qplus_U, &Qminus_U);
    status = calculate_QEPart_waveform_ecoeff(ilk, lval, core->var, core->pms, &Qplus_E, &Qminus_E);
    status = calculate_QLPart_waveform_ecoeff(ilk, lval, core->var, core->pms, &Qplus_L, &Qminus_L);
    status = calculate_QLEPart_waveform_ecoeff(ilk, lval, core->var, core->pms, &Qplus_LE, &Qminus_LE);
    // QPlus = Qplus_U*core->pms->hPlusU + Qplus_E*core->pms->hPlusE +
    //     Qplus_L * core->pms->hPlusL + conj(Qminus_L * core->pms->hPlusL) +
    //     Qplus_LE * core->pms->hPlusLE + conj(Qminus_LE * core->pms->hPlusLE) -
    //     I*(Qplus_L * core->pms->hCrossL + conj(Qminus_L * core->pms->hCrossL) +
    //     Qplus_LE * core->pms->hCrossLE + conj(Qminus_LE * core->pms->hCrossLE));
    QMinus = Qminus_U*core->pms->hPlusU + Qminus_E*core->pms->hPlusE +
        Qminus_L * core->pms->hPlusL + conj(Qplus_L * core->pms->hPlusL) +
        Qminus_LE * core->pms->hPlusLE + conj(Qplus_LE * core->pms->hPlusLE) -
        I*(Qminus_L * core->pms->hCrossL + conj(Qplus_L * core->pms->hCrossL) +
        Qminus_LE * core->pms->hCrossLE + conj(Qplus_LE * core->pms->hCrossLE));
    // print_debug("Q = %.5e + I %.5e, %.5e + I %.5e\n",
    //     creal(QPlus), cimag(QPlus), creal(QMinus), cimag(QMinus));
    // return QPlus * cexp(-I*(m + n*k)*lval) + QMinus * cexp(I*(m + n*k)*lval);
    *ret_QMp = Qminus_U*core->pms->hPlusU + Qminus_E*core->pms->hPlusE +
        Qminus_L * core->pms->hPlusL + conj(Qplus_L * core->pms->hPlusL) +
        Qminus_LE * core->pms->hPlusLE + conj(Qplus_LE * core->pms->hPlusLE);
    *ret_QMc = Qminus_L * core->pms->hCrossL + conj(Qplus_L * core->pms->hCrossL) +
        Qminus_LE * core->pms->hCrossLE + conj(Qplus_LE * core->pms->hCrossLE);
    return X_SUCCESS;
}


COMPLEX16 calculate_QpcWaveform_QhMinus(INT n, INT m, REAL8 lval, BBHCore *core)
{
    COMPLEX16 Qplus_U, Qplus_E, Qminus_U, Qminus_E, status;
    COMPLEX16 Qplus_L, Qminus_L, Qplus_LE, Qminus_LE;
    COMPLEX16 QPlus, QMinus;
    INT ilk = get_ilk_from_nm(n, m);
    // REAL8 k = calculate_k(core->var, core->pms);
    status = calculate_QUPart_waveform_ecoeff(ilk, lval, core->var, core->pms, &Qplus_U, &Qminus_U);
    status = calculate_QEPart_waveform_ecoeff(ilk, lval, core->var, core->pms, &Qplus_E, &Qminus_E);
    status = calculate_QLPart_waveform_ecoeff(ilk, lval, core->var, core->pms, &Qplus_L, &Qminus_L);
    status = calculate_QLEPart_waveform_ecoeff(ilk, lval, core->var, core->pms, &Qplus_LE, &Qminus_LE);
    // QPlus = Qplus_U*core->pms->hPlusU + Qplus_E*core->pms->hPlusE +
    //     Qplus_L * core->pms->hPlusL + conj(Qminus_L * core->pms->hPlusL) +
    //     Qplus_LE * core->pms->hPlusLE + conj(Qminus_LE * core->pms->hPlusLE) -
    //     I*(Qplus_L * core->pms->hCrossL + conj(Qminus_L * core->pms->hCrossL) +
    //     Qplus_LE * core->pms->hCrossLE + conj(Qminus_LE * core->pms->hCrossLE));
    QMinus = Qminus_U*core->pms->hPlusU + Qminus_E*core->pms->hPlusE +
        Qminus_L * core->pms->hPlusL + conj(Qplus_L * core->pms->hPlusL) +
        Qminus_LE * core->pms->hPlusLE + conj(Qplus_LE * core->pms->hPlusLE) -
        I*(Qminus_L * core->pms->hCrossL + conj(Qplus_L * core->pms->hCrossL) +
        Qminus_LE * core->pms->hCrossLE + conj(Qplus_LE * core->pms->hCrossLE));
    // print_debug("Q = %.5e + I %.5e, %.5e + I %.5e\n",
    //     creal(QPlus), cimag(QPlus), creal(QMinus), cimag(QMinus));
    return QMinus;
}

INT calculate_QpcWaveformVec(REAL8Vector *lVec, REAL8Vector *etVec, REAL8Vector *vomVec, BBHCore *core,
    REAL8Vector **QplusVec, REAL8Vector **QcrossVec)
{
    REAL8Vector *ret_QplusVec = CreateREAL8Vector(lVec->length);
    REAL8Vector *ret_QcrossVec = CreateREAL8Vector(lVec->length);
    COMPLEX16 Qpc;
    for (INT i = 0; i < lVec->length; i++) {
        SetBBHCoreDynVariables(etVec->data[i], vomVec->data[i], core);
        Qpc = calculate_QpcWaveform(lVec->data[i], core);
        ret_QplusVec->data[i] = creal(Qpc);
        ret_QcrossVec->data[i] = -cimag(Qpc);
    }
    *QplusVec = ret_QplusVec;
    *QcrossVec = ret_QcrossVec;
    return X_SUCCESS;
}

INT calculate_QpcWaveformVec_emode(INT n, INT m, REAL8Vector *lVec, REAL8Vector *etVec, REAL8Vector *vomVec, BBHCore *core,
    REAL8Vector **QplusVec, REAL8Vector **QcrossVec)
{
    REAL8Vector *ret_QplusVec = CreateREAL8Vector(lVec->length);
    REAL8Vector *ret_QcrossVec = CreateREAL8Vector(lVec->length);
    COMPLEX16 QPlus, QCross;
    for (INT i = 0; i < lVec->length; i++) {
        SetBBHCoreDynVariables(etVec->data[i], vomVec->data[i], core);
        calculate_QpcWaveform_emode(n, m, lVec->data[i], core, &QPlus, &QCross);
        ret_QplusVec->data[i] = creal(QPlus);
        ret_QcrossVec->data[i] = creal(QCross);
    }
    *QplusVec = ret_QplusVec;
    *QcrossVec = ret_QcrossVec;
    return X_SUCCESS;
}

INT calculate_QpcWaveformVec_eexp(INT n, INT m, REAL8Vector *lVec, REAL8Vector *etVec, REAL8Vector *vomVec, BBHCore *core,
    REAL8Vector **QplusVec, REAL8Vector **QcrossVec)
{
    REAL8Vector *ret_QplusVec = CreateREAL8Vector(lVec->length);
    REAL8Vector *ret_QcrossVec = CreateREAL8Vector(lVec->length);
    COMPLEX16 Qpc;
    // print_debug("here\n");
    for (INT i = 0; i < lVec->length; i++) {
        SetBBHCoreDynVariables(etVec->data[i], vomVec->data[i], core);
        Qpc = calculate_QpcWaveform_eexp(n, m, lVec->data[i], core);
        ret_QplusVec->data[i] = creal(Qpc);
        ret_QcrossVec->data[i] = cimag(Qpc);
    }
    *QplusVec = ret_QplusVec;
    *QcrossVec = ret_QcrossVec;
    return X_SUCCESS;
}


// BBHDynParams *pms = core->pms;
// BBHDynVariables *var = core->var;
REAL8 Calculate_l(BBHCore *core)
{
    BBHDynParams *pms = core->pms;
    BBHDynVariables *var = core->var;
    REAL8 chiv = pow(pms->vomini / var->vom, 19./6.);
    REAL8 chiv2 = chiv*chiv;
    REAL8 chiv4 = chiv2*chiv2;
    REAL8 chiv6 = chiv4*chiv2;
    REAL8 chiv8 = chiv6*chiv2;
    REAL8 chiv10 = chiv8*chiv2;
    REAL8 chiv12 = chiv10*chiv2;
    REAL8 chiv14 = chiv12*chiv2;

    REAL8 e02 = pms->eini*pms->eini;
    REAL8 e04 = e02*e02;
    REAL8 e06 = e04*e02;
    REAL8 e08 = e06*e02;
    REAL8 e010 = e08*e02;
    REAL8 e012 = e010*e02;
    REAL8 e014 = e012*e02;

    REAL8 pref = - 1./(32.*var->vom5*pms->eta);

	REAL8 PartPN4e08=-379.7083724581311507450189272083966252872325036079725631826533*chiv2 + 16903.84672378338978005929633627581145874881*chiv4 - 60332.55677966814632661133694703948714452685*chiv6 + 48480.52139008021422303689225663800365878815*chiv8 - 348.0371226849208666719015877984494508877179928461564376528764*chiv2*pms->eta - 8486.54528476533862817439622612821209328242*chiv4*pms->eta + 40976.08121366983931727700929190431020953773*chiv6*pms->eta - 36723.29411472452449264252673339400267182143*chiv8*pms->eta + 18.5037450593255646651839133297665747596360524494957221896144*chiv2*pms->eta2 + 2139.20530876018859553014534280555799569648*chiv4*pms->eta2 - 9811.93930452647330381046591708829887378753*chiv6*pms->eta2 + 8823.25641131688707562521132573395276137069*chiv8*pms->eta2 - 1.1897112058643863598984531943661068412003922525378519935548*chiv2*pms->sigx2 + 22.9002739216185933946727691993836884473719111492519405924971*chiv4*pms->sigx2 - 62.3596715110445154155900870983244507081801147991554756389279*chiv6*pms->sigx2 + 42.2642234261316900002967026690207850443901140789580198702956*chiv8*pms->sigx2 - 170.0769758644392326672223523076417084289952054932372762960311*chiv2*pms->eta*pms->sigx2 - 779.4538155373273542730734567879284274691412900424382578860049*chiv4*pms->eta*pms->sigx2 + 4324.61497378664074965880189855988077303138*chiv6*pms->eta*pms->sigx2 - 3624.93700996192878765243163700517154631771*chiv8*pms->eta*pms->sigx2 + 42.5192439661098081668055880769104271072488013733093190740078*chiv2*pms->kappa1*pms->sigx2 + 194.8634538843318385682683641969821068672853225106095644715011*chiv4*pms->kappa1*pms->sigx2 - 1081.1537434466601874147004746399701932578445189612998331470411*chiv6*pms->kappa1*pms->sigx2 + 906.2342524904821969131079092512928865794268545158533550390502*chiv8*pms->kappa1*pms->sigx2 - 42.5192439661098081668055880769104271072488013733093190740078*chiv2*pms->dm*pms->kappa1*pms->sigx2 - 194.8634538843318385682683641969821068672853225106095644715011*chiv4*pms->dm*pms->kappa1*pms->sigx2 + 1081.1537434466601874147004746399701932578445189612998331470411*chiv6*pms->dm*pms->kappa1*pms->sigx2 - 906.2342524904821969131079092512928865794268545158533550390502*chiv8*pms->dm*pms->kappa1*pms->sigx2 - 85.0384879322196163336111761538208542144976027466186381480155*chiv2*pms->eta*pms->kappa1*pms->sigx2 - 389.7269077686636771365367283939642137345706450212191289430024*chiv4*pms->eta*pms->kappa1*pms->sigx2 + 2162.30748689332037482940094927994038651569*chiv6*pms->eta*pms->kappa1*pms->sigx2 - 1812.4685049809643938262158185025857731588537090317067100781005*chiv8*pms->eta*pms->kappa1*pms->sigx2 + 42.5192439661098081668055880769104271072488013733093190740078*chiv2*pms->kappa2*pms->sigx2 + 194.8634538843318385682683641969821068672853225106095644715011*chiv4*pms->kappa2*pms->sigx2 - 1081.1537434466601874147004746399701932578445189612998331470411*chiv6*pms->kappa2*pms->sigx2 + 906.2342524904821969131079092512928865794268545158533550390502*chiv8*pms->kappa2*pms->sigx2 + 42.5192439661098081668055880769104271072488013733093190740078*chiv2*pms->dm*pms->kappa2*pms->sigx2 + 194.8634538843318385682683641969821068672853225106095644715011*chiv4*pms->dm*pms->kappa2*pms->sigx2 - 1081.1537434466601874147004746399701932578445189612998331470411*chiv6*pms->dm*pms->kappa2*pms->sigx2 + 906.2342524904821969131079092512928865794268545158533550390502*chiv8*pms->dm*pms->kappa2*pms->sigx2 - 85.0384879322196163336111761538208542144976027466186381480155*chiv2*pms->eta*pms->kappa2*pms->sigx2 - 389.7269077686636771365367283939642137345706450212191289430024*chiv4*pms->eta*pms->kappa2*pms->sigx2 + 2162.30748689332037482940094927994038651569*chiv6*pms->eta*pms->kappa2*pms->sigx2 - 1812.4685049809643938262158185025857731588537090317067100781005*chiv8*pms->eta*pms->kappa2*pms->sigx2 + 170.0769758644392326672223523076417084289952054932372762960311*chiv2*pms->dm*pms->sigx*pms->sx + 779.4538155373273542730734567879284274691412900424382578860049*chiv4*pms->dm*pms->sigx*pms->sx - 4324.61497378664074965880189855988077303138*chiv6*pms->dm*pms->sigx*pms->sx + 3624.93700996192878765243163700517154631771*chiv8*pms->dm*pms->sigx*pms->sx - 85.0384879322196163336111761538208542144976027466186381480155*chiv2*pms->kappa1*pms->sigx*pms->sx - 389.7269077686636771365367283939642137345706450212191289430024*chiv4*pms->kappa1*pms->sigx*pms->sx + 2162.30748689332037482940094927994038651569*chiv6*pms->kappa1*pms->sigx*pms->sx - 1812.4685049809643938262158185025857731588537090317067100781005*chiv8*pms->kappa1*pms->sigx*pms->sx + 85.0384879322196163336111761538208542144976027466186381480155*chiv2*pms->dm*pms->kappa1*pms->sigx*pms->sx + 389.7269077686636771365367283939642137345706450212191289430024*chiv4*pms->dm*pms->kappa1*pms->sigx*pms->sx - 2162.30748689332037482940094927994038651569*chiv6*pms->dm*pms->kappa1*pms->sigx*pms->sx + 1812.4685049809643938262158185025857731588537090317067100781005*chiv8*pms->dm*pms->kappa1*pms->sigx*pms->sx + 85.0384879322196163336111761538208542144976027466186381480155*chiv2*pms->kappa2*pms->sigx*pms->sx + 389.7269077686636771365367283939642137345706450212191289430024*chiv4*pms->kappa2*pms->sigx*pms->sx - 2162.30748689332037482940094927994038651569*chiv6*pms->kappa2*pms->sigx*pms->sx + 1812.4685049809643938262158185025857731588537090317067100781005*chiv8*pms->kappa2*pms->sigx*pms->sx + 85.0384879322196163336111761538208542144976027466186381480155*chiv2*pms->dm*pms->kappa2*pms->sigx*pms->sx + 389.7269077686636771365367283939642137345706450212191289430024*chiv4*pms->dm*pms->kappa2*pms->sigx*pms->sx - 2162.30748689332037482940094927994038651569*chiv6*pms->dm*pms->kappa2*pms->sigx*pms->sx + 1812.4685049809643938262158185025857731588537090317067100781005*chiv8*pms->dm*pms->kappa2*pms->sigx*pms->sx + 170.0769758644392326672223523076417084289952054932372762960311*chiv2*pms->sx2 + 779.4538155373273542730734567879284274691412900424382578860049*chiv4*pms->sx2 - 4324.61497378664074965880189855988077303138*chiv6*pms->sx2 + 3624.93700996192878765243163700517154631771*chiv8*pms->sx2 + 85.0384879322196163336111761538208542144976027466186381480155*chiv2*pms->kappa1*pms->sx2 + 389.7269077686636771365367283939642137345706450212191289430024*chiv4*pms->kappa1*pms->sx2 - 2162.30748689332037482940094927994038651569*chiv6*pms->kappa1*pms->sx2 + 1812.4685049809643938262158185025857731588537090317067100781005*chiv8*pms->kappa1*pms->sx2 + 85.0384879322196163336111761538208542144976027466186381480155*chiv2*pms->kappa2*pms->sx2 + 389.7269077686636771365367283939642137345706450212191289430024*chiv4*pms->kappa2*pms->sx2 - 2162.30748689332037482940094927994038651569*chiv6*pms->kappa2*pms->sx2 + 1812.4685049809643938262158185025857731588537090317067100781005*chiv8*pms->kappa2*pms->sx2;
	REAL8 PartPN4e06=-211.8388313673431916905691517202018601716677315029921692777662*chiv2 + 4171.58973450345390589402584061375706012902*chiv4 - 5519.43944057150661549498839359013063254173*chiv6 - 194.1694802901822711253257190468640145463783506258113829674309*chiv2*pms->eta - 2094.33898507345651554635709704060941589937*chiv4*pms->eta + 3748.63938879194437329287114798041236945515*chiv6*pms->eta + 10.3232164829839226949395462784197779580974410152618832212552*chiv2*pms->eta2 + 527.9204817601401751143357847859795926368004831171734308909724*chiv4*pms->eta2 - 897.6315222919193151845867104408193974214288157039772921582709*chiv6*pms->eta2 - 0.6637384103052250342762808136769355605920702873611460869078*chiv2*pms->sigx2 + 5.6514087692437260245178629071609275649543199033098364224639*chiv4*pms->sigx2 - 5.7048871921027784190007181696932389453165076433774494716322*chiv6*pms->sigx2 - 94.8857344818947788130613615378158314446403089062368840762191*chiv2*pms->eta*pms->sigx2 - 192.3563073273835664256919577506024367722901605747359412652297*chiv4*pms->eta*pms->sigx2 + 395.6313427719346337334564481378885811018775007694675284702985*chiv6*pms->eta*pms->sigx2 + 23.7214336204736947032653403844539578611600772265592210190547*chiv2*pms->kappa1*pms->sigx2 + 48.0890768318458916064229894376506091930725401436839853163074*chiv4*pms->kappa1*pms->sigx2 - 98.9078356929836584333641120344721452754693751923668821175745*chiv6*pms->kappa1*pms->sigx2 - 23.7214336204736947032653403844539578611600772265592210190547*chiv2*pms->dm*pms->kappa1*pms->sigx2 - 48.0890768318458916064229894376506091930725401436839853163074*chiv4*pms->dm*pms->kappa1*pms->sigx2 + 98.9078356929836584333641120344721452754693751923668821175745*chiv6*pms->dm*pms->kappa1*pms->sigx2 - 47.4428672409473894065306807689079157223201544531184420381096*chiv2*pms->eta*pms->kappa1*pms->sigx2 - 96.1781536636917832128459788753012183861450802873679706326148*chiv4*pms->eta*pms->kappa1*pms->sigx2 + 197.8156713859673168667282240689442905509387503847337642351493*chiv6*pms->eta*pms->kappa1*pms->sigx2 + 23.7214336204736947032653403844539578611600772265592210190547*chiv2*pms->kappa2*pms->sigx2 + 48.0890768318458916064229894376506091930725401436839853163074*chiv4*pms->kappa2*pms->sigx2 - 98.9078356929836584333641120344721452754693751923668821175745*chiv6*pms->kappa2*pms->sigx2 + 23.7214336204736947032653403844539578611600772265592210190547*chiv2*pms->dm*pms->kappa2*pms->sigx2 + 48.0890768318458916064229894376506091930725401436839853163074*chiv4*pms->dm*pms->kappa2*pms->sigx2 - 98.9078356929836584333641120344721452754693751923668821175745*chiv6*pms->dm*pms->kappa2*pms->sigx2 - 47.4428672409473894065306807689079157223201544531184420381096*chiv2*pms->eta*pms->kappa2*pms->sigx2 - 96.1781536636917832128459788753012183861450802873679706326148*chiv4*pms->eta*pms->kappa2*pms->sigx2 + 197.8156713859673168667282240689442905509387503847337642351493*chiv6*pms->eta*pms->kappa2*pms->sigx2 + 94.8857344818947788130613615378158314446403089062368840762191*chiv2*pms->dm*pms->sigx*pms->sx + 192.3563073273835664256919577506024367722901605747359412652297*chiv4*pms->dm*pms->sigx*pms->sx - 395.6313427719346337334564481378885811018775007694675284702985*chiv6*pms->dm*pms->sigx*pms->sx - 47.4428672409473894065306807689079157223201544531184420381096*chiv2*pms->kappa1*pms->sigx*pms->sx - 96.1781536636917832128459788753012183861450802873679706326148*chiv4*pms->kappa1*pms->sigx*pms->sx + 197.8156713859673168667282240689442905509387503847337642351493*chiv6*pms->kappa1*pms->sigx*pms->sx + 47.4428672409473894065306807689079157223201544531184420381096*chiv2*pms->dm*pms->kappa1*pms->sigx*pms->sx + 96.1781536636917832128459788753012183861450802873679706326148*chiv4*pms->dm*pms->kappa1*pms->sigx*pms->sx - 197.8156713859673168667282240689442905509387503847337642351493*chiv6*pms->dm*pms->kappa1*pms->sigx*pms->sx + 47.4428672409473894065306807689079157223201544531184420381096*chiv2*pms->kappa2*pms->sigx*pms->sx + 96.1781536636917832128459788753012183861450802873679706326148*chiv4*pms->kappa2*pms->sigx*pms->sx - 197.8156713859673168667282240689442905509387503847337642351493*chiv6*pms->kappa2*pms->sigx*pms->sx + 47.4428672409473894065306807689079157223201544531184420381096*chiv2*pms->dm*pms->kappa2*pms->sigx*pms->sx + 96.1781536636917832128459788753012183861450802873679706326148*chiv4*pms->dm*pms->kappa2*pms->sigx*pms->sx - 197.8156713859673168667282240689442905509387503847337642351493*chiv6*pms->dm*pms->kappa2*pms->sigx*pms->sx + 94.8857344818947788130613615378158314446403089062368840762191*chiv2*pms->sx2 + 192.3563073273835664256919577506024367722901605747359412652297*chiv4*pms->sx2 - 395.6313427719346337334564481378885811018775007694675284702985*chiv6*pms->sx2 + 47.4428672409473894065306807689079157223201544531184420381096*chiv2*pms->kappa1*pms->sx2 + 96.1781536636917832128459788753012183861450802873679706326148*chiv4*pms->kappa1*pms->sx2 - 197.8156713859673168667282240689442905509387503847337642351493*chiv6*pms->kappa1*pms->sx2 + 47.4428672409473894065306807689079157223201544531184420381096*chiv2*pms->kappa2*pms->sx2 + 96.1781536636917832128459788753012183861450802873679706326148*chiv4*pms->kappa2*pms->sx2 - 197.8156713859673168667282240689442905509387503847337642351493*chiv6*pms->kappa2*pms->sx2;
	REAL8 PartPN4e04=-94.9815624783504203938427518210308519414617994400784709890808*chiv2 + 572.4480646805822994546120322960798132467142390324328910632067*chiv4 - 87.0592067777704599250651882230829599250651882230829599250652*chiv2*pms->eta - 287.396502315226052088215117740149832576019995788930320380898*chiv4*pms->eta + 4.628590636698675349991139464823675349991139464823675349991*chiv2*pms->eta2 + 72.4440986104796629106641943612418580326154138734369799838349*chiv4*pms->eta2 - 0.2975984661582934609250398724082934609250398724082934609249*chiv2*pms->sigx2 + 0.7755168217800599058622165169020111253744116388532306375695*chiv4*pms->sigx2 - 42.5436415968899521531100478468899521531100478468899521531099*chiv2*pms->eta*pms->sigx2 - 26.396170972400513478818998716302952503209242618741976893453*chiv4*pms->eta*pms->sigx2 + 10.6359103992224880382775119617224880382775119617224880382774*chiv2*pms->kappa1*pms->sigx2 + 6.5990427431001283697047496790757381258023106546854942233632*chiv4*pms->kappa1*pms->sigx2 - 10.6359103992224880382775119617224880382775119617224880382774*chiv2*pms->dm*pms->kappa1*pms->sigx2 - 6.5990427431001283697047496790757381258023106546854942233632*chiv4*pms->dm*pms->kappa1*pms->sigx2 - 21.271820798444976076555023923444976076555023923444976076555*chiv2*pms->eta*pms->kappa1*pms->sigx2 - 13.1980854862002567394094993581514762516046213093709884467265*chiv4*pms->eta*pms->kappa1*pms->sigx2 + 10.6359103992224880382775119617224880382775119617224880382774*chiv2*pms->kappa2*pms->sigx2 + 6.5990427431001283697047496790757381258023106546854942233632*chiv4*pms->kappa2*pms->sigx2 + 10.6359103992224880382775119617224880382775119617224880382774*chiv2*pms->dm*pms->kappa2*pms->sigx2 + 6.5990427431001283697047496790757381258023106546854942233632*chiv4*pms->dm*pms->kappa2*pms->sigx2 - 21.271820798444976076555023923444976076555023923444976076555*chiv2*pms->eta*pms->kappa2*pms->sigx2 - 13.1980854862002567394094993581514762516046213093709884467265*chiv4*pms->eta*pms->kappa2*pms->sigx2 + 42.5436415968899521531100478468899521531100478468899521531099*chiv2*pms->dm*pms->sigx*pms->sx + 26.396170972400513478818998716302952503209242618741976893453*chiv4*pms->dm*pms->sigx*pms->sx - 21.271820798444976076555023923444976076555023923444976076555*chiv2*pms->kappa1*pms->sigx*pms->sx - 13.1980854862002567394094993581514762516046213093709884467265*chiv4*pms->kappa1*pms->sigx*pms->sx + 21.271820798444976076555023923444976076555023923444976076555*chiv2*pms->dm*pms->kappa1*pms->sigx*pms->sx + 13.1980854862002567394094993581514762516046213093709884467265*chiv4*pms->dm*pms->kappa1*pms->sigx*pms->sx + 21.271820798444976076555023923444976076555023923444976076555*chiv2*pms->kappa2*pms->sigx*pms->sx + 13.1980854862002567394094993581514762516046213093709884467265*chiv4*pms->kappa2*pms->sigx*pms->sx + 21.271820798444976076555023923444976076555023923444976076555*chiv2*pms->dm*pms->kappa2*pms->sigx*pms->sx + 13.1980854862002567394094993581514762516046213093709884467265*chiv4*pms->dm*pms->kappa2*pms->sigx*pms->sx + 42.5436415968899521531100478468899521531100478468899521531099*chiv2*pms->sx2 + 26.396170972400513478818998716302952503209242618741976893453*chiv4*pms->sx2 + 21.271820798444976076555023923444976076555023923444976076555*chiv2*pms->kappa1*pms->sx2 + 13.1980854862002567394094993581514762516046213093709884467265*chiv4*pms->kappa1*pms->sx2 + 21.271820798444976076555023923444976076555023923444976076555*chiv2*pms->kappa2*pms->sx2 + 13.1980854862002567394094993581514762516046213093709884467265*chiv4*pms->kappa2*pms->sx2;
	REAL8 PartPN4e02=-26.0677655673354148056529008909961290913671866052818433770814*chiv2 - 23.8934687274531024531024531024531024531024531024531024531023*chiv2*pms->eta + 1.2703203914141414141414141414141414141414141414141414141414*chiv2*pms->eta2 - 0.0816761363636363636363636363636363636363636363636363636364*chiv2*pms->sigx2 - 11.6761363636363636363636363636363636363636363636363636363636*chiv2*pms->eta*pms->sigx2 + 2.9190340909090909090909090909090909090909090909090909090909*chiv2*pms->kappa1*pms->sigx2 - 2.9190340909090909090909090909090909090909090909090909090909*chiv2*pms->dm*pms->kappa1*pms->sigx2 - 5.8380681818181818181818181818181818181818181818181818181817*chiv2*pms->eta*pms->kappa1*pms->sigx2 + 2.9190340909090909090909090909090909090909090909090909090909*chiv2*pms->kappa2*pms->sigx2 + 2.9190340909090909090909090909090909090909090909090909090909*chiv2*pms->dm*pms->kappa2*pms->sigx2 - 5.8380681818181818181818181818181818181818181818181818181817*chiv2*pms->eta*pms->kappa2*pms->sigx2 + 11.6761363636363636363636363636363636363636363636363636363636*chiv2*pms->dm*pms->sigx*pms->sx - 5.8380681818181818181818181818181818181818181818181818181817*chiv2*pms->kappa1*pms->sigx*pms->sx + 5.8380681818181818181818181818181818181818181818181818181817*chiv2*pms->dm*pms->kappa1*pms->sigx*pms->sx + 5.8380681818181818181818181818181818181818181818181818181817*chiv2*pms->kappa2*pms->sigx*pms->sx + 5.8380681818181818181818181818181818181818181818181818181817*chiv2*pms->dm*pms->kappa2*pms->sigx*pms->sx + 11.6761363636363636363636363636363636363636363636363636363636*chiv2*pms->sx2 + 5.8380681818181818181818181818181818181818181818181818181817*chiv2*pms->kappa1*pms->sx2 + 5.8380681818181818181818181818181818181818181818181818181817*chiv2*pms->kappa2*pms->sx2;
	REAL8 PartPN4e00=-52.731161619740488788107835726883345930964978584026203073822 + 16.5128968253968253968253968253968253968253968253968253968253*pms->eta + 21.4236111111111111111111111111111111111111111111111111111111*pms->eta2 - 0.3125*pms->sigx2 + 75.*pms->eta*pms->sigx2 - 18.75*pms->kappa1*pms->sigx2 + 18.75*pms->dm*pms->kappa1*pms->sigx2 + 37.5*pms->eta*pms->kappa1*pms->sigx2 - 18.75*pms->kappa2*pms->sigx2 - 18.75*pms->dm*pms->kappa2*pms->sigx2 + 37.5*pms->eta*pms->kappa2*pms->sigx2 - 75.*pms->dm*pms->sigx*pms->sx + 37.5*pms->kappa1*pms->sigx*pms->sx - 37.5*pms->dm*pms->kappa1*pms->sigx*pms->sx - 37.5*pms->kappa2*pms->sigx*pms->sx - 37.5*pms->dm*pms->kappa2*pms->sigx*pms->sx - 75.*pms->sx2 - 37.5*pms->kappa1*pms->sx2 - 37.5*pms->kappa2*pms->sx2;
	REAL8 PartPN3e010=1297.3235587975904686584800287784659423561558180216725381158046*chiv2 - 16842.68859085133907568834377901333540127519*chiv4 + 37391.38376917287972406141160719623971517108*chiv6 - 382.8998743748800567552611691749131929874249789208771846644618*chiv8 - 26785.9821886615845698190158255183846454614*chiv10 - 107.2961552274267057064546316934899031471398222784472179484551*chiv2*pms->dm*pms->sigx - 1017.2221341625264644674548561801888132569609390234928258276304*chiv4*pms->dm*pms->sigx + 11357.90353640941756888821462786901971684163*chiv6*pms->dm*pms->sigx - 23964.49208724971619830436851408901353092039*chiv8*pms->dm*pms->sigx + 14004.46119068212983012950366636138168622228*chiv10*pms->dm*pms->sigx - 483.361014417557012636418716814360960283265519879271621053381*chiv2*pms->sx + 865.3873438530675143367801553415594187284148283583581098236505*chiv4*pms->sx + 14983.79836538158028824522420943309876533737*chiv6*pms->sx - 41171.89846493612773401079611795966292379073*chiv8*pms->sx + 26476.5202064571037269743053541941989141336*chiv10*pms->sx;
	REAL8 PartPN3e08=819.6952959377807832098675292572923394572015946165231912022364*chiv2 - 5629.15560169063375453139216922879096668717*chiv4 + 6365.6224246237694845648489202149750321754*chiv6 - 26.271793968544283159855415760421368643133582664447787572524*chiv8 - 67.7935377922583893522193363440062829348601489017163475701324*chiv2*pms->dm*pms->sigx - 339.9755118547408110368509494353883720652443012359423886857429*chiv4*pms->dm*pms->sigx + 1933.6038990803234866881474744622919769928566157365302041396709*chiv6*pms->dm*pms->sigx - 1644.2684910902603951891050319627731221937556186348448290604087*chiv8*pms->dm*pms->sigx - 305.4047288904603538230686665022736040539089250433631700742228*chiv2*pms->sx + 289.2293583655482984356696511043597596545062162013126682417638*chiv4*pms->sx + 2550.88721694623337341592756214259186833744*chiv6*pms->sx - 2824.9150917861682586080233267814634807777*chiv8*pms->sx;
	REAL8 PartPN3e06=457.3069917964870094502558310136069632856427103422777652038706*chiv2 - 1389.1824805117164709777944312905850512630963071012210321181933*chiv4 + 582.350050281560614898499570191198438092482793706742844389689*chiv6 - 37.8219308865868985328819123832974248486713860675079511644607*chiv2*pms->dm*pms->sigx - 83.9003321794417221615975078578956695300185604894746168984396*chiv4*pms->dm*pms->sigx + 176.8930440326266445841699765984161182683805029142055919525909*chiv6*pms->dm*pms->sigx - 170.3849205204165384220785882835744331589206935467323278957628*chiv2*pms->sx + 71.3770209816890045421901377580047940158743482843205834895585*chiv4*pms->sx + 233.3643436508140070774727592209894456739639872911648842704551*chiv6*pms->sx;
	REAL8 PartPN3e04=205.0414097016233448562566414262602840548279725731762887823724*chiv2 - 190.6311198053995518404677281578413431766392648373790504584616*chiv4 - 16.9581094663742690058479532163742690058479532163742690058479*chiv2*pms->dm*pms->sigx - 11.5132565374136097820308346624136097820308346624136097820308*chiv4*pms->dm*pms->sigx - 76.3949926900584795321637426900584795321637426900584795321636*chiv2*pms->sx + 9.7947401648059542796384901648059542796384901648059542796384*chiv4*pms->sx;
	REAL8 PartPN3e02=56.2737784074271713839620996029940954131817968663065830182138*chiv2 - 4.6541666666666666666666666666666666666666666666666666666666*chiv2*pms->dm*pms->sigx - 20.9666666666666666666666666666666666666666666666666666666666*chiv2*pms->sx;
	REAL8 PartPN3e00=-31.4159265358979323846264338327950288419716939937510582097494 + 14.7916666666666666666666666666666666666666666666666666666667*pms->dm*pms->sigx + 43.3333333333333333333333333333333333333333333333333333333333*pms->sx;
	REAL8 PartPN2e012=34.4619744835081590794276425867407449361014129920019408459648*chiv2 + 9565.12010469402716644618250164126318374805*chiv4 - 116582.32780706627209090615650019549079559907*chiv6 + 407593.70692441511161592394152201217820488295*chiv8 - 539415.16568131926082784005003321623665332213*chiv10 + 240012.1153610586816715017461515602935155668*chiv12 + 109.7058157211535530045686200347277082144964903137992998143835*chiv2*pms->eta - 9017.74137647884480709240116037083564536652*chiv4*pms->eta + 90078.92733110014756700390953478931644763261*chiv6*pms->eta - 291624.18726898970311802699365187288627949964*chiv8*pms->eta + 369933.13280699385667441962392666211828578711*chiv10*pms->eta - 160152.42693675297044893866048051934216010703*chiv12*pms->eta;
	REAL8 PartPN2e010=23.6008462681141509540700119557196898965407161428958482055171*chiv2 + 3871.36547153038204922650680394686800304053*chiv4 - 27751.62533791920011699041573509294080038626*chiv6 + 52963.30304878161599120186470374426537103717*chiv8 - 29608.58447796347673036353449475132156652602*chiv10 + 75.1306368934852556264022392277602276161389598381504691479462*chiv2*pms->eta - 3649.8206205438761143530512889175785628431*chiv4*pms->eta + 21442.67222276909663459148280297236528388837*chiv6*pms->eta - 37894.05956050828215932895289520020645221651*chiv8*pms->eta + 20305.68866205106212982670460554413794021293*chiv10*pms->eta;
	REAL8 PartPN2e08=14.9118564408512371980469388477520534347736239816394033886055*chiv2 + 1293.8859798247576654107901813716713434328329703149141088009004*chiv4 - 4724.52075219690115539050997177789227164744*chiv6 + 3633.95518962449847908336598027496012777504*chiv8 + 47.470216065048558857066231805017828247647949256541373954019*chiv2*pms->eta - 1219.8413620531142644748144287885519316191239708407709449980359*chiv4*pms->eta + 3650.46546519226462728855228672986363611819*chiv6*pms->eta - 2600.01371645979185444688572377539785468112*chiv8*pms->eta;
	REAL8 PartPN2e06=8.3193062652202525554697101986377807509584320031490589464471*chiv2 + 319.3096553260055389188412115270133776646418834195105781125701*chiv4 - 432.2161627047420858377114148120611647850798358646927437324481*chiv6 + 26.4835748310606560260299872488238139207668293540869718155035*chiv2*pms->eta - 301.0366685651384959692998827789892798438799499682389998886727*chiv4*pms->eta + 333.9577193555366977718085751326748556665454172379380135612823*chiv6*pms->eta;
	REAL8 PartPN2e04=3.7301032237867734813223535028046306241794963599474877670365*chiv2 + 43.8173947723919728399011713681366536909650011553706962441565*chiv4 + 11.8743636434837092731829573934837092731829573934837092731829*chiv2*pms->eta - 41.3098768780328480776409107876073161627472937663307204180664*chiv4*pms->eta;
	REAL8 PartPN2e02=1.0237298044217687074829931972789115646258503401360544217687*chiv2 + 3.2589285714285714285714285714285714285714285714285714285715*chiv2*pms->eta;
	REAL8 PartPN2e00=-11.314484126984126984126984126984126984126984126984126984127 + 4.5833333333333333333333333333333333333333333333333333333333*pms->eta;
	REAL8 PartPN0e014=-134.0769756683264868125074805538148975204729617463754190711564*chiv2 + 6375.95869525267686578435365422744278887337*chiv4 - 69517.10018605568301023320334111995555864923*chiv6 + 290999.08072940185977865907114614349031665852*chiv8 - 555717.98161473258422849076135094770173168396*chiv10 + 489534.3159406633130061893428075219571850781*chiv12 - 161540.2315631103437836071057666496478099987*chiv14;
	REAL8 PartPN0e012=-97.1528537288861843287839753571037480481318637025507095052438*chiv2 + 2948.38141777237274995948014299946257419769*chiv4 - 20619.32226638567414110805743125009844113664*chiv6 + 53764.47746325151558250862369967691976652367*chiv8 - 58388.48191386064401715899610626553694916321*chiv10 + 22392.18056665086475381907315881532876681669*chiv12;
	REAL8 PartPN0e010=-66.5339000370187719044448516610060355762584342160575065218314*chiv2 + 1193.3213480575403704666120885130623654513954287693110989246541*chiv4 - 4908.28856330201805130494185990745927363971*chiv6 + 6986.23228173057408323878410974781560574419*chiv8 - 3204.95308488961223855847152867373877205157*chiv10;
	REAL8 PartPN0e08=-42.0384911003129461594808934357087777954593845551482433323666*chiv2 + 398.831309787672157574278195648822864958117635360316096547518*chiv4 - 835.6019113376304313903265782183991835544540020411138649948971*chiv6 + 479.3442552616824829908043265189593614534082046353028517581172*chiv8;
	REAL8 PartPN0e06=-23.453222191245496351818659134937446816214943964658809045317*chiv2 + 98.4249694696971346771430396580660522541043107603500641706882*chiv4 - 76.4438703119589681440443213296398891966759002770083102493074*chiv6;
	REAL8 PartPN0e04=-10.5156532185242518059855521155830753353973168214654282765737*chiv2 + 13.5064056810658722277391592188017212843429328037073816617013*chiv4;
	REAL8 PartPN0e02=-2.8860294117647058823529411764705882352941176470588235294118*chiv2;
	REAL8 PartPN0e00=1.;
	REAL8 PN0 = PartPN0e00 + e010*PartPN0e010 + e012*PartPN0e012 +
    e014*PartPN0e014 + e02*PartPN0e02 + e04*PartPN0e04 + e06*PartPN0e06 +
    e08*PartPN0e08;
    REAL8 PN2 = (PartPN2e00 + e010*PartPN2e010 +
    e012*PartPN2e012 + e02*PartPN2e02 + e04*PartPN2e04 + e06*PartPN2e06 +
    e08*PartPN2e08)*var->vom2;
    REAL8 PN3 = (PartPN3e00 + e010*PartPN3e010 +
    e02*PartPN3e02 + e04*PartPN3e04 + e06*PartPN3e06 +
    e08*PartPN3e08)*var->vom3;
    REAL8 PN4 = (PartPN4e00 + e02*PartPN4e02 +
    e04*PartPN4e04 + e06*PartPN4e06 + e08*PartPN4e08)*var->vom4;
#if 0
// print_debug("e0 = %.16e\n", pms->eini);
// print_debug("vom0 = %.16e\n", pms->vomini);
// print_debug("vom = %.16e\n", var->vom);
// print_debug("chiv = %.16e\n", chiv);

// print_debug("pref = %.16e\n", pref);
// print_debug("PN0 = %.16e\n", PN0);
// print_debug("PN2 = %.16e\n", PN2);

// print_debug("PN3 = %.16e\n", PN3);
// print_debug("PN4 = %.16e\n", PN4);
//
print_debug("vom = %.16e, final = %.16e\n", var->vom, pref*(PN0 + PN2 + PN3 + PN4));
#endif
	return pref*(PN0 + PN2 + PN3 + PN4);
}


REAL8 Calculate_t(BBHCore *core)
{
    BBHDynParams *pms = core->pms;
    BBHDynVariables *var = core->var;
    REAL8 chiv = pow(pms->vomini / var->vom, 19./6.);
    REAL8 chiv2 = chiv*chiv;
    REAL8 chiv4 = chiv2*chiv2;
    REAL8 chiv6 = chiv4*chiv2;
    REAL8 chiv8 = chiv6*chiv2;
    REAL8 chiv10 = chiv8*chiv2;
    REAL8 chiv12 = chiv10*chiv2;
    REAL8 chiv14 = chiv12*chiv2;

    REAL8 e02 = pms->eini*pms->eini;
    REAL8 e04 = e02*e02;
    REAL8 e06 = e04*e02;
    REAL8 e08 = e06*e02;
    REAL8 e010 = e08*e02;
    REAL8 e012 = e010*e02;
    REAL8 e014 = e012*e02;

    REAL8 pref = - 5./(256.*var->vom5*var->vom3*pms->eta);
#if 0
	REAL8 PartPN4e08=435.1587827480396012248370564358702239928813457733117968617321*chiv2 + 9876.24433477514876618892515271994977594258*chiv4 - 51903.83740341366371389110713554433403679368*chiv6 + 48244.42246799945978374994147496495721061359*chiv8 - 979.2483033113268638838642622184569617613749602992560165573915*chiv2*pms->eta - 3322.62637182553152203545090754313025133196*chiv4*pms->eta + 37169.70807470927304371030969511720145782519*chiv6*pms->eta - 39694.775919564965925349127468525373683776*chiv8*pms->eta + 21.0107040673632218133701209421865623077157756845886910024009*chiv2*pms->eta2 + 2806.63736509336743733555068976089209035379*chiv4*pms->eta2 - 13651.39381499335416182325692812285060700873*chiv6*pms->eta2 + 12673.40466352789234498893990423604123905971*chiv8*pms->eta2 - 1.3508978853685935441427597561834503487178647512687867797784*chiv2*pms->sigx2 + 30.0451593851635945338106731895913992429519474278185460573563*chiv4*pms->sigx2 - 86.7612821023228040564731646585383662026853771118684878454651*chiv6*pms->sigx2 + 60.70679364844370018224435474277530942739670931341242854097*chiv8*pms->sigx2 - 346.7696137050511428095153739350909069056640648474311803396735*chiv2*pms->eta*pms->sigx2 + 267.9800014596786359365634770212697024185579368550647162689734*chiv4*pms->eta*pms->sigx2 + 3456.74267360398539279468493386100845674747*chiv6*pms->eta*pms->sigx2 - 3782.90453143620081597613398896384754381547*chiv8*pms->eta*pms->sigx2 + 86.6924034262627857023788434837727267264160162118577950849183*chiv2*pms->kappa1*pms->sigx2 - 66.9950003649196589841408692553174256046394842137661790672433*chiv4*pms->kappa1*pms->sigx2 - 864.1856684009963481986712334652521141868682706807164042025252*chiv6*pms->kappa1*pms->sigx2 + 945.7261328590502039940334972409618859538672922548123014663326*chiv8*pms->kappa1*pms->sigx2 - 86.6924034262627857023788434837727267264160162118577950849183*chiv2*pms->dm*pms->kappa1*pms->sigx2 + 66.9950003649196589841408692553174256046394842137661790672433*chiv4*pms->dm*pms->kappa1*pms->sigx2 + 864.1856684009963481986712334652521141868682706807164042025252*chiv6*pms->dm*pms->kappa1*pms->sigx2 - 945.7261328590502039940334972409618859538672922548123014663326*chiv8*pms->dm*pms->kappa1*pms->sigx2 - 173.3848068525255714047576869675454534528320324237155901698366*chiv2*pms->eta*pms->kappa1*pms->sigx2 + 133.9900007298393179682817385106348512092789684275323581344867*chiv4*pms->eta*pms->kappa1*pms->sigx2 + 1728.3713368019926963973424669305042283737365413614328084050505*chiv6*pms->eta*pms->kappa1*pms->sigx2 - 1891.4522657181004079880669944819237719077345845096246029326653*chiv8*pms->eta*pms->kappa1*pms->sigx2 + 86.6924034262627857023788434837727267264160162118577950849183*chiv2*pms->kappa2*pms->sigx2 - 66.9950003649196589841408692553174256046394842137661790672433*chiv4*pms->kappa2*pms->sigx2 - 864.1856684009963481986712334652521141868682706807164042025252*chiv6*pms->kappa2*pms->sigx2 + 945.7261328590502039940334972409618859538672922548123014663326*chiv8*pms->kappa2*pms->sigx2 + 86.6924034262627857023788434837727267264160162118577950849183*chiv2*pms->dm*pms->kappa2*pms->sigx2 - 66.9950003649196589841408692553174256046394842137661790672433*chiv4*pms->dm*pms->kappa2*pms->sigx2 - 864.1856684009963481986712334652521141868682706807164042025252*chiv6*pms->dm*pms->kappa2*pms->sigx2 + 945.7261328590502039940334972409618859538672922548123014663326*chiv8*pms->dm*pms->kappa2*pms->sigx2 - 173.3848068525255714047576869675454534528320324237155901698366*chiv2*pms->eta*pms->kappa2*pms->sigx2 + 133.9900007298393179682817385106348512092789684275323581344867*chiv4*pms->eta*pms->kappa2*pms->sigx2 + 1728.3713368019926963973424669305042283737365413614328084050505*chiv6*pms->eta*pms->kappa2*pms->sigx2 - 1891.4522657181004079880669944819237719077345845096246029326653*chiv8*pms->eta*pms->kappa2*pms->sigx2 + 346.7696137050511428095153739350909069056640648474311803396735*chiv2*pms->dm*pms->sigx*pms->sx - 267.9800014596786359365634770212697024185579368550647162689734*chiv4*pms->dm*pms->sigx*pms->sx - 3456.74267360398539279468493386100845674747*chiv6*pms->dm*pms->sigx*pms->sx + 3782.90453143620081597613398896384754381547*chiv8*pms->dm*pms->sigx*pms->sx - 173.3848068525255714047576869675454534528320324237155901698366*chiv2*pms->kappa1*pms->sigx*pms->sx + 133.9900007298393179682817385106348512092789684275323581344867*chiv4*pms->kappa1*pms->sigx*pms->sx + 1728.3713368019926963973424669305042283737365413614328084050505*chiv6*pms->kappa1*pms->sigx*pms->sx - 1891.4522657181004079880669944819237719077345845096246029326653*chiv8*pms->kappa1*pms->sigx*pms->sx + 173.3848068525255714047576869675454534528320324237155901698366*chiv2*pms->dm*pms->kappa1*pms->sigx*pms->sx - 133.9900007298393179682817385106348512092789684275323581344867*chiv4*pms->dm*pms->kappa1*pms->sigx*pms->sx - 1728.3713368019926963973424669305042283737365413614328084050505*chiv6*pms->dm*pms->kappa1*pms->sigx*pms->sx + 1891.4522657181004079880669944819237719077345845096246029326653*chiv8*pms->dm*pms->kappa1*pms->sigx*pms->sx + 173.3848068525255714047576869675454534528320324237155901698366*chiv2*pms->kappa2*pms->sigx*pms->sx - 133.9900007298393179682817385106348512092789684275323581344867*chiv4*pms->kappa2*pms->sigx*pms->sx - 1728.3713368019926963973424669305042283737365413614328084050505*chiv6*pms->kappa2*pms->sigx*pms->sx + 1891.4522657181004079880669944819237719077345845096246029326653*chiv8*pms->kappa2*pms->sigx*pms->sx + 173.3848068525255714047576869675454534528320324237155901698366*chiv2*pms->dm*pms->kappa2*pms->sigx*pms->sx - 133.9900007298393179682817385106348512092789684275323581344867*chiv4*pms->dm*pms->kappa2*pms->sigx*pms->sx - 1728.3713368019926963973424669305042283737365413614328084050505*chiv6*pms->dm*pms->kappa2*pms->sigx*pms->sx + 1891.4522657181004079880669944819237719077345845096246029326653*chiv8*pms->dm*pms->kappa2*pms->sigx*pms->sx + 346.7696137050511428095153739350909069056640648474311803396735*chiv2*pms->sx2 - 267.9800014596786359365634770212697024185579368550647162689734*chiv4*pms->sx2 - 3456.74267360398539279468493386100845674747*chiv6*pms->sx2 + 3782.90453143620081597613398896384754381547*chiv8*pms->sx2 + 173.3848068525255714047576869675454534528320324237155901698366*chiv2*pms->kappa1*pms->sx2 - 133.9900007298393179682817385106348512092789684275323581344867*chiv4*pms->kappa1*pms->sx2 - 1728.3713368019926963973424669305042283737365413614328084050505*chiv6*pms->kappa1*pms->sx2 + 1891.4522657181004079880669944819237719077345845096246029326653*chiv8*pms->kappa1*pms->sx2 + 173.3848068525255714047576869675454534528320324237155901698366*chiv2*pms->kappa2*pms->sx2 - 133.9900007298393179682817385106348512092789684275323581344867*chiv4*pms->kappa2*pms->sx2 - 1728.3713368019926963973424669305042283737365413614328084050505*chiv6*pms->kappa2*pms->sx2 + 1891.4522657181004079880669944819237719077345845096246029326653*chiv8*pms->kappa2*pms->sx2;
	REAL8 PartPN4e06=242.77454668647050628357081092863200461946430811245176908439*chiv2 + 2437.29372110484159796214890547945407316056*chiv4 - 4748.34985574413294282964085741964416105485*chiv6 - 546.3214172734601952044167514932713157477104696596550169361654*chiv2*pms->eta - 819.9692230287556809299076150415023914562234045151866019825392*chiv4*pms->eta + 3400.41867430382756704421731788011713607549*chiv6*pms->eta + 11.721845812936583189092646096786328520162255604426396431877*chiv2*pms->eta2 + 692.6316720693039097500085496392052255394822338497315413289559*chiv4*pms->eta2 - 1248.8786397104964385176858580046182920645966131533597108288986*chiv6*pms->eta2 - 0.7536642594433522969846801497234881204142217456487852341663*chiv2*pms->sigx2 + 7.4146483052477685441674361341951369652200677131425053862726*chiv4*pms->sigx2 - 7.9372343542299525829575209317471150543534019386121036127058*chiv6*pms->sigx2 - 193.4623385979805200607631132159771244750245733178446966312215*chiv2*pms->eta*pms->sigx2 + 66.1330312211449676823638042474607571560480147737765466297321*chiv4*pms->eta*pms->sigx2 + 316.2352611422243633492579656616751642645897734419955303973128*chiv6*pms->eta*pms->sigx2 + 48.3655846494951300151907783039942811187561433294611741578054*chiv2*pms->kappa1*pms->sigx2 - 16.533257805286241920590951061865189289012003693444136657433*chiv4*pms->kappa1*pms->sigx2 - 79.0588152855560908373144914154187910661474433604988825993281*chiv6*pms->kappa1*pms->sigx2 - 48.3655846494951300151907783039942811187561433294611741578054*chiv2*pms->dm*pms->kappa1*pms->sigx2 + 16.533257805286241920590951061865189289012003693444136657433*chiv4*pms->dm*pms->kappa1*pms->sigx2 + 79.0588152855560908373144914154187910661474433604988825993281*chiv6*pms->dm*pms->kappa1*pms->sigx2 - 96.7311692989902600303815566079885622375122866589223483156107*chiv2*pms->eta*pms->kappa1*pms->sigx2 + 33.066515610572483841181902123730378578024007386888273314866*chiv4*pms->eta*pms->kappa1*pms->sigx2 + 158.1176305711121816746289828308375821322948867209977651986564*chiv6*pms->eta*pms->kappa1*pms->sigx2 + 48.3655846494951300151907783039942811187561433294611741578054*chiv2*pms->kappa2*pms->sigx2 - 16.533257805286241920590951061865189289012003693444136657433*chiv4*pms->kappa2*pms->sigx2 - 79.0588152855560908373144914154187910661474433604988825993281*chiv6*pms->kappa2*pms->sigx2 + 48.3655846494951300151907783039942811187561433294611741578054*chiv2*pms->dm*pms->kappa2*pms->sigx2 - 16.533257805286241920590951061865189289012003693444136657433*chiv4*pms->dm*pms->kappa2*pms->sigx2 - 79.0588152855560908373144914154187910661474433604988825993281*chiv6*pms->dm*pms->kappa2*pms->sigx2 - 96.7311692989902600303815566079885622375122866589223483156107*chiv2*pms->eta*pms->kappa2*pms->sigx2 + 33.066515610572483841181902123730378578024007386888273314866*chiv4*pms->eta*pms->kappa2*pms->sigx2 + 158.1176305711121816746289828308375821322948867209977651986564*chiv6*pms->eta*pms->kappa2*pms->sigx2 + 193.4623385979805200607631132159771244750245733178446966312215*chiv2*pms->dm*pms->sigx*pms->sx - 66.1330312211449676823638042474607571560480147737765466297321*chiv4*pms->dm*pms->sigx*pms->sx - 316.2352611422243633492579656616751642645897734419955303973128*chiv6*pms->dm*pms->sigx*pms->sx - 96.7311692989902600303815566079885622375122866589223483156107*chiv2*pms->kappa1*pms->sigx*pms->sx + 33.066515610572483841181902123730378578024007386888273314866*chiv4*pms->kappa1*pms->sigx*pms->sx + 158.1176305711121816746289828308375821322948867209977651986564*chiv6*pms->kappa1*pms->sigx*pms->sx + 96.7311692989902600303815566079885622375122866589223483156107*chiv2*pms->dm*pms->kappa1*pms->sigx*pms->sx - 33.066515610572483841181902123730378578024007386888273314866*chiv4*pms->dm*pms->kappa1*pms->sigx*pms->sx - 158.1176305711121816746289828308375821322948867209977651986564*chiv6*pms->dm*pms->kappa1*pms->sigx*pms->sx + 96.7311692989902600303815566079885622375122866589223483156107*chiv2*pms->kappa2*pms->sigx*pms->sx - 33.066515610572483841181902123730378578024007386888273314866*chiv4*pms->kappa2*pms->sigx*pms->sx - 158.1176305711121816746289828308375821322948867209977651986564*chiv6*pms->kappa2*pms->sigx*pms->sx + 96.7311692989902600303815566079885622375122866589223483156107*chiv2*pms->dm*pms->kappa2*pms->sigx*pms->sx - 33.066515610572483841181902123730378578024007386888273314866*chiv4*pms->dm*pms->kappa2*pms->sigx*pms->sx - 158.1176305711121816746289828308375821322948867209977651986564*chiv6*pms->dm*pms->kappa2*pms->sigx*pms->sx + 193.4623385979805200607631132159771244750245733178446966312215*chiv2*pms->sx2 - 66.1330312211449676823638042474607571560480147737765466297321*chiv4*pms->sx2 - 316.2352611422243633492579656616751642645897734419955303973128*chiv6*pms->sx2 + 96.7311692989902600303815566079885622375122866589223483156107*chiv2*pms->kappa1*pms->sx2 - 33.066515610572483841181902123730378578024007386888273314866*chiv4*pms->kappa1*pms->sx2 - 158.1176305711121816746289828308375821322948867209977651986564*chiv6*pms->kappa1*pms->sx2 + 96.7311692989902600303815566079885622375122866589223483156107*chiv2*pms->kappa2*pms->sx2 - 33.066515610572483841181902123730378578024007386888273314866*chiv4*pms->kappa2*pms->sx2 - 158.1176305711121816746289828308375821322948867209977651986564*chiv6*pms->kappa2*pms->sx2;
	REAL8 PartPN4e04=108.8521194410675087438400290422819864704145298103311416163438*chiv2 + 334.4586027155605683631477282270933064583858234651885445536239*chiv4 - 244.9525495070280989211379703739635827921057123094474537598475*chiv2*pms->eta - 112.5206035814362294625452520189362294625452520189362294625452*chiv4*pms->eta + 5.2556900132836571716028422310255926554738099729610765264415*chiv2*pms->eta2 + 95.0466573769493177387914230019493177387914230019493177387914*chiv4*pms->eta2 - 0.3379182583474816072439162422184493491794001131861912846633*chiv2*pms->sigx2 + 1.0174780701754385964912280701754385964912280701754385964911*chiv4*pms->sigx2 - 86.7421477079796264855687606112054329371816638370118845500848*chiv2*pms->eta*pms->sigx2 + 9.0751315789473684210526315789473684210526315789473684210525*chiv4*pms->eta*pms->sigx2 + 21.6855369269949066213921901528013582342954159592529711375211*chiv2*pms->kappa1*pms->sigx2 - 2.268782894736842105263157894736842105263157894736842105263*chiv4*pms->kappa1*pms->sigx2 - 21.6855369269949066213921901528013582342954159592529711375211*chiv2*pms->dm*pms->kappa1*pms->sigx2 + 2.268782894736842105263157894736842105263157894736842105263*chiv4*pms->dm*pms->kappa1*pms->sigx2 - 43.3710738539898132427843803056027164685908319185059422750423*chiv2*pms->eta*pms->kappa1*pms->sigx2 + 4.5375657894736842105263157894736842105263157894736842105262*chiv4*pms->eta*pms->kappa1*pms->sigx2 + 21.6855369269949066213921901528013582342954159592529711375211*chiv2*pms->kappa2*pms->sigx2 - 2.268782894736842105263157894736842105263157894736842105263*chiv4*pms->kappa2*pms->sigx2 + 21.6855369269949066213921901528013582342954159592529711375211*chiv2*pms->dm*pms->kappa2*pms->sigx2 - 2.268782894736842105263157894736842105263157894736842105263*chiv4*pms->dm*pms->kappa2*pms->sigx2 - 43.3710738539898132427843803056027164685908319185059422750423*chiv2*pms->eta*pms->kappa2*pms->sigx2 + 4.5375657894736842105263157894736842105263157894736842105262*chiv4*pms->eta*pms->kappa2*pms->sigx2 + 86.7421477079796264855687606112054329371816638370118845500848*chiv2*pms->dm*pms->sigx*pms->sx - 9.0751315789473684210526315789473684210526315789473684210525*chiv4*pms->dm*pms->sigx*pms->sx - 43.3710738539898132427843803056027164685908319185059422750423*chiv2*pms->kappa1*pms->sigx*pms->sx + 4.5375657894736842105263157894736842105263157894736842105262*chiv4*pms->kappa1*pms->sigx*pms->sx + 43.3710738539898132427843803056027164685908319185059422750423*chiv2*pms->dm*pms->kappa1*pms->sigx*pms->sx - 4.5375657894736842105263157894736842105263157894736842105262*chiv4*pms->dm*pms->kappa1*pms->sigx*pms->sx + 43.3710738539898132427843803056027164685908319185059422750423*chiv2*pms->kappa2*pms->sigx*pms->sx - 4.5375657894736842105263157894736842105263157894736842105262*chiv4*pms->kappa2*pms->sigx*pms->sx + 43.3710738539898132427843803056027164685908319185059422750423*chiv2*pms->dm*pms->kappa2*pms->sigx*pms->sx - 4.5375657894736842105263157894736842105263157894736842105262*chiv4*pms->dm*pms->kappa2*pms->sigx*pms->sx + 86.7421477079796264855687606112054329371816638370118845500848*chiv2*pms->sx2 - 9.0751315789473684210526315789473684210526315789473684210525*chiv4*pms->sx2 + 43.3710738539898132427843803056027164685908319185059422750423*chiv2*pms->kappa1*pms->sx2 - 4.5375657894736842105263157894736842105263157894736842105262*chiv4*pms->kappa1*pms->sx2 + 43.3710738539898132427843803056027164685908319185059422750423*chiv2*pms->kappa2*pms->sx2 - 4.5375657894736842105263157894736842105263157894736842105262*chiv4*pms->kappa2*pms->sx2;
	REAL8 PartPN4e02=29.8745509871361925893415908776891879810466600021131511146871*chiv2 - 67.2274225550435227854582693292370711725550435227854582693292*chiv2*pms->eta + 1.4424283154121863799283154121863799283154121863799283154122*chiv2*pms->eta2 - 0.0927419354838709677419354838709677419354838709677419354839*chiv2*pms->sigx2 - 23.8064516129032258064516129032258064516129032258064516129032*chiv2*pms->eta*pms->sigx2 + 5.9516129032258064516129032258064516129032258064516129032258*chiv2*pms->kappa1*pms->sigx2 - 5.9516129032258064516129032258064516129032258064516129032258*chiv2*pms->dm*pms->kappa1*pms->sigx2 - 11.9032258064516129032258064516129032258064516129032258064517*chiv2*pms->eta*pms->kappa1*pms->sigx2 + 5.9516129032258064516129032258064516129032258064516129032258*chiv2*pms->kappa2*pms->sigx2 + 5.9516129032258064516129032258064516129032258064516129032258*chiv2*pms->dm*pms->kappa2*pms->sigx2 - 11.9032258064516129032258064516129032258064516129032258064517*chiv2*pms->eta*pms->kappa2*pms->sigx2 + 23.8064516129032258064516129032258064516129032258064516129032*chiv2*pms->dm*pms->sigx*pms->sx - 11.9032258064516129032258064516129032258064516129032258064517*chiv2*pms->kappa1*pms->sigx*pms->sx + 11.9032258064516129032258064516129032258064516129032258064517*chiv2*pms->dm*pms->kappa1*pms->sigx*pms->sx + 11.9032258064516129032258064516129032258064516129032258064517*chiv2*pms->kappa2*pms->sigx*pms->sx + 11.9032258064516129032258064516129032258064516129032258064517*chiv2*pms->dm*pms->kappa2*pms->sigx*pms->sx + 23.8064516129032258064516129032258064516129032258064516129032*chiv2*pms->sx2 + 11.9032258064516129032258064516129032258064516129032258064517*chiv2*pms->kappa1*pms->sx2 + 11.9032258064516129032258064516129032258064516129032258064517*chiv2*pms->kappa2*pms->sx2;
	REAL8 PartPN4e00=-13.3603217907533383723859914336104812295288485764676240866716 + 4.10515873015873015873015873015873015873015873015873015873*pms->eta + 8.5694444444444444444444444444444444444444444444444444444444*pms->eta2 - 0.125*pms->sigx2 + 36.*pms->eta*pms->sigx2 - 9.*pms->kappa1*pms->sigx2 + 9.*pms->dm*pms->kappa1*pms->sigx2 + 18.*pms->eta*pms->kappa1*pms->sigx2 - 9.*pms->kappa2*pms->sigx2 - 9.*pms->dm*pms->kappa2*pms->sigx2 + 18.*pms->eta*pms->kappa2*pms->sigx2 - 36.*pms->dm*pms->sigx*pms->sx + 18.*pms->kappa1*pms->sigx*pms->sx - 18.*pms->dm*pms->kappa1*pms->sigx*pms->sx - 18.*pms->kappa2*pms->sigx*pms->sx - 18.*pms->dm*pms->kappa2*pms->sigx*pms->sx - 36.*pms->sx2 - 18.*pms->kappa1*pms->sx2 - 18.*pms->kappa2*pms->sx2;
	REAL8 PartPN3e010=1526.263010350106433715858857386430520419006844731379456606829*chiv2 - 22372.17503388555228166904532155733608018441*chiv4 + 52347.93727684203161368597625007473560123951*chiv6 - 552.049049648178719190002916436797922197254475103506445432586*chiv8 - 39351.04292443374605893411779457973598824148*chiv10 - 208.2751214746931577407929708895696366319223681701808654263025*chiv2*pms->dm*pms->sigx + 21.902837964167747026735849105658307257169596499631489136064*chiv4*pms->dm*pms->sigx + 10428.49888076941246951448961353830868337356*chiv6*pms->dm*pms->sigx - 26899.78725907932137487355725896059493981662*chiv8*pms->dm*pms->sigx + 17104.00130710429301865883134731714321655626*chiv10*pms->dm*pms->sigx - 814.793068818522879713031644120345675592056578679871969464808*chiv2*pms->sx + 5268.73839582423045437899601073776096777812*chiv4*pms->sx + 4559.61950092289602275628129677138151085814*chiv6*pms->sx - 36406.27378886578459769338610139686229012101*chiv8*pms->sx + 28486.93919513807378899707920364038149551811*chiv10*pms->sx;
	REAL8 PartPN3e08=964.3474069856244508351382697144615758320018760194390466762261*chiv2 - 7477.21800677397389281150959837182800103353*chiv4 + 8911.87139447327727839078848830096504504555*chiv6 - 37.8775754799231862700333027227174018239464400612697771768366*chiv8 - 131.5956502724021397399970897698705349928350670660521655397906*chiv2*pms->dm*pms->sigx + 7.3203563881059113173348612990418596788045733149306382289534*chiv4*pms->dm*pms->sigx + 1775.3792355050385428422420573851783454738210047535993981053999*chiv6*pms->dm*pms->sigx - 1845.6670162714671301448001971239890599693616006327609897939229*chiv8*pms->dm*pms->sigx - 514.8153220097772260040038075099113170365387051254672346944604*chiv2*pms->sx + 1760.9153131766924415152888095292189990337124754467436945858998*chiv4*pms->sx + 776.2434341024837072188053664135373487238838521014413191763306*chiv6*pms->sx - 2497.9327185860363792579271836047200126836*chiv8*pms->sx;
	REAL8 PartPN3e06=538.0082256429258934708892129571846626889914239320914874726018*chiv2 - 1845.2537099627328218271080747708903322438114095341005269652543*chiv4 + 815.2900703941848608578993982676778133294759111894399806263296*chiv6 - 73.4170505281791079004701295722967549592936589840614608416466*chiv2*pms->dm*pms->sigx + 1.8065428574055684284085475743867005038802456875942476736914*chiv4*pms->dm*pms->sigx + 162.4180823332927225471085120207927225471085120207927225471085*chiv6*pms->dm*pms->sigx - 287.2148314206030211407431547565163338342416067689002347630342*chiv2*pms->sx + 434.5647688252166607625761966429922317655553426211451612591004*chiv4*pms->sx + 71.0135431739858702962734972584156948576770060303455194190805*chiv6*pms->sx;
	REAL8 PartPN3e04=241.2251878842627586544195781485415106527387912625603392944617*chiv2 - 253.2156761188703481050741143832458596157623442368204740993904*chiv4 - 32.9177900326797385620915032679738562091503267973856209150326*chiv2*pms->dm*pms->sigx + 0.2479035639412997903563941299790356394129979035639412997904*chiv4*pms->dm*pms->sigx - 128.7776810285517715858273133814929480564155486756105951152389*chiv2*pms->sx + 59.6333236786935893192099746220898157343043142447313251682666*chiv4*pms->sx;
	REAL8 PartPN3e02=66.2044451852084369223083524741107004860962316074195093098253*chiv2 - 9.0343137254901960784313725490196078431372549019607843137255*chiv2*pms->dm*pms->sigx - 35.3431372549019607843137254901960784313725490196078431372548*chiv2*pms->sx;
	REAL8 PartPN3e00=-20.106192982974676726160917652988818458861884156000677216773 + 11.0666666666666666666666666666666666666666666666666666666667*pms->dm*pms->sigx + 32.5333333333333333333333333333333333333333333333333333333334*pms->sx;
	REAL8 PartPN2e012=404.7431099371518248008117959045017760743835219835822915082111*chiv2 + 2028.5089809126027662957278468023452018348644633057377812244051*chiv4 - 89112.75330446339858419350294301657438793716*chiv6 + 394919.16034995045296681173137183165629368305*chiv8 - 583363.58579108275907791125144170926303514264*chiv10 + 277083.66430634162270354990608203925815651825*chiv12 + 132.8329876839913290433695723663730088651200747583299630184969*chiv2*pms->eta - 12109.53841984302016952408155821226500949218*chiv4*pms->eta + 126831.12968218900777434150462498335755826672*chiv6*pms->eta - 421924.3560487510598303369269856884312128931*chiv8*pms->eta + 544751.0911423343163771984550566068715288051*chiv10*pms->eta - 238772.70925115897412387218471641065558415958*chiv12*pms->eta;
	REAL8 PartPN2e010=277.1831869435225249784239986753111751868383285905887504731612*chiv2 + 821.0142205679644433280560028680430931786751638823054341650283*chiv4 - 21212.68110745336141862613562181360157127685*chiv6 + 51316.35453160602313415200001380290495941999*chiv8 - 32020.92026731673044111074699457350875040927*chiv10 + 90.9689873737334987044005491190177891135952811013281356169728*chiv2*pms->eta - 4901.18769044463363927409744511789121296074*chiv4*pms->eta + 30191.28248965888806150480778658509031971482*chiv6*pms->eta - 54825.44787477794014541210206114072422873878*chiv8*pms->eta + 29901.4742775689976849837490828543765774463*chiv10*pms->eta;
	REAL8 PartPN2e08=175.1342237716171365321761800030417094776978789873445718969037*chiv2 + 274.39899359584490159036972313237769121245124272082248741348*chiv4 - 3611.31108111929292097266352502781525476768*chiv6 + 3520.95360614088873746212940209059955785367*chiv8 + 57.4774508030858226161234374287783433917467061268392852200015*chiv2*pms->eta - 1638.0726861856105837233222329446268796028236179861781261402197*chiv4*pms->eta + 5139.85537499070859522228161971564799965441*chiv6*pms->eta - 3761.72197275033715111464317482397987485779*chiv8*pms->eta;
	REAL8 PartPN2e06=97.7071668344553992060917268673501360481969900252448728903021*chiv2 + 67.7171322922588164228449151282550570243486745267512976258524*chiv4 - 330.3757353777505410700239878448558042279187246869610673858134*chiv6 + 32.0665987143653348639498223985758611797392960827863874955287*chiv2*pms->eta - 404.2492406446145517302026997317856043617816471002066569933605*chiv4*pms->eta + 470.2124688525956704627064737868061967784959474710167230942853*chiv6*pms->eta;
	REAL8 PartPN2e04=43.8086790385310122152227415385310122152227415385310122152227*chiv2 + 9.29251048006922067072443012292636352786728726578350638501*chiv4 + 14.3776078710289236605026078710289236605026078710289236605025*chiv2*pms->eta - 55.4732632362155388471177944862155388471177944862155388471177*chiv4*pms->eta;
	REAL8 PartPN2e02=12.0233268983268983268983268983268983268983268983268983268982*chiv2 + 3.945945945945945945945945945945945945945945945945945945946*chiv2*pms->eta;
	REAL8 PartPN2e00=-13.0515873015873015873015873015873015873015873015873015873015 + 3.6666666666666666666666666666666666666666666666666666666667*pms->eta;
	REAL8 PartPN0e014=-169.6229645664409507581489986541286145375285841628563441272303*chiv2 + 8720.66608641011287449214822384656691123326*chiv4 - 98868.76470905697139233166697403727012785668*chiv6 + 423694.66154200910783772760758878492190105481*chiv8 - 821902.22490918432625390230250224197903173426*chiv10 + 732173.0638416877377136049301121197968333342*chiv12 - 243647.94161875496438189912513084481911724645*chiv14;
	REAL8 PartPN0e012=-122.9096568104978704066476339401498579957761252422967115601224*chiv2 + 4032.62490688866466446070832461861977890264*chiv4 - 29325.25833441518100068701501333347333850545*chiv6 + 78281.07918649420668813255610672959518005847*chiv8 - 86356.07409108801131949565810674566809288004*chiv10 + 33490.91354316477163179896159405423085123888*chiv12;
	REAL8 PartPN0e010=-84.1731200468330509674837193106681008220571818919425198787821*chiv2 + 1632.1556502464423131543339533210917514561021348328642127227527*chiv4 - 6980.6770678073145618559173118683865225098*chiv6 + 10171.95420219971586519566966379281952196354*chiv8 - 4740.09868017287188223773940375275650320232*chiv10;
	REAL8 PartPN0e08=-53.1835794385354481645525721605245933040230353441875450530406*chiv2 + 545.4983075805580477790127579196803056201350883637871772133796*chiv4 - 1188.4116072357410579773533556883899499441123584584730524371871*chiv6 + 697.9252356610096952346110994116048302761623459490009521598187*chiv8;
	REAL8 PartPN0e06=-29.6710531907850000357891873707115606233044872483125398154709*chiv2 + 134.6199582424244680745440284355484069540007347173820232528123*chiv4 - 108.7201711103416435826408125577100646352723915050784856879039*chiv6;
	REAL8 PartPN0e04=-13.3035240718074255405956752345981232150142798857609139126887*chiv2 + 18.4732774476513865308432371250707413695529145444255800792302*chiv4;
	REAL8 PartPN0e02=-3.6511627906976744186046511627906976744186046511627906976745*chiv2;
	REAL8 PartPN0e00=1.;
	return pref*(PartPN0e00 + e010*PartPN0e010 + e012*PartPN0e012 + e014*PartPN0e014 + e02*PartPN0e02 + e04*PartPN0e04 + e06*PartPN0e06 + e08*PartPN0e08 + (PartPN2e00 + e010*PartPN2e010 + e012*PartPN2e012 + e02*PartPN2e02 + e04*PartPN2e04 + e06*PartPN2e06 + e08*PartPN2e08)*var->vom2 + (PartPN3e00 + e010*PartPN3e010 + e02*PartPN3e02 + e04*PartPN3e04 + e06*PartPN3e06 + e08*PartPN3e08)*var->vom3 + (PartPN4e00 + e02*PartPN4e02 + e04*PartPN4e04 + e06*PartPN4e06 + e08*PartPN4e08)*var->vom4);
#else
	REAL16 PartPN4e08=(58630641867627635*chiv2)/134733904478208 + (20031515539000569127.*chiv4)/2028252325478400 - (24213038150387100101.*chiv6)/466498034860032 + (516657831687794407321.*chiv8)/10709172278525952 - (4973851190113325*chiv2*pms->eta)/5079254335488 - (254054302860454111*chiv4*pms->eta)/76461893222400 + (653675237480725889*chiv6*pms->eta)/17586235441152 - (2289361021463148559*chiv8*pms->eta)/57674113744896 + (53359354862905*chiv2*pms->eta2)/2539627167744 + (15328629037411939*chiv4*pms->eta2)/5461563801600 - (5716110136437127*chiv6*pms->eta2)/418719891456 + (33223971913609231*chiv8*pms->eta2)/2621550624768 - (190598720585*chiv2*pms->sigx2)/141090398208 + (1139538575773*chiv4*pms->sigx2)/37927526400 - (3027389552039*chiv6*pms->sigx2)/34893324288 + (24313961958113*chiv8*pms->sigx2)/400514678784 - (339762936695*chiv2*pms->eta*pms->sigx2)/979794432 + (1693969763339*chiv4*pms->eta*pms->sigx2)/6321254400 + (5025718462093*chiv6*pms->eta*pms->sigx2)/1453888512 - (14028785122951*chiv8*pms->eta*pms->sigx2)/3708469248 + (339762936695*chiv2*pms->kappa1*pms->sigx2)/3919177728 - (1693969763339*chiv4*pms->kappa1*pms->sigx2)/25285017600 - (5025718462093*chiv6*pms->kappa1*pms->sigx2)/5815554048 + (14028785122951*chiv8*pms->kappa1*pms->sigx2)/14833876992 - (339762936695*chiv2*pms->dm*pms->kappa1*pms->sigx2)/3919177728 + (1693969763339*chiv4*pms->dm*pms->kappa1*pms->sigx2)/25285017600 + (5025718462093*chiv6*pms->dm*pms->kappa1*pms->sigx2)/5815554048 - (14028785122951*chiv8*pms->dm*pms->kappa1*pms->sigx2)/14833876992 - (339762936695*chiv2*pms->eta*pms->kappa1*pms->sigx2)/1959588864 + (1693969763339*chiv4*pms->eta*pms->kappa1*pms->sigx2)/12642508800 + (5025718462093*chiv6*pms->eta*pms->kappa1*pms->sigx2)/2907777024 - (14028785122951*chiv8*pms->eta*pms->kappa1*pms->sigx2)/7416938496 + (339762936695*chiv2*pms->kappa2*pms->sigx2)/3919177728 - (1693969763339*chiv4*pms->kappa2*pms->sigx2)/25285017600 - (5025718462093*chiv6*pms->kappa2*pms->sigx2)/5815554048 + (14028785122951*chiv8*pms->kappa2*pms->sigx2)/14833876992 + (339762936695*chiv2*pms->dm*pms->kappa2*pms->sigx2)/3919177728 - (1693969763339*chiv4*pms->dm*pms->kappa2*pms->sigx2)/25285017600 - (5025718462093*chiv6*pms->dm*pms->kappa2*pms->sigx2)/5815554048 + (14028785122951*chiv8*pms->dm*pms->kappa2*pms->sigx2)/14833876992 - (339762936695*chiv2*pms->eta*pms->kappa2*pms->sigx2)/1959588864 + (1693969763339*chiv4*pms->eta*pms->kappa2*pms->sigx2)/12642508800 + (5025718462093*chiv6*pms->eta*pms->kappa2*pms->sigx2)/2907777024 - (14028785122951*chiv8*pms->eta*pms->kappa2*pms->sigx2)/7416938496 + (339762936695*chiv2*pms->dm*pms->sigx*pms->sx)/979794432 - (1693969763339*chiv4*pms->dm*pms->sigx*pms->sx)/6321254400 - (5025718462093*chiv6*pms->dm*pms->sigx*pms->sx)/1453888512 + (14028785122951*chiv8*pms->dm*pms->sigx*pms->sx)/3708469248 - (339762936695*chiv2*pms->kappa1*pms->sigx*pms->sx)/1959588864 + (1693969763339*chiv4*pms->kappa1*pms->sigx*pms->sx)/12642508800 + (5025718462093*chiv6*pms->kappa1*pms->sigx*pms->sx)/2907777024 - (14028785122951*chiv8*pms->kappa1*pms->sigx*pms->sx)/7416938496 + (339762936695*chiv2*pms->dm*pms->kappa1*pms->sigx*pms->sx)/1959588864 - (1693969763339*chiv4*pms->dm*pms->kappa1*pms->sigx*pms->sx)/12642508800 - (5025718462093*chiv6*pms->dm*pms->kappa1*pms->sigx*pms->sx)/2907777024 + (14028785122951*chiv8*pms->dm*pms->kappa1*pms->sigx*pms->sx)/7416938496 + (339762936695*chiv2*pms->kappa2*pms->sigx*pms->sx)/1959588864 - (1693969763339*chiv4*pms->kappa2*pms->sigx*pms->sx)/12642508800 - (5025718462093*chiv6*pms->kappa2*pms->sigx*pms->sx)/2907777024 + (14028785122951*chiv8*pms->kappa2*pms->sigx*pms->sx)/7416938496 + (339762936695*chiv2*pms->dm*pms->kappa2*pms->sigx*pms->sx)/1959588864 - (1693969763339*chiv4*pms->dm*pms->kappa2*pms->sigx*pms->sx)/12642508800 - (5025718462093*chiv6*pms->dm*pms->kappa2*pms->sigx*pms->sx)/2907777024 + (14028785122951*chiv8*pms->dm*pms->kappa2*pms->sigx*pms->sx)/7416938496 + (339762936695*chiv2*pms->sx2)/979794432 - (1693969763339*chiv4*pms->sx2)/6321254400 - (5025718462093*chiv6*pms->sx2)/1453888512 + (14028785122951*chiv8*pms->sx2)/3708469248 + (339762936695*chiv2*pms->kappa1*pms->sx2)/1959588864 - (1693969763339*chiv4*pms->kappa1*pms->sx2)/12642508800 - (5025718462093*chiv6*pms->kappa1*pms->sx2)/2907777024 + (14028785122951*chiv8*pms->kappa1*pms->sx2)/7416938496 + (339762936695*chiv2*pms->kappa2*pms->sx2)/1959588864 - (1693969763339*chiv4*pms->kappa2*pms->sx2)/12642508800 - (5025718462093*chiv6*pms->kappa2*pms->sx2)/2907777024 + (14028785122951*chiv8*pms->kappa2*pms->sx2)/7416938496;
	REAL16 PartPN4e06=(83687769766435*chiv2)/344713936896 + (2710222948303069*chiv4)/1111980441600 - (7286499593857087*chiv6)/1534533009408 - (7099538739325*chiv2*pms->eta)/12995168256 - (34373025864517*chiv4*pms->eta)/41919897600 + (196712379621043*chiv6*pms->eta)/57849458688 + (10880525615*chiv2*pms->eta2)/928226304 + (2073932054833*chiv4*pms->eta2)/2994278400 - (1720165554149*chiv6*pms->eta2)/1377368064 - (38865055*chiv2*pms->sigx2)/51568128 + (154177231*chiv4*pms->sigx2)/20793600 - (911041093*chiv6*pms->sigx2)/114780672 - (69281185*chiv2*pms->eta*pms->sigx2)/358112 + (229190633*chiv4*pms->eta*pms->sigx2)/3465600 + (1512403991*chiv6*pms->eta*pms->sigx2)/4782528 + (69281185*chiv2*pms->kappa1*pms->sigx2)/1432448 - (229190633*chiv4*pms->kappa1*pms->sigx2)/13862400 - (1512403991*chiv6*pms->kappa1*pms->sigx2)/19130112 - (69281185*chiv2*pms->dm*pms->kappa1*pms->sigx2)/1432448 + (229190633*chiv4*pms->dm*pms->kappa1*pms->sigx2)/13862400 + (1512403991*chiv6*pms->dm*pms->kappa1*pms->sigx2)/19130112 - (69281185*chiv2*pms->eta*pms->kappa1*pms->sigx2)/716224 + (229190633*chiv4*pms->eta*pms->kappa1*pms->sigx2)/6931200 + (1512403991*chiv6*pms->eta*pms->kappa1*pms->sigx2)/9565056 + (69281185*chiv2*pms->kappa2*pms->sigx2)/1432448 - (229190633*chiv4*pms->kappa2*pms->sigx2)/13862400 - (1512403991*chiv6*pms->kappa2*pms->sigx2)/19130112 + (69281185*chiv2*pms->dm*pms->kappa2*pms->sigx2)/1432448 - (229190633*chiv4*pms->dm*pms->kappa2*pms->sigx2)/13862400 - (1512403991*chiv6*pms->dm*pms->kappa2*pms->sigx2)/19130112 - (69281185*chiv2*pms->eta*pms->kappa2*pms->sigx2)/716224 + (229190633*chiv4*pms->eta*pms->kappa2*pms->sigx2)/6931200 + (1512403991*chiv6*pms->eta*pms->kappa2*pms->sigx2)/9565056 + (69281185*chiv2*pms->dm*pms->sigx*pms->sx)/358112 - (229190633*chiv4*pms->dm*pms->sigx*pms->sx)/3465600 - (1512403991*chiv6*pms->dm*pms->sigx*pms->sx)/4782528 - (69281185*chiv2*pms->kappa1*pms->sigx*pms->sx)/716224 + (229190633*chiv4*pms->kappa1*pms->sigx*pms->sx)/6931200 + (1512403991*chiv6*pms->kappa1*pms->sigx*pms->sx)/9565056 + (69281185*chiv2*pms->dm*pms->kappa1*pms->sigx*pms->sx)/716224 - (229190633*chiv4*pms->dm*pms->kappa1*pms->sigx*pms->sx)/6931200 - (1512403991*chiv6*pms->dm*pms->kappa1*pms->sigx*pms->sx)/9565056 + (69281185*chiv2*pms->kappa2*pms->sigx*pms->sx)/716224 - (229190633*chiv4*pms->kappa2*pms->sigx*pms->sx)/6931200 - (1512403991*chiv6*pms->kappa2*pms->sigx*pms->sx)/9565056 + (69281185*chiv2*pms->dm*pms->kappa2*pms->sigx*pms->sx)/716224 - (229190633*chiv4*pms->dm*pms->kappa2*pms->sigx*pms->sx)/6931200 - (1512403991*chiv6*pms->dm*pms->kappa2*pms->sigx*pms->sx)/9565056 + (69281185*chiv2*pms->sx2)/358112 - (229190633*chiv4*pms->sx2)/3465600 - (1512403991*chiv6*pms->sx2)/4782528 + (69281185*chiv2*pms->kappa1*pms->sx2)/716224 - (229190633*chiv4*pms->kappa1*pms->sx2)/6931200 - (1512403991*chiv6*pms->kappa1*pms->sx2)/9565056 + (69281185*chiv2*pms->kappa2*pms->sx2)/716224 - (229190633*chiv4*pms->kappa2*pms->sx2)/6931200 - (1512403991*chiv6*pms->kappa2*pms->sx2)/9565056;
	REAL16 PartPN4e04=(164573871193*chiv2)/1511903232 + (815595229703*chiv4)/2438553600 - (13961401735*chiv2*pms->eta)/56996352 - (10343974079*chiv4*pms->eta)/91929600 + (21396797*chiv2*pms->eta2)/4071168 + (624114371*chiv4*pms->eta2)/6566400 - (76429*chiv2*pms->sigx2)/226176 + (46397*chiv4*pms->sigx2)/45600 - (408729*chiv2*pms->eta*pms->sigx2)/4712 + (68971*chiv4*pms->eta*pms->sigx2)/7600 + (408729*chiv2*pms->kappa1*pms->sigx2)/18848 - (68971*chiv4*pms->kappa1*pms->sigx2)/30400 - (408729*chiv2*pms->dm*pms->kappa1*pms->sigx2)/18848 + (68971*chiv4*pms->dm*pms->kappa1*pms->sigx2)/30400 - (408729*chiv2*pms->eta*pms->kappa1*pms->sigx2)/9424 + (68971*chiv4*pms->eta*pms->kappa1*pms->sigx2)/15200 + (408729*chiv2*pms->kappa2*pms->sigx2)/18848 - (68971*chiv4*pms->kappa2*pms->sigx2)/30400 + (408729*chiv2*pms->dm*pms->kappa2*pms->sigx2)/18848 - (68971*chiv4*pms->dm*pms->kappa2*pms->sigx2)/30400 - (408729*chiv2*pms->eta*pms->kappa2*pms->sigx2)/9424 + (68971*chiv4*pms->eta*pms->kappa2*pms->sigx2)/15200 + (408729*chiv2*pms->dm*pms->sigx*pms->sx)/4712 - (68971*chiv4*pms->dm*pms->sigx*pms->sx)/7600 - (408729*chiv2*pms->kappa1*pms->sigx*pms->sx)/9424 + (68971*chiv4*pms->kappa1*pms->sigx*pms->sx)/15200 + (408729*chiv2*pms->dm*pms->kappa1*pms->sigx*pms->sx)/9424 - (68971*chiv4*pms->dm*pms->kappa1*pms->sigx*pms->sx)/15200 + (408729*chiv2*pms->kappa2*pms->sigx*pms->sx)/9424 - (68971*chiv4*pms->kappa2*pms->sigx*pms->sx)/15200 + (408729*chiv2*pms->dm*pms->kappa2*pms->sigx*pms->sx)/9424 - (68971*chiv4*pms->dm*pms->kappa2*pms->sigx*pms->sx)/15200 + (408729*chiv2*pms->sx2)/4712 - (68971*chiv4*pms->sx2)/7600 + (408729*chiv2*pms->kappa1*pms->sx2)/9424 - (68971*chiv4*pms->kappa1*pms->sx2)/15200 + (408729*chiv2*pms->kappa2*pms->sx2)/9424 - (68971*chiv4*pms->kappa2*pms->sx2)/15200;
	REAL16 PartPN4e02=(940988129*chiv2)/31497984 - (4201445*chiv2*pms->eta)/62496 + (6439*chiv2*pms->eta2)/4464 - (23*chiv2*pms->sigx2)/248 - (738*chiv2*pms->eta*pms->sigx2)/31 + (369*chiv2*pms->kappa1*pms->sigx2)/62 - (369*chiv2*pms->dm*pms->kappa1*pms->sigx2)/62 - (369*chiv2*pms->eta*pms->kappa1*pms->sigx2)/31 + (369*chiv2*pms->kappa2*pms->sigx2)/62 + (369*chiv2*pms->dm*pms->kappa2*pms->sigx2)/62 - (369*chiv2*pms->eta*pms->kappa2*pms->sigx2)/31 + (738*chiv2*pms->dm*pms->sigx*pms->sx)/31 - (369*chiv2*pms->kappa1*pms->sigx*pms->sx)/31 + (369*chiv2*pms->dm*pms->kappa1*pms->sigx*pms->sx)/31 + (369*chiv2*pms->kappa2*pms->sigx*pms->sx)/31 + (369*chiv2*pms->dm*pms->kappa2*pms->sigx*pms->sx)/31 + (738*chiv2*pms->sx2)/31 + (369*chiv2*pms->kappa1*pms->sx2)/31 + (369*chiv2*pms->kappa2*pms->sx2)/31;
	REAL16 PartPN4e00=-6787471./508032 + (2069*pms->eta)/504 + (617*pms->eta2)/72 - pms->sigx2/8 + 36*pms->eta*pms->sigx2 - 9*pms->kappa1*pms->sigx2 + 9*pms->dm*pms->kappa1*pms->sigx2 + 18*pms->eta*pms->kappa1*pms->sigx2 - 9*pms->kappa2*pms->sigx2 - 9*pms->dm*pms->kappa2*pms->sigx2 + 18*pms->eta*pms->kappa2*pms->sigx2 - 36*pms->dm*pms->sigx*pms->sx + 18*pms->kappa1*pms->sigx*pms->sx - 18*pms->dm*pms->kappa1*pms->sigx*pms->sx - 18*pms->kappa2*pms->sigx*pms->sx - 18*pms->dm*pms->kappa2*pms->sigx*pms->sx - 36*pms->sx2 - 18*pms->kappa1*pms->sx2 - 18*pms->kappa2*pms->sx2;
	REAL16 PartPN3e010=(34281438037440095*chiv2*CST_PI)/70563404316672 - (24478501894737425*chiv4*CST_PI)/3437371717632 + (30739569871016783*chiv6*CST_PI)/1844794884096 - (16593568732653697*chiv8*CST_PI)/94430438129664 - (4468067171205989189*chiv10*CST_PI)/356708385792000 - (2320516043008855*chiv2*pms->dm*pms->sigx)/11141590155264 + (1485951231985*chiv4*pms->dm*pms->sigx)/67842862848 + (506274773264323*chiv6*pms->dm*pms->sigx)/48547233792 - (14324203175580529*chiv8*pms->dm*pms->sigx)/532502470656 + (11209751328167987*chiv10*pms->dm*pms->sigx)/655387656192 - (86241859124195075*chiv2*pms->sx)/105845106475008 + (27165918524112005*chiv4*pms->sx)/5156057576448 + (12617344093090373*chiv6*pms->sx)/2767192326144 - (5156790576826647971*chiv8*pms->sx)/141645657194496 + (2438767223148613919*chiv10*pms->sx)/85610012590080;
	REAL16 PartPN3e08=(11875128982535*chiv2*CST_PI)/38686076928 - (191372949645785*chiv4*CST_PI)/80406355968 + (51643396178849*chiv6*CST_PI)/18205212672 - (4993550626739*chiv8*CST_PI)/414168588288 - (803829386815*chiv2*pms->dm*pms->sigx)/6108327936 + (11617168057*chiv4*pms->dm*pms->sigx)/1586967552 + (850556751469*chiv6*pms->dm*pms->sigx)/479084544 - (4310623886723*chiv8*pms->dm*pms->sigx)/2335537152 - (29874277726475*chiv2*pms->sx)/58029115392 + (212383175251181*chiv4*pms->sx)/120609533952 + (21197515204619*chiv6*pms->sx)/27307819008 - (1551847901542777*chiv8*pms->sx)/621252882432;
	REAL16 PartPN3e06=(2421461905*chiv2*CST_PI)/14139648 - (25892367395*chiv4*CST_PI)/44082432 + (15541196563*chiv6*CST_PI)/59885568 - (163909145*chiv2*pms->dm*pms->sigx)/2232576 + (1571779*chiv4*pms->dm*pms->sigx)/870048 + (255960503*chiv6*pms->dm*pms->sigx)/1575936 - (6091674925*chiv2*pms->sx)/21209472 + (28735007807*chiv4*pms->sx)/66123648 + (6379029553*chiv6*pms->sx)/89828352;
	REAL16 PartPN3e04=(4761859*chiv2*CST_PI)/62016 - (7791865*chiv4*CST_PI)/96672 - (322331*chiv2*pms->dm*pms->sigx)/9792 + (473*chiv4*pms->dm*pms->sigx)/1908 - (11979415*chiv2*pms->sx)/93024 + (8647309*chiv4*pms->sx)/145008;
	REAL16 PartPN3e02=(1433*chiv2*CST_PI)/68 - (1843*chiv2*pms->dm*pms->sigx)/204 - (3605*chiv2*pms->sx)/102;
	REAL16 PartPN3e00=(-32*CST_PI)/5 + (166*pms->dm*pms->sigx)/15 + (488*pms->sx)/15;
	REAL16 PartPN2e012=(64350836513743652353.*chiv2)/158991802290929664 + (1128807045935211140965.*chiv4)/556471308018253824 - (145763346244687590133.*chiv6)/1635718130565120 + (1475539362986592886258547.*chiv8)/3736307353836847104 - (10480753152228068540308915.*chiv10)/17966073658875052032. + (69227763272548873107931.*chiv12)/249844260742889472 + (62855226534424537*chiv2*pms->eta)/473189887770624 - (641772446094032759185.*chiv4*pms->eta)/52997267430309888 + (24697616469191965013.*chiv6*pms->eta)/194728348876800 - (75068527346086894608433.*chiv8*pms->eta)/177919397801754624 + (116512359871615895706335.*chiv10*pms->eta)/213881829272322048 - (19885330342810899978647.*chiv12*pms->eta)/83281420247629824;
	REAL16 PartPN2e010=(1787921726869616455*chiv2)/6450325312241664 + (31309680456485905*chiv4)/38135369244672 - (48916306981237291*chiv6)/2305993605120 + (105117145180119735643.*chiv8)/2048414119428096 - (630800671214448904021.*chiv10)/19699642169819136 + (1746367743707695*chiv2*pms->eta)/19197396762624 - (17800819267861645*chiv4*pms->eta)/3631939928064 + (58017420292937357*chiv6*pms->eta)/1921661337600 - (5347867691936391977*chiv8*pms->eta)/97543529496576 + (7012480281168576329*chiv10*pms->eta)/234519549640704;
	REAL16 PartPN2e08=(88476873169945*chiv2)/505194651648 + (244779109734361*chiv4)/892055420928 - (575266004744611*chiv6)/159295610880 + (31633206494167841*chiv8)/8984272453632 + (604943765335*chiv2*pms->eta)/10524888576 - (139166820912949*chiv4*pms->eta)/84957659136 + (97471000213571*chiv6*pms->eta)/18963763200 - (1609349290381099*chiv8*pms->eta)/427822497792;
	REAL16 PartPN2e06=(126289461545*chiv2)/1292530176 + (33118111267*chiv4)/489065472 - (173116462457*chiv6)/523998720 + (123354305*chiv2*pms->eta)/3846816 - (18828985303*chiv4*pms->eta)/46577664 + (29332229977*chiv6*pms->eta)/62380800;
	REAL16 PartPN2e04=(248351051*chiv2)/5668992 + (9966329*chiv4)/1072512 + (242579*chiv2*pms->eta)/16872 - (5666261*chiv4*pms->eta)/102144;
	REAL16 PartPN2e02=(74737*chiv2)/6216 + (146*chiv2*pms->eta)/37;
	REAL16 PartPN2e00=-3289/252 + (11*pms->eta)/3;
	REAL16 PartPN0e014=(-9442883962057324358267.*chiv2)/55669843916438372352. + (116665284621803736380597.*chiv4)/13378024507051081728. - (19509251991380610875.*chiv6)/197324726861824 + (10970704965707828342179871.*chiv8)/25892950658808545280. - (310354825607436071222995.*chiv10)/377605530440957952 + (6645889092554709504533.*chiv12)/9076937435643904 - (24761899212034647783244189.*chiv14)/101629831335823540224.;
	REAL16 PartPN0e012=(-5001726177239344321*chiv2)/40694330348273664 + (118308234280923558005.*chiv4)/29337773041778688 - (38069727572308575*chiv6)/1298188992512 + (1481672602992820958237.*chiv8)/18927595510824960 - (1215668924972340403955.*chiv10)/14077399161176064 + (1999966624301748271*chiv12)/59716693655552;
	REAL16 PartPN0e010=(-3755886791261755*chiv2)/44620976259072 + (3281511241487585*chiv4)/2010538174464 - (29809993847725*chiv6)/4270358528 + (105554076038307253*chiv8)/10376971223040 - (73166953052804117*chiv10)/15435744694272;
	REAL16 PartPN0e08=(-1301043440515*chiv2)/24463254528 + (25654857812777*chiv4)/47030132736 - (50081680675*chiv6)/42141696 + (31764693360911*chiv8)/45513031680;
	REAL16 PartPN0e06=(-265296245*chiv2)/8941248 + (3471049619*chiv4)/25784064 - (15071225*chiv6)/138624;
	REAL16 PartPN0e04=(-521711*chiv2)/39216 + (1044553*chiv4)/56544;
	REAL16 PartPN0e02=(-157*chiv2)/43;
	REAL16 PartPN0e00=1;
	return pref*(PartPN0e00 + e010*PartPN0e010 + e012*PartPN0e012 + e014*PartPN0e014 + e02*PartPN0e02 + e04*PartPN0e04 + e06*PartPN0e06 + e08*PartPN0e08 + (PartPN2e00 + e010*PartPN2e010 + e012*PartPN2e012 + e02*PartPN2e02 + e04*PartPN2e04 + e06*PartPN2e06 + e08*PartPN2e08)*var->vom2 + (PartPN3e00 + e010*PartPN3e010 + e02*PartPN3e02 + e04*PartPN3e04 + e06*PartPN3e06 + e08*PartPN3e08)*var->vom3 + (PartPN4e00 + e02*PartPN4e02 + e04*PartPN4e04 + e06*PartPN4e06 + e08*PartPN4e08)*var->vom4);
#endif
}


REAL8 Calculate_vom(INT n, INT m, REAL8 freq, BBHCore *core)
{
    BBHDynParams *pms = core->pms;
    BBHDynVariables *var = core->var;

    REAL8 nom = (REAL8)n / m;
    REAL8 nom2 = nom*nom;
    REAL8 vfm = pow(CST_2PI*freq / m, 1./3.);
    REAL8 vfm2 = vfm*vfm;
    REAL8 vfm3 = vfm2*vfm;
    REAL8 vfm4 = vfm2*vfm2;
    REAL8 chifm = pow(pms->vomini / vfm, 19./6.);
    REAL8 chifm2 = chifm*chifm;
    REAL8 chifm4 = chifm2*chifm2;
    REAL8 chifm6 = chifm4*chifm4;
    REAL8 chifm8 = chifm6*chifm2;
    REAL8 chifm10 = chifm8*chifm2;
    REAL8 chifm12 = chifm10*chifm2;

    REAL8 e02 = pms->eini*pms->eini;
    REAL8 e04 = e02*e02;
    REAL8 e06 = e04*e02;
    REAL8 e08 = e06*e02;
    REAL8 e010 = e08*e02;
    REAL8 e012 = e010*e02;
    REAL8 e014 = e012*e02;

	REAL8 PartPN4e08=(-1947421710325*chifm2)/6826954752 + (14361791552141*chifm4)/9102606336 - (543514708319*chifm6)/168566784 + (53557878661915*chifm8)/27307819008 + (339762936695*chifm2*pms->eta)/3413477376 - (1823060324243*chifm4*pms->eta)/4551303168 + (18165953759*chifm6*pms->eta)/28094464 - (4440894807677*chifm8*pms->eta)/13653909504 - (865279124637395*chifm2*nom)/4874445692928 + (813075626335421840849.*chifm4*nom)/647586358457794560 - (6077515292569335403*chifm6*nom)/2108309269118976 + (7432922880091828248469.*chifm8*nom)/3968779253977055232 + (46585878839929*chifm2*pms->eta*nom)/928465846272 - (1047495484294159841*chifm4*pms->eta*nom)/3854680705105920 + (12135328545586042697.*chifm6*pms->eta*nom)/22614126803288064 - (1042235036041662923333.*chifm8*pms->eta*nom)/3307316044980879360 + (455779549225*chifm2*nom2)/77372153856 + (16484578177058033*chifm4*nom2)/232374368747520 - (5571990136643183*chifm6*nom2)/20655499444224 + (14459833254951247*chifm8*nom2)/67918243806720 + (8286900895*chifm2*pms->eta*pms->sigx2)/284456448 - (48015990595*chifm4*pms->eta*pms->sigx2)/379275264 + (4373775799*chifm6*pms->eta*pms->sigx2)/21070848 - (119594395981*chifm8*pms->eta*pms->sigx2)/1137825792 - (8286900895*chifm2*pms->kappa1*pms->sigx2)/1137825792 + (48015990595*chifm4*pms->kappa1*pms->sigx2)/1517101056 - (4373775799*chifm6*pms->kappa1*pms->sigx2)/84283392 + (119594395981*chifm8*pms->kappa1*pms->sigx2)/4551303168 + (8286900895*chifm2*pms->dm*pms->kappa1*pms->sigx2)/1137825792 - (48015990595*chifm4*pms->dm*pms->kappa1*pms->sigx2)/1517101056 + (4373775799*chifm6*pms->dm*pms->kappa1*pms->sigx2)/84283392 - (119594395981*chifm8*pms->dm*pms->kappa1*pms->sigx2)/4551303168 + (8286900895*chifm2*pms->eta*pms->kappa1*pms->sigx2)/568912896 - (48015990595*chifm4*pms->eta*pms->kappa1*pms->sigx2)/758550528 + (4373775799*chifm6*pms->eta*pms->kappa1*pms->sigx2)/42141696 - (119594395981*chifm8*pms->eta*pms->kappa1*pms->sigx2)/2275651584 - (8286900895*chifm2*pms->kappa2*pms->sigx2)/1137825792 + (48015990595*chifm4*pms->kappa2*pms->sigx2)/1517101056 - (4373775799*chifm6*pms->kappa2*pms->sigx2)/84283392 + (119594395981*chifm8*pms->kappa2*pms->sigx2)/4551303168 - (8286900895*chifm2*pms->dm*pms->kappa2*pms->sigx2)/1137825792 + (48015990595*chifm4*pms->dm*pms->kappa2*pms->sigx2)/1517101056 - (4373775799*chifm6*pms->dm*pms->kappa2*pms->sigx2)/84283392 + (119594395981*chifm8*pms->dm*pms->kappa2*pms->sigx2)/4551303168 + (8286900895*chifm2*pms->eta*pms->kappa2*pms->sigx2)/568912896 - (48015990595*chifm4*pms->eta*pms->kappa2*pms->sigx2)/758550528 + (4373775799*chifm6*pms->eta*pms->kappa2*pms->sigx2)/42141696 - (119594395981*chifm8*pms->eta*pms->kappa2*pms->sigx2)/2275651584 + (1657380179*chifm2*pms->eta*nom*pms->sigx2)/12895358976 - (4360957173431*chifm4*pms->eta*nom*pms->sigx2)/2278180085760 + (593993490817*chifm6*pms->eta*nom*pms->sigx2)/202504896512 - (241098424237511*chifm8*pms->eta*nom*pms->sigx2)/177698046689280 - (1657380179*chifm2*pms->kappa1*nom*pms->sigx2)/51581435904 + (4360957173431*chifm4*pms->kappa1*nom*pms->sigx2)/9112720343040 - (593993490817*chifm6*pms->kappa1*nom*pms->sigx2)/810019586048 + (241098424237511*chifm8*pms->kappa1*nom*pms->sigx2)/710792186757120 + (1657380179*chifm2*pms->dm*pms->kappa1*nom*pms->sigx2)/51581435904 - (4360957173431*chifm4*pms->dm*pms->kappa1*nom*pms->sigx2)/9112720343040 + (593993490817*chifm6*pms->dm*pms->kappa1*nom*pms->sigx2)/810019586048 - (241098424237511*chifm8*pms->dm*pms->kappa1*nom*pms->sigx2)/710792186757120 + (1657380179*chifm2*pms->eta*pms->kappa1*nom*pms->sigx2)/25790717952 - (4360957173431*chifm4*pms->eta*pms->kappa1*nom*pms->sigx2)/4556360171520 + (593993490817*chifm6*pms->eta*pms->kappa1*nom*pms->sigx2)/405009793024 - (241098424237511*chifm8*pms->eta*pms->kappa1*nom*pms->sigx2)/355396093378560 - (1657380179*chifm2*pms->kappa2*nom*pms->sigx2)/51581435904 + (4360957173431*chifm4*pms->kappa2*nom*pms->sigx2)/9112720343040 - (593993490817*chifm6*pms->kappa2*nom*pms->sigx2)/810019586048 + (241098424237511*chifm8*pms->kappa2*nom*pms->sigx2)/710792186757120 - (1657380179*chifm2*pms->dm*pms->kappa2*nom*pms->sigx2)/51581435904 + (4360957173431*chifm4*pms->dm*pms->kappa2*nom*pms->sigx2)/9112720343040 - (593993490817*chifm6*pms->dm*pms->kappa2*nom*pms->sigx2)/810019586048 + (241098424237511*chifm8*pms->dm*pms->kappa2*nom*pms->sigx2)/710792186757120 + (1657380179*chifm2*pms->eta*pms->kappa2*nom*pms->sigx2)/25790717952 - (4360957173431*chifm4*pms->eta*pms->kappa2*nom*pms->sigx2)/4556360171520 + (593993490817*chifm6*pms->eta*pms->kappa2*nom*pms->sigx2)/405009793024 - (241098424237511*chifm8*pms->eta*pms->kappa2*nom*pms->sigx2)/355396093378560 - (8286900895*chifm2*pms->dm*pms->sigx*pms->sx)/284456448 + (48015990595*chifm4*pms->dm*pms->sigx*pms->sx)/379275264 - (4373775799*chifm6*pms->dm*pms->sigx*pms->sx)/21070848 + (119594395981*chifm8*pms->dm*pms->sigx*pms->sx)/1137825792 + (8286900895*chifm2*pms->kappa1*pms->sigx*pms->sx)/568912896 - (48015990595*chifm4*pms->kappa1*pms->sigx*pms->sx)/758550528 + (4373775799*chifm6*pms->kappa1*pms->sigx*pms->sx)/42141696 - (119594395981*chifm8*pms->kappa1*pms->sigx*pms->sx)/2275651584 - (8286900895*chifm2*pms->dm*pms->kappa1*pms->sigx*pms->sx)/568912896 + (48015990595*chifm4*pms->dm*pms->kappa1*pms->sigx*pms->sx)/758550528 - (4373775799*chifm6*pms->dm*pms->kappa1*pms->sigx*pms->sx)/42141696 + (119594395981*chifm8*pms->dm*pms->kappa1*pms->sigx*pms->sx)/2275651584 - (8286900895*chifm2*pms->kappa2*pms->sigx*pms->sx)/568912896 + (48015990595*chifm4*pms->kappa2*pms->sigx*pms->sx)/758550528 - (4373775799*chifm6*pms->kappa2*pms->sigx*pms->sx)/42141696 + (119594395981*chifm8*pms->kappa2*pms->sigx*pms->sx)/2275651584 - (8286900895*chifm2*pms->dm*pms->kappa2*pms->sigx*pms->sx)/568912896 + (48015990595*chifm4*pms->dm*pms->kappa2*pms->sigx*pms->sx)/758550528 - (4373775799*chifm6*pms->dm*pms->kappa2*pms->sigx*pms->sx)/42141696 + (119594395981*chifm8*pms->dm*pms->kappa2*pms->sigx*pms->sx)/2275651584 - (1657380179*chifm2*pms->dm*nom*pms->sigx*pms->sx)/12895358976 + (4360957173431*chifm4*pms->dm*nom*pms->sigx*pms->sx)/2278180085760 - (593993490817*chifm6*pms->dm*nom*pms->sigx*pms->sx)/202504896512 + (241098424237511*chifm8*pms->dm*nom*pms->sigx*pms->sx)/177698046689280 + (1657380179*chifm2*pms->kappa1*nom*pms->sigx*pms->sx)/25790717952 - (4360957173431*chifm4*pms->kappa1*nom*pms->sigx*pms->sx)/4556360171520 + (593993490817*chifm6*pms->kappa1*nom*pms->sigx*pms->sx)/405009793024 - (241098424237511*chifm8*pms->kappa1*nom*pms->sigx*pms->sx)/355396093378560 - (1657380179*chifm2*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/25790717952 + (4360957173431*chifm4*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/4556360171520 - (593993490817*chifm6*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/405009793024 + (241098424237511*chifm8*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/355396093378560 - (1657380179*chifm2*pms->kappa2*nom*pms->sigx*pms->sx)/25790717952 + (4360957173431*chifm4*pms->kappa2*nom*pms->sigx*pms->sx)/4556360171520 - (593993490817*chifm6*pms->kappa2*nom*pms->sigx*pms->sx)/405009793024 + (241098424237511*chifm8*pms->kappa2*nom*pms->sigx*pms->sx)/355396093378560 - (1657380179*chifm2*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/25790717952 + (4360957173431*chifm4*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/4556360171520 - (593993490817*chifm6*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/405009793024 + (241098424237511*chifm8*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/355396093378560 - (8286900895*chifm2*pms->sx2)/284456448 + (48015990595*chifm4*pms->sx2)/379275264 - (4373775799*chifm6*pms->sx2)/21070848 + (119594395981*chifm8*pms->sx2)/1137825792 - (8286900895*chifm2*pms->kappa1*pms->sx2)/568912896 + (48015990595*chifm4*pms->kappa1*pms->sx2)/758550528 - (4373775799*chifm6*pms->kappa1*pms->sx2)/42141696 + (119594395981*chifm8*pms->kappa1*pms->sx2)/2275651584 - (8286900895*chifm2*pms->kappa2*pms->sx2)/568912896 + (48015990595*chifm4*pms->kappa2*pms->sx2)/758550528 - (4373775799*chifm6*pms->kappa2*pms->sx2)/42141696 + (119594395981*chifm8*pms->kappa2*pms->sx2)/2275651584 - (1657380179*chifm2*nom*pms->sx2)/12895358976 + (4360957173431*chifm4*nom*pms->sx2)/2278180085760 - (593993490817*chifm6*nom*pms->sx2)/202504896512 + (241098424237511*chifm8*nom*pms->sx2)/177698046689280 - (1657380179*chifm2*pms->kappa1*nom*pms->sx2)/25790717952 + (4360957173431*chifm4*pms->kappa1*nom*pms->sx2)/4556360171520 - (593993490817*chifm6*pms->kappa1*nom*pms->sx2)/405009793024 + (241098424237511*chifm8*pms->kappa1*nom*pms->sx2)/355396093378560 - (1657380179*chifm2*pms->kappa2*nom*pms->sx2)/25790717952 + (4360957173431*chifm4*pms->kappa2*nom*pms->sx2)/4556360171520 - (593993490817*chifm6*pms->kappa2*nom*pms->sx2)/405009793024 + (241098424237511*chifm8*pms->kappa2*nom*pms->sx2)/355396093378560;
	REAL8 PartPN4e06=(-397099475*chifm2)/2495232 + (1943120927*chifm4)/4990464 - (163561453*chifm6)/554496 + (69281185*chifm2*pms->eta)/1247616 - (246656321*chifm4*pms->eta)/2495232 + (5466733*chifm6*pms->eta)/92416 - (1235075684995*chifm2*nom)/12471169536 + (110007463834166603*chifm4*nom)/355036380733440 - (1828924252954961*chifm6*nom)/6935227858944 + (66495405449*chifm2*pms->eta*nom)/2375460864 - (141723989592827*chifm4*pms->eta*nom)/2113311790080 + (3651919514169739*chifm6*pms->eta*nom)/74388575010816 + (92938175*chifm2*nom2)/28279296 + (2230329601451*chifm4*nom2)/127398228480 - (1676795105821*chifm6*nom2)/67945721856 + (1689785*chifm2*pms->eta*pms->sigx2)/103968 - (6496465*chifm4*pms->eta*pms->sigx2)/207936 + (1316213*chifm6*pms->eta*pms->sigx2)/69312 - (1689785*chifm2*pms->kappa1*pms->sigx2)/415872 + (6496465*chifm4*pms->kappa1*pms->sigx2)/831744 - (1316213*chifm6*pms->kappa1*pms->sigx2)/277248 + (1689785*chifm2*pms->dm*pms->kappa1*pms->sigx2)/415872 - (6496465*chifm4*pms->dm*pms->kappa1*pms->sigx2)/831744 + (1316213*chifm6*pms->dm*pms->kappa1*pms->sigx2)/277248 + (1689785*chifm2*pms->eta*pms->kappa1*pms->sigx2)/207936 - (6496465*chifm4*pms->eta*pms->kappa1*pms->sigx2)/415872 + (1316213*chifm6*pms->eta*pms->kappa1*pms->sigx2)/138624 - (1689785*chifm2*pms->kappa2*pms->sigx2)/415872 + (6496465*chifm4*pms->kappa2*pms->sigx2)/831744 - (1316213*chifm6*pms->kappa2*pms->sigx2)/277248 - (1689785*chifm2*pms->dm*pms->kappa2*pms->sigx2)/415872 + (6496465*chifm4*pms->dm*pms->kappa2*pms->sigx2)/831744 - (1316213*chifm6*pms->dm*pms->kappa2*pms->sigx2)/277248 + (1689785*chifm2*pms->eta*pms->kappa2*pms->sigx2)/207936 - (6496465*chifm4*pms->eta*pms->kappa2*pms->sigx2)/415872 + (1316213*chifm6*pms->eta*pms->kappa2*pms->sigx2)/138624 + (337957*chifm2*pms->eta*nom*pms->sigx2)/4713216 - (590028557*chifm4*pms->eta*nom*pms->sigx2)/1249002240 + (178752179*chifm6*pms->eta*nom*pms->sigx2)/666134528 - (337957*chifm2*pms->kappa1*nom*pms->sigx2)/18852864 + (590028557*chifm4*pms->kappa1*nom*pms->sigx2)/4996008960 - (178752179*chifm6*pms->kappa1*nom*pms->sigx2)/2664538112 + (337957*chifm2*pms->dm*pms->kappa1*nom*pms->sigx2)/18852864 - (590028557*chifm4*pms->dm*pms->kappa1*nom*pms->sigx2)/4996008960 + (178752179*chifm6*pms->dm*pms->kappa1*nom*pms->sigx2)/2664538112 + (337957*chifm2*pms->eta*pms->kappa1*nom*pms->sigx2)/9426432 - (590028557*chifm4*pms->eta*pms->kappa1*nom*pms->sigx2)/2498004480 + (178752179*chifm6*pms->eta*pms->kappa1*nom*pms->sigx2)/1332269056 - (337957*chifm2*pms->kappa2*nom*pms->sigx2)/18852864 + (590028557*chifm4*pms->kappa2*nom*pms->sigx2)/4996008960 - (178752179*chifm6*pms->kappa2*nom*pms->sigx2)/2664538112 - (337957*chifm2*pms->dm*pms->kappa2*nom*pms->sigx2)/18852864 + (590028557*chifm4*pms->dm*pms->kappa2*nom*pms->sigx2)/4996008960 - (178752179*chifm6*pms->dm*pms->kappa2*nom*pms->sigx2)/2664538112 + (337957*chifm2*pms->eta*pms->kappa2*nom*pms->sigx2)/9426432 - (590028557*chifm4*pms->eta*pms->kappa2*nom*pms->sigx2)/2498004480 + (178752179*chifm6*pms->eta*pms->kappa2*nom*pms->sigx2)/1332269056 - (1689785*chifm2*pms->dm*pms->sigx*pms->sx)/103968 + (6496465*chifm4*pms->dm*pms->sigx*pms->sx)/207936 - (1316213*chifm6*pms->dm*pms->sigx*pms->sx)/69312 + (1689785*chifm2*pms->kappa1*pms->sigx*pms->sx)/207936 - (6496465*chifm4*pms->kappa1*pms->sigx*pms->sx)/415872 + (1316213*chifm6*pms->kappa1*pms->sigx*pms->sx)/138624 - (1689785*chifm2*pms->dm*pms->kappa1*pms->sigx*pms->sx)/207936 + (6496465*chifm4*pms->dm*pms->kappa1*pms->sigx*pms->sx)/415872 - (1316213*chifm6*pms->dm*pms->kappa1*pms->sigx*pms->sx)/138624 - (1689785*chifm2*pms->kappa2*pms->sigx*pms->sx)/207936 + (6496465*chifm4*pms->kappa2*pms->sigx*pms->sx)/415872 - (1316213*chifm6*pms->kappa2*pms->sigx*pms->sx)/138624 - (1689785*chifm2*pms->dm*pms->kappa2*pms->sigx*pms->sx)/207936 + (6496465*chifm4*pms->dm*pms->kappa2*pms->sigx*pms->sx)/415872 - (1316213*chifm6*pms->dm*pms->kappa2*pms->sigx*pms->sx)/138624 - (337957*chifm2*pms->dm*nom*pms->sigx*pms->sx)/4713216 + (590028557*chifm4*pms->dm*nom*pms->sigx*pms->sx)/1249002240 - (178752179*chifm6*pms->dm*nom*pms->sigx*pms->sx)/666134528 + (337957*chifm2*pms->kappa1*nom*pms->sigx*pms->sx)/9426432 - (590028557*chifm4*pms->kappa1*nom*pms->sigx*pms->sx)/2498004480 + (178752179*chifm6*pms->kappa1*nom*pms->sigx*pms->sx)/1332269056 - (337957*chifm2*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/9426432 + (590028557*chifm4*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/2498004480 - (178752179*chifm6*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/1332269056 - (337957*chifm2*pms->kappa2*nom*pms->sigx*pms->sx)/9426432 + (590028557*chifm4*pms->kappa2*nom*pms->sigx*pms->sx)/2498004480 - (178752179*chifm6*pms->kappa2*nom*pms->sigx*pms->sx)/1332269056 - (337957*chifm2*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/9426432 + (590028557*chifm4*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/2498004480 - (178752179*chifm6*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/1332269056 - (1689785*chifm2*pms->sx2)/103968 + (6496465*chifm4*pms->sx2)/207936 - (1316213*chifm6*pms->sx2)/69312 - (1689785*chifm2*pms->kappa1*pms->sx2)/207936 + (6496465*chifm4*pms->kappa1*pms->sx2)/415872 - (1316213*chifm6*pms->kappa1*pms->sx2)/138624 - (1689785*chifm2*pms->kappa2*pms->sx2)/207936 + (6496465*chifm4*pms->kappa2*pms->sx2)/415872 - (1316213*chifm6*pms->kappa2*pms->sx2)/138624 - (337957*chifm2*nom*pms->sx2)/4713216 + (590028557*chifm4*nom*pms->sx2)/1249002240 - (178752179*chifm6*nom*pms->sx2)/666134528 - (337957*chifm2*pms->kappa1*nom*pms->sx2)/9426432 + (590028557*chifm4*pms->kappa1*nom*pms->sx2)/2498004480 - (178752179*chifm6*pms->kappa1*nom*pms->sx2)/1332269056 - (337957*chifm2*pms->kappa2*nom*pms->sx2)/9426432 + (590028557*chifm4*pms->kappa2*nom*pms->sx2)/2498004480 - (178752179*chifm6*pms->kappa2*nom*pms->sx2)/1332269056;
	REAL8 PartPN4e04=(-780905*chifm2)/10944 + (584749*chifm4)/10944 + (136243*chifm2*pms->eta)/5472 - (74227*chifm4*pms->eta)/5472 - (2428803961*chifm2*nom)/54698112 + (33104864229361*chifm4*nom)/778588554240 + (653823511*chifm2*pms->eta*nom)/52093440 - (42649410049*chifm4*pms->eta*nom)/4634455680 + (182765*chifm2*nom2)/124032 + (671179537*chifm4*nom2)/279382080 + (3323*chifm2*pms->eta*pms->sigx2)/456 - (1955*chifm4*pms->eta*pms->sigx2)/456 - (3323*chifm2*pms->kappa1*pms->sigx2)/1824 + (1955*chifm4*pms->kappa1*pms->sigx2)/1824 + (3323*chifm2*pms->dm*pms->kappa1*pms->sigx2)/1824 - (1955*chifm4*pms->dm*pms->kappa1*pms->sigx2)/1824 + (3323*chifm2*pms->eta*pms->kappa1*pms->sigx2)/912 - (1955*chifm4*pms->eta*pms->kappa1*pms->sigx2)/912 - (3323*chifm2*pms->kappa2*pms->sigx2)/1824 + (1955*chifm4*pms->kappa2*pms->sigx2)/1824 - (3323*chifm2*pms->dm*pms->kappa2*pms->sigx2)/1824 + (1955*chifm4*pms->dm*pms->kappa2*pms->sigx2)/1824 + (3323*chifm2*pms->eta*pms->kappa2*pms->sigx2)/912 - (1955*chifm4*pms->eta*pms->kappa2*pms->sigx2)/912 + (3323*chifm2*pms->eta*nom*pms->sigx2)/103360 - (177559*chifm4*pms->eta*nom*pms->sigx2)/2739040 - (3323*chifm2*pms->kappa1*nom*pms->sigx2)/413440 + (177559*chifm4*pms->kappa1*nom*pms->sigx2)/10956160 + (3323*chifm2*pms->dm*pms->kappa1*nom*pms->sigx2)/413440 - (177559*chifm4*pms->dm*pms->kappa1*nom*pms->sigx2)/10956160 + (3323*chifm2*pms->eta*pms->kappa1*nom*pms->sigx2)/206720 - (177559*chifm4*pms->eta*pms->kappa1*nom*pms->sigx2)/5478080 - (3323*chifm2*pms->kappa2*nom*pms->sigx2)/413440 + (177559*chifm4*pms->kappa2*nom*pms->sigx2)/10956160 - (3323*chifm2*pms->dm*pms->kappa2*nom*pms->sigx2)/413440 + (177559*chifm4*pms->dm*pms->kappa2*nom*pms->sigx2)/10956160 + (3323*chifm2*pms->eta*pms->kappa2*nom*pms->sigx2)/206720 - (177559*chifm4*pms->eta*pms->kappa2*nom*pms->sigx2)/5478080 - (3323*chifm2*pms->dm*pms->sigx*pms->sx)/456 + (1955*chifm4*pms->dm*pms->sigx*pms->sx)/456 + (3323*chifm2*pms->kappa1*pms->sigx*pms->sx)/912 - (1955*chifm4*pms->kappa1*pms->sigx*pms->sx)/912 - (3323*chifm2*pms->dm*pms->kappa1*pms->sigx*pms->sx)/912 + (1955*chifm4*pms->dm*pms->kappa1*pms->sigx*pms->sx)/912 - (3323*chifm2*pms->kappa2*pms->sigx*pms->sx)/912 + (1955*chifm4*pms->kappa2*pms->sigx*pms->sx)/912 - (3323*chifm2*pms->dm*pms->kappa2*pms->sigx*pms->sx)/912 + (1955*chifm4*pms->dm*pms->kappa2*pms->sigx*pms->sx)/912 - (3323*chifm2*pms->dm*nom*pms->sigx*pms->sx)/103360 + (177559*chifm4*pms->dm*nom*pms->sigx*pms->sx)/2739040 + (3323*chifm2*pms->kappa1*nom*pms->sigx*pms->sx)/206720 - (177559*chifm4*pms->kappa1*nom*pms->sigx*pms->sx)/5478080 - (3323*chifm2*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/206720 + (177559*chifm4*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/5478080 - (3323*chifm2*pms->kappa2*nom*pms->sigx*pms->sx)/206720 + (177559*chifm4*pms->kappa2*nom*pms->sigx*pms->sx)/5478080 - (3323*chifm2*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/206720 + (177559*chifm4*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/5478080 - (3323*chifm2*pms->sx2)/456 + (1955*chifm4*pms->sx2)/456 - (3323*chifm2*pms->kappa1*pms->sx2)/912 + (1955*chifm4*pms->kappa1*pms->sx2)/912 - (3323*chifm2*pms->kappa2*pms->sx2)/912 + (1955*chifm4*pms->kappa2*pms->sx2)/912 - (3323*chifm2*nom*pms->sx2)/103360 + (177559*chifm4*nom*pms->sx2)/2739040 - (3323*chifm2*pms->kappa1*nom*pms->sx2)/206720 + (177559*chifm4*pms->kappa1*nom*pms->sx2)/5478080 - (3323*chifm2*pms->kappa2*nom*pms->sx2)/206720 + (177559*chifm4*pms->kappa2*nom*pms->sx2)/5478080;
	REAL8 PartPN4e02=(-235*chifm2)/12 + (41*chifm2*pms->eta)/6 - (730907*chifm2*nom)/59976 + (196757*chifm2*pms->eta*nom)/57120 + (55*chifm2*nom2)/136 + 2*chifm2*pms->eta*pms->sigx2 - (chifm2*pms->kappa1*pms->sigx2)/2 + (chifm2*pms->dm*pms->kappa1*pms->sigx2)/2 + chifm2*pms->eta*pms->kappa1*pms->sigx2 - (chifm2*pms->kappa2*pms->sigx2)/2 - (chifm2*pms->dm*pms->kappa2*pms->sigx2)/2 + chifm2*pms->eta*pms->kappa2*pms->sigx2 + (3*chifm2*pms->eta*nom*pms->sigx2)/340 - (3*chifm2*pms->kappa1*nom*pms->sigx2)/1360 + (3*chifm2*pms->dm*pms->kappa1*nom*pms->sigx2)/1360 + (3*chifm2*pms->eta*pms->kappa1*nom*pms->sigx2)/680 - (3*chifm2*pms->kappa2*nom*pms->sigx2)/1360 - (3*chifm2*pms->dm*pms->kappa2*nom*pms->sigx2)/1360 + (3*chifm2*pms->eta*pms->kappa2*nom*pms->sigx2)/680 - 2*chifm2*pms->dm*pms->sigx*pms->sx + chifm2*pms->kappa1*pms->sigx*pms->sx - chifm2*pms->dm*pms->kappa1*pms->sigx*pms->sx - chifm2*pms->kappa2*pms->sigx*pms->sx - chifm2*pms->dm*pms->kappa2*pms->sigx*pms->sx - (3*chifm2*pms->dm*nom*pms->sigx*pms->sx)/340 + (3*chifm2*pms->kappa1*nom*pms->sigx*pms->sx)/680 - (3*chifm2*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/680 - (3*chifm2*pms->kappa2*nom*pms->sigx*pms->sx)/680 - (3*chifm2*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/680 - 2*chifm2*pms->sx2 - chifm2*pms->kappa1*pms->sx2 - chifm2*pms->kappa2*pms->sx2 - (3*chifm2*nom*pms->sx2)/340 - (3*chifm2*pms->kappa1*nom*pms->sx2)/680 - (3*chifm2*pms->kappa2*nom*pms->sx2)/680;
	REAL8 PartPN4e00=-9./2 + (7*pms->eta)/3 - (643*nom)/1260 + (6*pms->eta*nom)/5 + (36*nom2)/25 + pms->eta*pms->sigx2 - (pms->kappa1*pms->sigx2)/4 + (pms->dm*pms->kappa1*pms->sigx2)/4 + (pms->eta*pms->kappa1*pms->sigx2)/2 - (pms->kappa2*pms->sigx2)/4 - (pms->dm*pms->kappa2*pms->sigx2)/4 + (pms->eta*pms->kappa2*pms->sigx2)/2 + (pms->eta*nom*pms->sigx2)/5 - (pms->kappa1*nom*pms->sigx2)/20 + (pms->dm*pms->kappa1*nom*pms->sigx2)/20 + (pms->eta*pms->kappa1*nom*pms->sigx2)/10 - (pms->kappa2*nom*pms->sigx2)/20 - (pms->dm*pms->kappa2*nom*pms->sigx2)/20 + (pms->eta*pms->kappa2*nom*pms->sigx2)/10 - pms->dm*pms->sigx*pms->sx + (pms->kappa1*pms->sigx*pms->sx)/2 - (pms->dm*pms->kappa1*pms->sigx*pms->sx)/2 - (pms->kappa2*pms->sigx*pms->sx)/2 - (pms->dm*pms->kappa2*pms->sigx*pms->sx)/2 - (pms->dm*nom*pms->sigx*pms->sx)/5 + (pms->kappa1*nom*pms->sigx*pms->sx)/10 - (pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/10 - (pms->kappa2*nom*pms->sigx*pms->sx)/10 - (pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/10 - pms->sx2 - (pms->kappa1*pms->sx2)/2 - (pms->kappa2*pms->sx2)/2 - (nom*pms->sx2)/5 - (pms->kappa1*nom*pms->sx2)/10 - (pms->kappa2*nom*pms->sx2)/10;
	REAL8 PartPN3e010=(23922845804215*chifm2*pms->dm*pms->sigx)/2075394244608 - (6857994797935*chifm4*pms->dm*pms->sigx)/64856070144 + (2954397067293*chifm6*pms->dm*pms->sigx)/8540717056 - (453903041083475*chifm8*pms->dm*pms->sigx)/1037697122304 + (48411662696233*chifm10*pms->dm*pms->sigx)/259424280576 + (665055113357177*chifm2*pms->dm*nom*pms->sigx)/282253617266688 - (4784416768628561*chifm4*pms->dm*nom*pms->sigx)/233741276798976 + (79653929580924657*chifm6*pms->dm*nom*pms->sigx)/1231229770792960 - (7784879826094042463*chifm8*pms->dm*nom*pms->sigx)/97236371148374016 + (3258221698489171283*chifm10*pms->dm*nom*pms->sigx)/96796387568517120 + (23922845804215*chifm2*pms->sx)/691798081536 - (6857994797935*chifm4*pms->sx)/21618690048 + (8863191201879*chifm6*pms->sx)/8540717056 - (453903041083475*chifm8*pms->sx)/345899040768 + (48411662696233*chifm10*pms->sx)/86474760192 + (665055113357177*chifm2*nom*pms->sx)/94084539088896 - (4784416768628561*chifm4*nom*pms->sx)/77913758932992 + (238961788742773971*chifm6*nom*pms->sx)/1231229770792960 - (7784879826094042463*chifm8*nom*pms->sx)/32412123716124672 + (3258221698489171283*chifm10*nom*pms->sx)/32265462522839040;
	REAL8 PartPN3e08=(8286900895*chifm2*pms->dm*pms->sigx)/1137825792 - (53615809447*chifm4*pms->dm*pms->sigx)/1517101056 + (1654491793*chifm6*pms->dm*pms->sigx)/28094464 - (136594354825*chifm8*pms->dm*pms->sigx)/4551303168 + (230375844881*chifm2*pms->dm*nom*pms->sigx)/154744307712 - (187022872822141*chifm4*pms->dm*nom*pms->sigx)/27338161029120 + (44606994175157*chifm6*pms->dm*nom*pms->sigx)/4050097930240 - (2342726399667181*chifm8*pms->dm*nom*pms->sigx)/426475312054272 + (8286900895*chifm2*pms->sx)/379275264 - (53615809447*chifm4*pms->sx)/505700352 + (4963475379*chifm6*pms->sx)/28094464 - (136594354825*chifm8*pms->sx)/1517101056 + (230375844881*chifm2*nom*pms->sx)/51581435904 - (187022872822141*chifm4*nom*pms->sx)/9112720343040 + (133820982525471*chifm6*nom*pms->sx)/4050097930240 - (2342726399667181*chifm8*nom*pms->sx)/142158437351424;
	REAL8 PartPN3e06=(1689785*chifm2*pms->dm*pms->sigx)/415872 - (7254109*chifm4*pms->dm*pms->sigx)/831744 + (497891*chifm6*pms->dm*pms->sigx)/92416 + (46976023*chifm2*pms->dm*nom*pms->sigx)/56558592 - (25303810927*chifm4*pms->dm*nom*pms->sigx)/14988026880 + (13423711759*chifm6*pms->dm*nom*pms->sigx)/13322690560 + (1689785*chifm2*pms->sx)/138624 - (7254109*chifm4*pms->sx)/277248 + (1493673*chifm6*pms->sx)/92416 + (46976023*chifm2*nom*pms->sx)/18852864 - (25303810927*chifm4*nom*pms->sx)/4996008960 + (40271135277*chifm6*nom*pms->sx)/13322690560;
	REAL8 PartPN3e04=(3323*chifm2*pms->dm*pms->sigx)/1824 - (2183*chifm4*pms->dm*pms->sigx)/1824 + (461897*chifm2*pms->dm*nom*pms->sigx)/1240320 - (7614749*chifm4*pms->dm*nom*pms->sigx)/32868480 + (3323*chifm2*pms->sx)/608 - (2183*chifm4*pms->sx)/608 + (461897*chifm2*nom*pms->sx)/413440 - (7614749*chifm4*nom*pms->sx)/10956160;
	REAL8 PartPN3e02=(chifm2*pms->dm*pms->sigx)/2 + (139*chifm2*pms->dm*nom*pms->sigx)/1360 + (3*chifm2*pms->sx)/2 + (417*chifm2*nom*pms->sx)/1360;
	REAL8 PartPN3e00=(pms->dm*pms->sigx)/3 + (2*pms->dm*nom*pms->sigx)/15 + pms->sx + (2*nom*pms->sx)/5;
	REAL8 PartPN2e012=(-31858128517448053*chifm2)/946379775541248 + (273074849099381935*chifm4)/473189887770624 - (4250441456484795*chifm6)/1298188992512 + (7237919439832013023*chifm8)/946379775541248 - (1835883883067765255*chifm10)/236594943885312 + (11065637715060109*chifm12)/3894566977536 - (1752197068459642915*chifm2*nom)/128707649473609728 + (370145992336949827165.*chifm4*nom)/1705376355525328896 - (44516026487107853535.*chifm6*nom)/37429385032105984 + (14198380027130095238779.*chifm8*nom)/5216445322783358976 - (5315393289404737339188697.*chifm10*nom)/1950950550720976257024. + (56854018678596531069283.*chifm12*nom)/57538322140604923904.;
	REAL8 PartPN2e010=(-23922845804215*chifm2)/1037697122304 + (7574267273395*chifm4)/32428035072 - (3328251651585*chifm6)/4270358528 + (515628012131687*chifm8)/518848561152 - (110495569248737*chifm10)/259424280576 - (1315756519231825*chifm2*nom)/141126808633344 + (10266726084011305*chifm4*nom)/116870638399488 - (34857682477116205*chifm6*nom)/123122977079296 + (1011489908079062051*chifm8*nom)/2859893269069824 - (1599576674512409671739.*chifm10*nom)/10696000826321141760.;
	REAL8 PartPN2e08=(-8286900895*chifm2)/568912896 + (59215628299*chifm4)/758550528 - (1863854085*chifm6)/14047232 + (155169428869*chifm8)/2275651584 - (455779549225*chifm2*nom)/77372153856 + (80265273681841*chifm4*nom)/2733816102912 - (58561948446115*chifm6*nom)/1215029379072 + (304390583231737*chifm8*nom)/12543391531008;
	REAL8 PartPN2e06=(-1689785*chifm2)/207936 + (8011753*chifm4)/415872 - (560895*chifm6)/46208 - (92938175*chifm2*nom)/28279296 + (10859726827*chifm4*nom)/1498802688 - (17623216505*chifm6*nom)/3996807168;
	REAL8 PartPN2e04=(-3323*chifm2)/912 + (2411*chifm4)/912 - (182765*chifm2*nom)/124032 + (3268049*chifm4*nom)/3286848;
	REAL8 PartPN2e02=-chifm2 - (55*chifm2*nom)/136;
	REAL8 PartPN2e00=-1 - (3*nom)/5;
	REAL8 PartPN0e00=1;
	return vfm*(PartPN0e00 + (PartPN2e00 + e010*PartPN2e010 + e012*PartPN2e012 + e02*PartPN2e02 + e04*PartPN2e04 + e06*PartPN2e06 + e08*PartPN2e08)*vfm2 + (PartPN3e00 + e010*PartPN3e010 + e02*PartPN3e02 + e04*PartPN3e04 + e06*PartPN3e06 + e08*PartPN3e08)*vfm3 + (PartPN4e00 + e02*PartPN4e02 + e04*PartPN4e04 + e06*PartPN4e06 + e08*PartPN4e08)*vfm4);
}

REAL8 Calculate_vomByl(INT n, INT m, REAL8 freq, REAL8 lval, BBHCore *core)
{
    BBHDynParams *pms = core->pms;
    BBHDynVariables *var = core->var;

    REAL8 nom = (REAL8)n / m;
    REAL8 nom2 = nom*nom;
    REAL8 vfm = pow(CST_2PI*freq / m, 1./3.);
    REAL8 vfm2 = vfm*vfm;
    REAL8 vfm3 = vfm2*vfm;
    REAL8 vfm4 = vfm2*vfm2;
    REAL8 chifm = pow(pms->vomini / vfm, 19./6.);
    REAL8 chifm2 = chifm*chifm;
    REAL8 chifm4 = chifm2*chifm2;
    REAL8 chifm6 = chifm4*chifm4;
    REAL8 chifm8 = chifm6*chifm2;
    REAL8 chifm10 = chifm8*chifm2;
    REAL8 chifm12 = chifm10*chifm2;

    REAL8 v5l = var->vom5*lval;
    REAL8 v5l2 = v5l*v5l;

    REAL8 e02 = pms->eini*pms->eini;
    REAL8 e04 = e02*e02;
    REAL8 e06 = e04*e02;
    REAL8 e08 = e06*e02;
    REAL8 e010 = e08*e02;
    REAL8 e012 = e010*e02;
    REAL8 e014 = e012*e02;

	REAL8 PartPN4e08=(-1947421710325*chifm2)/6826954752 + (14361791552141*chifm4)/9102606336 - (543514708319*chifm6)/168566784 + (53557878661915*chifm8)/27307819008 + (339762936695*chifm2*pms->eta)/3413477376 - (1823060324243*chifm4*pms->eta)/4551303168 + (18165953759*chifm6*pms->eta)/28094464 - (4440894807677*chifm8*pms->eta)/13653909504 - (2378340556865*chifm2*nom)/6826954752 + (20507838348301*chifm4*nom)/9102606336 - (840931462651*chifm6*nom)/168566784 + (87044309536595*chifm8*nom)/27307819008 + (339762936695*chifm2*pms->eta*nom)/3413477376 - (1823060324243*chifm4*pms->eta*nom)/4551303168 + (18165953759*chifm6*pms->eta*nom)/28094464 - (4440894807677*chifm8*pms->eta*nom)/13653909504 + (41434504475*chifm2*nom2)/1706738688 + (336111934165*chifm4*nom2)/1137825792 - (48111533789*chifm6*nom2)/42141696 + (1554727147753*chifm8*nom2)/1706738688 + (8286900895*chifm2*pms->eta*pms->sigx2)/284456448 - (48015990595*chifm4*pms->eta*pms->sigx2)/379275264 + (4373775799*chifm6*pms->eta*pms->sigx2)/21070848 - (119594395981*chifm8*pms->eta*pms->sigx2)/1137825792 - (8286900895*chifm2*pms->kappa1*pms->sigx2)/1137825792 + (48015990595*chifm4*pms->kappa1*pms->sigx2)/1517101056 - (4373775799*chifm6*pms->kappa1*pms->sigx2)/84283392 + (119594395981*chifm8*pms->kappa1*pms->sigx2)/4551303168 + (8286900895*chifm2*pms->dm*pms->kappa1*pms->sigx2)/1137825792 - (48015990595*chifm4*pms->dm*pms->kappa1*pms->sigx2)/1517101056 + (4373775799*chifm6*pms->dm*pms->kappa1*pms->sigx2)/84283392 - (119594395981*chifm8*pms->dm*pms->kappa1*pms->sigx2)/4551303168 + (8286900895*chifm2*pms->eta*pms->kappa1*pms->sigx2)/568912896 - (48015990595*chifm4*pms->eta*pms->kappa1*pms->sigx2)/758550528 + (4373775799*chifm6*pms->eta*pms->kappa1*pms->sigx2)/42141696 - (119594395981*chifm8*pms->eta*pms->kappa1*pms->sigx2)/2275651584 - (8286900895*chifm2*pms->kappa2*pms->sigx2)/1137825792 + (48015990595*chifm4*pms->kappa2*pms->sigx2)/1517101056 - (4373775799*chifm6*pms->kappa2*pms->sigx2)/84283392 + (119594395981*chifm8*pms->kappa2*pms->sigx2)/4551303168 - (8286900895*chifm2*pms->dm*pms->kappa2*pms->sigx2)/1137825792 + (48015990595*chifm4*pms->dm*pms->kappa2*pms->sigx2)/1517101056 - (4373775799*chifm6*pms->dm*pms->kappa2*pms->sigx2)/84283392 + (119594395981*chifm8*pms->dm*pms->kappa2*pms->sigx2)/4551303168 + (8286900895*chifm2*pms->eta*pms->kappa2*pms->sigx2)/568912896 - (48015990595*chifm4*pms->eta*pms->kappa2*pms->sigx2)/758550528 + (4373775799*chifm6*pms->eta*pms->kappa2*pms->sigx2)/42141696 - (119594395981*chifm8*pms->eta*pms->kappa2*pms->sigx2)/2275651584 + (8286900895*chifm2*pms->eta*nom*pms->sigx2)/284456448 - (48015990595*chifm4*pms->eta*nom*pms->sigx2)/379275264 + (4373775799*chifm6*pms->eta*nom*pms->sigx2)/21070848 - (119594395981*chifm8*pms->eta*nom*pms->sigx2)/1137825792 - (8286900895*chifm2*pms->kappa1*nom*pms->sigx2)/1137825792 + (48015990595*chifm4*pms->kappa1*nom*pms->sigx2)/1517101056 - (4373775799*chifm6*pms->kappa1*nom*pms->sigx2)/84283392 + (119594395981*chifm8*pms->kappa1*nom*pms->sigx2)/4551303168 + (8286900895*chifm2*pms->dm*pms->kappa1*nom*pms->sigx2)/1137825792 - (48015990595*chifm4*pms->dm*pms->kappa1*nom*pms->sigx2)/1517101056 + (4373775799*chifm6*pms->dm*pms->kappa1*nom*pms->sigx2)/84283392 - (119594395981*chifm8*pms->dm*pms->kappa1*nom*pms->sigx2)/4551303168 + (8286900895*chifm2*pms->eta*pms->kappa1*nom*pms->sigx2)/568912896 - (48015990595*chifm4*pms->eta*pms->kappa1*nom*pms->sigx2)/758550528 + (4373775799*chifm6*pms->eta*pms->kappa1*nom*pms->sigx2)/42141696 - (119594395981*chifm8*pms->eta*pms->kappa1*nom*pms->sigx2)/2275651584 - (8286900895*chifm2*pms->kappa2*nom*pms->sigx2)/1137825792 + (48015990595*chifm4*pms->kappa2*nom*pms->sigx2)/1517101056 - (4373775799*chifm6*pms->kappa2*nom*pms->sigx2)/84283392 + (119594395981*chifm8*pms->kappa2*nom*pms->sigx2)/4551303168 - (8286900895*chifm2*pms->dm*pms->kappa2*nom*pms->sigx2)/1137825792 + (48015990595*chifm4*pms->dm*pms->kappa2*nom*pms->sigx2)/1517101056 - (4373775799*chifm6*pms->dm*pms->kappa2*nom*pms->sigx2)/84283392 + (119594395981*chifm8*pms->dm*pms->kappa2*nom*pms->sigx2)/4551303168 + (8286900895*chifm2*pms->eta*pms->kappa2*nom*pms->sigx2)/568912896 - (48015990595*chifm4*pms->eta*pms->kappa2*nom*pms->sigx2)/758550528 + (4373775799*chifm6*pms->eta*pms->kappa2*nom*pms->sigx2)/42141696 - (119594395981*chifm8*pms->eta*pms->kappa2*nom*pms->sigx2)/2275651584 - (8286900895*chifm2*pms->dm*pms->sigx*pms->sx)/284456448 + (48015990595*chifm4*pms->dm*pms->sigx*pms->sx)/379275264 - (4373775799*chifm6*pms->dm*pms->sigx*pms->sx)/21070848 + (119594395981*chifm8*pms->dm*pms->sigx*pms->sx)/1137825792 + (8286900895*chifm2*pms->kappa1*pms->sigx*pms->sx)/568912896 - (48015990595*chifm4*pms->kappa1*pms->sigx*pms->sx)/758550528 + (4373775799*chifm6*pms->kappa1*pms->sigx*pms->sx)/42141696 - (119594395981*chifm8*pms->kappa1*pms->sigx*pms->sx)/2275651584 - (8286900895*chifm2*pms->dm*pms->kappa1*pms->sigx*pms->sx)/568912896 + (48015990595*chifm4*pms->dm*pms->kappa1*pms->sigx*pms->sx)/758550528 - (4373775799*chifm6*pms->dm*pms->kappa1*pms->sigx*pms->sx)/42141696 + (119594395981*chifm8*pms->dm*pms->kappa1*pms->sigx*pms->sx)/2275651584 - (8286900895*chifm2*pms->kappa2*pms->sigx*pms->sx)/568912896 + (48015990595*chifm4*pms->kappa2*pms->sigx*pms->sx)/758550528 - (4373775799*chifm6*pms->kappa2*pms->sigx*pms->sx)/42141696 + (119594395981*chifm8*pms->kappa2*pms->sigx*pms->sx)/2275651584 - (8286900895*chifm2*pms->dm*pms->kappa2*pms->sigx*pms->sx)/568912896 + (48015990595*chifm4*pms->dm*pms->kappa2*pms->sigx*pms->sx)/758550528 - (4373775799*chifm6*pms->dm*pms->kappa2*pms->sigx*pms->sx)/42141696 + (119594395981*chifm8*pms->dm*pms->kappa2*pms->sigx*pms->sx)/2275651584 - (8286900895*chifm2*pms->dm*nom*pms->sigx*pms->sx)/284456448 + (48015990595*chifm4*pms->dm*nom*pms->sigx*pms->sx)/379275264 - (4373775799*chifm6*pms->dm*nom*pms->sigx*pms->sx)/21070848 + (119594395981*chifm8*pms->dm*nom*pms->sigx*pms->sx)/1137825792 + (8286900895*chifm2*pms->kappa1*nom*pms->sigx*pms->sx)/568912896 - (48015990595*chifm4*pms->kappa1*nom*pms->sigx*pms->sx)/758550528 + (4373775799*chifm6*pms->kappa1*nom*pms->sigx*pms->sx)/42141696 - (119594395981*chifm8*pms->kappa1*nom*pms->sigx*pms->sx)/2275651584 - (8286900895*chifm2*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/568912896 + (48015990595*chifm4*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/758550528 - (4373775799*chifm6*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/42141696 + (119594395981*chifm8*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/2275651584 - (8286900895*chifm2*pms->kappa2*nom*pms->sigx*pms->sx)/568912896 + (48015990595*chifm4*pms->kappa2*nom*pms->sigx*pms->sx)/758550528 - (4373775799*chifm6*pms->kappa2*nom*pms->sigx*pms->sx)/42141696 + (119594395981*chifm8*pms->kappa2*nom*pms->sigx*pms->sx)/2275651584 - (8286900895*chifm2*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/568912896 + (48015990595*chifm4*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/758550528 - (4373775799*chifm6*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/42141696 + (119594395981*chifm8*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/2275651584 - (8286900895*chifm2*pms->sx2)/284456448 + (48015990595*chifm4*pms->sx2)/379275264 - (4373775799*chifm6*pms->sx2)/21070848 + (119594395981*chifm8*pms->sx2)/1137825792 - (8286900895*chifm2*pms->kappa1*pms->sx2)/568912896 + (48015990595*chifm4*pms->kappa1*pms->sx2)/758550528 - (4373775799*chifm6*pms->kappa1*pms->sx2)/42141696 + (119594395981*chifm8*pms->kappa1*pms->sx2)/2275651584 - (8286900895*chifm2*pms->kappa2*pms->sx2)/568912896 + (48015990595*chifm4*pms->kappa2*pms->sx2)/758550528 - (4373775799*chifm6*pms->kappa2*pms->sx2)/42141696 + (119594395981*chifm8*pms->kappa2*pms->sx2)/2275651584 - (8286900895*chifm2*nom*pms->sx2)/284456448 + (48015990595*chifm4*nom*pms->sx2)/379275264 - (4373775799*chifm6*nom*pms->sx2)/21070848 + (119594395981*chifm8*nom*pms->sx2)/1137825792 - (8286900895*chifm2*pms->kappa1*nom*pms->sx2)/568912896 + (48015990595*chifm4*pms->kappa1*nom*pms->sx2)/758550528 - (4373775799*chifm6*pms->kappa1*nom*pms->sx2)/42141696 + (119594395981*chifm8*pms->kappa1*nom*pms->sx2)/2275651584 - (8286900895*chifm2*pms->kappa2*nom*pms->sx2)/568912896 + (48015990595*chifm4*pms->kappa2*nom*pms->sx2)/758550528 - (4373775799*chifm6*pms->kappa2*nom*pms->sx2)/42141696 + (119594395981*chifm8*pms->kappa2*nom*pms->sx2)/2275651584 - (23914812139985*chifm2*pms->eta*nom*v5l)/853369344 + (1236844540312439*chifm4*pms->eta*nom*v5l)/39823902720 - (12816084176825*chifm6*pms->eta*nom*v5l)/147495936 + (6560257809486097*chifm8*pms->eta*nom*v5l)/119471708160 + (1410430532329*chifm2*pms->eta2*nom*v5l)/142228224 - (2710042157669*chifm4*pms->eta2*nom*v5l)/948188160 + (133776639493*chifm6*pms->eta2*nom*v5l)/10535424 - (20893433706059*chifm8*pms->eta2*nom*v5l)/2844564480 + (356336738485*chifm2*pms->eta*nom2*v5l)/213342336 + (4104347930599*chifm4*pms->eta*nom2*v5l)/711141120 - (144354924835*chifm6*pms->eta*nom2*v5l)/5267712 + (24274223555491*chifm8*pms->eta*nom2*v5l)/1066711680 + (71267347697*chifm2*pms->eta2*nom*pms->sigx2*v5l)/35557056 - (586335418657*chifm4*pms->eta2*nom*pms->sigx2*v5l)/237047040 + (13123174985*chifm6*pms->eta2*nom*pms->sigx2*v5l)/2633856 - (1867247965807*chifm8*pms->eta2*nom*pms->sigx2*v5l)/711141120 - (71267347697*chifm2*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/142228224 + (586335418657*chifm4*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/948188160 - (13123174985*chifm6*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/10535424 + (1867247965807*chifm8*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/2844564480 + (71267347697*chifm2*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/142228224 - (586335418657*chifm4*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/948188160 + (13123174985*chifm6*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/10535424 - (1867247965807*chifm8*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/2844564480 + (71267347697*chifm2*pms->eta2*pms->kappa1*nom*pms->sigx2*v5l)/71114112 - (586335418657*chifm4*pms->eta2*pms->kappa1*nom*pms->sigx2*v5l)/474094080 + (13123174985*chifm6*pms->eta2*pms->kappa1*nom*pms->sigx2*v5l)/5267712 - (1867247965807*chifm8*pms->eta2*pms->kappa1*nom*pms->sigx2*v5l)/1422282240 - (71267347697*chifm2*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/142228224 + (586335418657*chifm4*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/948188160 - (13123174985*chifm6*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/10535424 + (1867247965807*chifm8*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/2844564480 - (71267347697*chifm2*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/142228224 + (586335418657*chifm4*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/948188160 - (13123174985*chifm6*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/10535424 + (1867247965807*chifm8*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/2844564480 + (71267347697*chifm2*pms->eta2*pms->kappa2*nom*pms->sigx2*v5l)/71114112 - (586335418657*chifm4*pms->eta2*pms->kappa2*nom*pms->sigx2*v5l)/474094080 + (13123174985*chifm6*pms->eta2*pms->kappa2*nom*pms->sigx2*v5l)/5267712 - (1867247965807*chifm8*pms->eta2*pms->kappa2*nom*pms->sigx2*v5l)/1422282240 - (71267347697*chifm2*pms->dm*pms->eta*nom*pms->sigx*pms->sx*v5l)/35557056 + (586335418657*chifm4*pms->dm*pms->eta*nom*pms->sigx*pms->sx*v5l)/237047040 - (13123174985*chifm6*pms->dm*pms->eta*nom*pms->sigx*pms->sx*v5l)/2633856 + (1867247965807*chifm8*pms->dm*pms->eta*nom*pms->sigx*pms->sx*v5l)/711141120 + (71267347697*chifm2*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/71114112 - (586335418657*chifm4*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/474094080 + (13123174985*chifm6*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/5267712 - (1867247965807*chifm8*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/1422282240 - (71267347697*chifm2*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/71114112 + (586335418657*chifm4*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/474094080 - (13123174985*chifm6*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/5267712 + (1867247965807*chifm8*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/1422282240 - (71267347697*chifm2*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/71114112 + (586335418657*chifm4*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/474094080 - (13123174985*chifm6*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/5267712 + (1867247965807*chifm8*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/1422282240 - (71267347697*chifm2*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/71114112 + (586335418657*chifm4*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/474094080 - (13123174985*chifm6*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/5267712 + (1867247965807*chifm8*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/1422282240 - (71267347697*chifm2*pms->eta*nom*pms->sx2*v5l)/35557056 + (586335418657*chifm4*pms->eta*nom*pms->sx2*v5l)/237047040 - (13123174985*chifm6*pms->eta*nom*pms->sx2*v5l)/2633856 + (1867247965807*chifm8*pms->eta*nom*pms->sx2*v5l)/711141120 - (71267347697*chifm2*pms->eta*pms->kappa1*nom*pms->sx2*v5l)/71114112 + (586335418657*chifm4*pms->eta*pms->kappa1*nom*pms->sx2*v5l)/474094080 - (13123174985*chifm6*pms->eta*pms->kappa1*nom*pms->sx2*v5l)/5267712 + (1867247965807*chifm8*pms->eta*pms->kappa1*nom*pms->sx2*v5l)/1422282240 - (71267347697*chifm2*pms->eta*pms->kappa2*nom*pms->sx2*v5l)/71114112 + (586335418657*chifm4*pms->eta*pms->kappa2*nom*pms->sx2*v5l)/474094080 - (13123174985*chifm6*pms->eta*pms->kappa2*nom*pms->sx2*v5l)/5267712 + (1867247965807*chifm8*pms->eta*pms->kappa2*nom*pms->sx2*v5l)/1422282240 + (58008306265*chifm2*pms->eta2*nom2*v5l2)/3333474 - (286425822158*chifm4*pms->eta2*nom2*v5l2)/2777895 - (280690487*chifm6*pms->eta2*nom2*v5l2)/41154 + (311185903028*chifm8*pms->eta2*nom2*v5l2)/8333685;
	REAL8 PartPN4e06=(-397099475*chifm2)/2495232 + (1943120927*chifm4)/4990464 - (163561453*chifm6)/554496 + (69281185*chifm2*pms->eta)/1247616 - (246656321*chifm4*pms->eta)/2495232 + (5466733*chifm6*pms->eta)/92416 - (484968295*chifm2*nom)/2495232 + (2774668447*chifm4*nom)/4990464 - (253063937*chifm6*nom)/554496 + (69281185*chifm2*pms->eta*nom)/1247616 - (246656321*chifm4*pms->eta*nom)/2495232 + (5466733*chifm6*pms->eta*nom)/92416 + (8448925*chifm2*nom2)/623808 + (45475255*chifm4*nom2)/623808 - (14478343*chifm6*nom2)/138624 + (1689785*chifm2*pms->eta*pms->sigx2)/103968 - (6496465*chifm4*pms->eta*pms->sigx2)/207936 + (1316213*chifm6*pms->eta*pms->sigx2)/69312 - (1689785*chifm2*pms->kappa1*pms->sigx2)/415872 + (6496465*chifm4*pms->kappa1*pms->sigx2)/831744 - (1316213*chifm6*pms->kappa1*pms->sigx2)/277248 + (1689785*chifm2*pms->dm*pms->kappa1*pms->sigx2)/415872 - (6496465*chifm4*pms->dm*pms->kappa1*pms->sigx2)/831744 + (1316213*chifm6*pms->dm*pms->kappa1*pms->sigx2)/277248 + (1689785*chifm2*pms->eta*pms->kappa1*pms->sigx2)/207936 - (6496465*chifm4*pms->eta*pms->kappa1*pms->sigx2)/415872 + (1316213*chifm6*pms->eta*pms->kappa1*pms->sigx2)/138624 - (1689785*chifm2*pms->kappa2*pms->sigx2)/415872 + (6496465*chifm4*pms->kappa2*pms->sigx2)/831744 - (1316213*chifm6*pms->kappa2*pms->sigx2)/277248 - (1689785*chifm2*pms->dm*pms->kappa2*pms->sigx2)/415872 + (6496465*chifm4*pms->dm*pms->kappa2*pms->sigx2)/831744 - (1316213*chifm6*pms->dm*pms->kappa2*pms->sigx2)/277248 + (1689785*chifm2*pms->eta*pms->kappa2*pms->sigx2)/207936 - (6496465*chifm4*pms->eta*pms->kappa2*pms->sigx2)/415872 + (1316213*chifm6*pms->eta*pms->kappa2*pms->sigx2)/138624 + (1689785*chifm2*pms->eta*nom*pms->sigx2)/103968 - (6496465*chifm4*pms->eta*nom*pms->sigx2)/207936 + (1316213*chifm6*pms->eta*nom*pms->sigx2)/69312 - (1689785*chifm2*pms->kappa1*nom*pms->sigx2)/415872 + (6496465*chifm4*pms->kappa1*nom*pms->sigx2)/831744 - (1316213*chifm6*pms->kappa1*nom*pms->sigx2)/277248 + (1689785*chifm2*pms->dm*pms->kappa1*nom*pms->sigx2)/415872 - (6496465*chifm4*pms->dm*pms->kappa1*nom*pms->sigx2)/831744 + (1316213*chifm6*pms->dm*pms->kappa1*nom*pms->sigx2)/277248 + (1689785*chifm2*pms->eta*pms->kappa1*nom*pms->sigx2)/207936 - (6496465*chifm4*pms->eta*pms->kappa1*nom*pms->sigx2)/415872 + (1316213*chifm6*pms->eta*pms->kappa1*nom*pms->sigx2)/138624 - (1689785*chifm2*pms->kappa2*nom*pms->sigx2)/415872 + (6496465*chifm4*pms->kappa2*nom*pms->sigx2)/831744 - (1316213*chifm6*pms->kappa2*nom*pms->sigx2)/277248 - (1689785*chifm2*pms->dm*pms->kappa2*nom*pms->sigx2)/415872 + (6496465*chifm4*pms->dm*pms->kappa2*nom*pms->sigx2)/831744 - (1316213*chifm6*pms->dm*pms->kappa2*nom*pms->sigx2)/277248 + (1689785*chifm2*pms->eta*pms->kappa2*nom*pms->sigx2)/207936 - (6496465*chifm4*pms->eta*pms->kappa2*nom*pms->sigx2)/415872 + (1316213*chifm6*pms->eta*pms->kappa2*nom*pms->sigx2)/138624 - (1689785*chifm2*pms->dm*pms->sigx*pms->sx)/103968 + (6496465*chifm4*pms->dm*pms->sigx*pms->sx)/207936 - (1316213*chifm6*pms->dm*pms->sigx*pms->sx)/69312 + (1689785*chifm2*pms->kappa1*pms->sigx*pms->sx)/207936 - (6496465*chifm4*pms->kappa1*pms->sigx*pms->sx)/415872 + (1316213*chifm6*pms->kappa1*pms->sigx*pms->sx)/138624 - (1689785*chifm2*pms->dm*pms->kappa1*pms->sigx*pms->sx)/207936 + (6496465*chifm4*pms->dm*pms->kappa1*pms->sigx*pms->sx)/415872 - (1316213*chifm6*pms->dm*pms->kappa1*pms->sigx*pms->sx)/138624 - (1689785*chifm2*pms->kappa2*pms->sigx*pms->sx)/207936 + (6496465*chifm4*pms->kappa2*pms->sigx*pms->sx)/415872 - (1316213*chifm6*pms->kappa2*pms->sigx*pms->sx)/138624 - (1689785*chifm2*pms->dm*pms->kappa2*pms->sigx*pms->sx)/207936 + (6496465*chifm4*pms->dm*pms->kappa2*pms->sigx*pms->sx)/415872 - (1316213*chifm6*pms->dm*pms->kappa2*pms->sigx*pms->sx)/138624 - (1689785*chifm2*pms->dm*nom*pms->sigx*pms->sx)/103968 + (6496465*chifm4*pms->dm*nom*pms->sigx*pms->sx)/207936 - (1316213*chifm6*pms->dm*nom*pms->sigx*pms->sx)/69312 + (1689785*chifm2*pms->kappa1*nom*pms->sigx*pms->sx)/207936 - (6496465*chifm4*pms->kappa1*nom*pms->sigx*pms->sx)/415872 + (1316213*chifm6*pms->kappa1*nom*pms->sigx*pms->sx)/138624 - (1689785*chifm2*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/207936 + (6496465*chifm4*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/415872 - (1316213*chifm6*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/138624 - (1689785*chifm2*pms->kappa2*nom*pms->sigx*pms->sx)/207936 + (6496465*chifm4*pms->kappa2*nom*pms->sigx*pms->sx)/415872 - (1316213*chifm6*pms->kappa2*nom*pms->sigx*pms->sx)/138624 - (1689785*chifm2*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/207936 + (6496465*chifm4*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/415872 - (1316213*chifm6*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/138624 - (1689785*chifm2*pms->sx2)/103968 + (6496465*chifm4*pms->sx2)/207936 - (1316213*chifm6*pms->sx2)/69312 - (1689785*chifm2*pms->kappa1*pms->sx2)/207936 + (6496465*chifm4*pms->kappa1*pms->sx2)/415872 - (1316213*chifm6*pms->kappa1*pms->sx2)/138624 - (1689785*chifm2*pms->kappa2*pms->sx2)/207936 + (6496465*chifm4*pms->kappa2*pms->sx2)/415872 - (1316213*chifm6*pms->kappa2*pms->sx2)/138624 - (1689785*chifm2*nom*pms->sx2)/103968 + (6496465*chifm4*nom*pms->sx2)/207936 - (1316213*chifm6*nom*pms->sx2)/69312 - (1689785*chifm2*pms->kappa1*nom*pms->sx2)/207936 + (6496465*chifm4*pms->kappa1*nom*pms->sx2)/415872 - (1316213*chifm6*pms->kappa1*nom*pms->sx2)/138624 - (1689785*chifm2*pms->kappa2*nom*pms->sx2)/207936 + (6496465*chifm4*pms->kappa2*nom*pms->sx2)/415872 - (1316213*chifm6*pms->kappa2*nom*pms->sx2)/138624 - (34135346785*chifm2*pms->eta*nom*v5l)/2183328 + (167342528333*chifm4*pms->eta*nom*v5l)/21833280 - (3856781275*chifm6*pms->eta*nom*v5l)/485184 + (287601407*chifm2*pms->eta2*nom*v5l)/51984 - (366663143*chifm4*pms->eta2*nom*v5l)/519840 + (40257791*chifm6*pms->eta2*nom*v5l)/34656 + (72660755*chifm2*pms->eta*nom2*v5l)/77976 + (555309853*chifm4*pms->eta*nom2*v5l)/389880 - (43441145*chifm6*pms->eta*nom2*v5l)/17328 + (14532151*chifm2*pms->eta2*nom*pms->sigx2*v5l)/12996 - (79329979*chifm4*pms->eta2*nom*pms->sigx2*v5l)/129960 + (3949195*chifm6*pms->eta2*nom*pms->sigx2*v5l)/8664 - (14532151*chifm2*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/51984 + (79329979*chifm4*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/519840 - (3949195*chifm6*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/34656 + (14532151*chifm2*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/51984 - (79329979*chifm4*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/519840 + (3949195*chifm6*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/34656 + (14532151*chifm2*pms->eta2*pms->kappa1*nom*pms->sigx2*v5l)/25992 - (79329979*chifm4*pms->eta2*pms->kappa1*nom*pms->sigx2*v5l)/259920 + (3949195*chifm6*pms->eta2*pms->kappa1*nom*pms->sigx2*v5l)/17328 - (14532151*chifm2*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/51984 + (79329979*chifm4*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/519840 - (3949195*chifm6*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/34656 - (14532151*chifm2*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/51984 + (79329979*chifm4*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/519840 - (3949195*chifm6*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/34656 + (14532151*chifm2*pms->eta2*pms->kappa2*nom*pms->sigx2*v5l)/25992 - (79329979*chifm4*pms->eta2*pms->kappa2*nom*pms->sigx2*v5l)/259920 + (3949195*chifm6*pms->eta2*pms->kappa2*nom*pms->sigx2*v5l)/17328 - (14532151*chifm2*pms->dm*pms->eta*nom*pms->sigx*pms->sx*v5l)/12996 + (79329979*chifm4*pms->dm*pms->eta*nom*pms->sigx*pms->sx*v5l)/129960 - (3949195*chifm6*pms->dm*pms->eta*nom*pms->sigx*pms->sx*v5l)/8664 + (14532151*chifm2*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/25992 - (79329979*chifm4*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/259920 + (3949195*chifm6*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/17328 - (14532151*chifm2*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/25992 + (79329979*chifm4*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/259920 - (3949195*chifm6*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/17328 - (14532151*chifm2*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/25992 + (79329979*chifm4*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/259920 - (3949195*chifm6*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/17328 - (14532151*chifm2*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/25992 + (79329979*chifm4*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/259920 - (3949195*chifm6*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/17328 - (14532151*chifm2*pms->eta*nom*pms->sx2*v5l)/12996 + (79329979*chifm4*pms->eta*nom*pms->sx2*v5l)/129960 - (3949195*chifm6*pms->eta*nom*pms->sx2*v5l)/8664 - (14532151*chifm2*pms->eta*pms->kappa1*nom*pms->sx2*v5l)/25992 + (79329979*chifm4*pms->eta*pms->kappa1*nom*pms->sx2*v5l)/259920 - (3949195*chifm6*pms->eta*pms->kappa1*nom*pms->sx2*v5l)/17328 - (14532151*chifm2*pms->eta*pms->kappa2*nom*pms->sx2*v5l)/25992 + (79329979*chifm4*pms->eta*pms->kappa2*nom*pms->sx2*v5l)/259920 - (3949195*chifm6*pms->eta*pms->kappa2*nom*pms->sx2*v5l)/17328 + (94627960*chifm2*pms->eta2*nom2*v5l2)/9747 - (1240090432*chifm4*pms->eta2*nom2*v5l2)/48735 - (675752*chifm6*pms->eta2*nom2*v5l2)/1083;
	REAL8 PartPN4e04=(-780905*chifm2)/10944 + (584749*chifm4)/10944 + (136243*chifm2*pms->eta)/5472 - (74227*chifm4*pms->eta)/5472 - (953701*chifm2*nom)/10944 + (834989*chifm4*nom)/10944 + (136243*chifm2*pms->eta*nom)/5472 - (74227*chifm4*pms->eta*nom)/5472 + (16615*chifm2*nom2)/2736 + (13685*chifm4*nom2)/1368 + (3323*chifm2*pms->eta*pms->sigx2)/456 - (1955*chifm4*pms->eta*pms->sigx2)/456 - (3323*chifm2*pms->kappa1*pms->sigx2)/1824 + (1955*chifm4*pms->kappa1*pms->sigx2)/1824 + (3323*chifm2*pms->dm*pms->kappa1*pms->sigx2)/1824 - (1955*chifm4*pms->dm*pms->kappa1*pms->sigx2)/1824 + (3323*chifm2*pms->eta*pms->kappa1*pms->sigx2)/912 - (1955*chifm4*pms->eta*pms->kappa1*pms->sigx2)/912 - (3323*chifm2*pms->kappa2*pms->sigx2)/1824 + (1955*chifm4*pms->kappa2*pms->sigx2)/1824 - (3323*chifm2*pms->dm*pms->kappa2*pms->sigx2)/1824 + (1955*chifm4*pms->dm*pms->kappa2*pms->sigx2)/1824 + (3323*chifm2*pms->eta*pms->kappa2*pms->sigx2)/912 - (1955*chifm4*pms->eta*pms->kappa2*pms->sigx2)/912 + (3323*chifm2*pms->eta*nom*pms->sigx2)/456 - (1955*chifm4*pms->eta*nom*pms->sigx2)/456 - (3323*chifm2*pms->kappa1*nom*pms->sigx2)/1824 + (1955*chifm4*pms->kappa1*nom*pms->sigx2)/1824 + (3323*chifm2*pms->dm*pms->kappa1*nom*pms->sigx2)/1824 - (1955*chifm4*pms->dm*pms->kappa1*nom*pms->sigx2)/1824 + (3323*chifm2*pms->eta*pms->kappa1*nom*pms->sigx2)/912 - (1955*chifm4*pms->eta*pms->kappa1*nom*pms->sigx2)/912 - (3323*chifm2*pms->kappa2*nom*pms->sigx2)/1824 + (1955*chifm4*pms->kappa2*nom*pms->sigx2)/1824 - (3323*chifm2*pms->dm*pms->kappa2*nom*pms->sigx2)/1824 + (1955*chifm4*pms->dm*pms->kappa2*nom*pms->sigx2)/1824 + (3323*chifm2*pms->eta*pms->kappa2*nom*pms->sigx2)/912 - (1955*chifm4*pms->eta*pms->kappa2*nom*pms->sigx2)/912 - (3323*chifm2*pms->dm*pms->sigx*pms->sx)/456 + (1955*chifm4*pms->dm*pms->sigx*pms->sx)/456 + (3323*chifm2*pms->kappa1*pms->sigx*pms->sx)/912 - (1955*chifm4*pms->kappa1*pms->sigx*pms->sx)/912 - (3323*chifm2*pms->dm*pms->kappa1*pms->sigx*pms->sx)/912 + (1955*chifm4*pms->dm*pms->kappa1*pms->sigx*pms->sx)/912 - (3323*chifm2*pms->kappa2*pms->sigx*pms->sx)/912 + (1955*chifm4*pms->kappa2*pms->sigx*pms->sx)/912 - (3323*chifm2*pms->dm*pms->kappa2*pms->sigx*pms->sx)/912 + (1955*chifm4*pms->dm*pms->kappa2*pms->sigx*pms->sx)/912 - (3323*chifm2*pms->dm*nom*pms->sigx*pms->sx)/456 + (1955*chifm4*pms->dm*nom*pms->sigx*pms->sx)/456 + (3323*chifm2*pms->kappa1*nom*pms->sigx*pms->sx)/912 - (1955*chifm4*pms->kappa1*nom*pms->sigx*pms->sx)/912 - (3323*chifm2*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/912 + (1955*chifm4*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/912 - (3323*chifm2*pms->kappa2*nom*pms->sigx*pms->sx)/912 + (1955*chifm4*pms->kappa2*nom*pms->sigx*pms->sx)/912 - (3323*chifm2*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/912 + (1955*chifm4*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/912 - (3323*chifm2*pms->sx2)/456 + (1955*chifm4*pms->sx2)/456 - (3323*chifm2*pms->kappa1*pms->sx2)/912 + (1955*chifm4*pms->kappa1*pms->sx2)/912 - (3323*chifm2*pms->kappa2*pms->sx2)/912 + (1955*chifm4*pms->kappa2*pms->sx2)/912 - (3323*chifm2*nom*pms->sx2)/456 + (1955*chifm4*nom*pms->sx2)/456 - (3323*chifm2*pms->kappa1*nom*pms->sx2)/912 + (1955*chifm4*pms->kappa1*nom*pms->sx2)/912 - (3323*chifm2*pms->kappa2*nom*pms->sx2)/912 + (1955*chifm4*pms->kappa2*nom*pms->sx2)/912 - (67127923*chifm2*pms->eta*nom*v5l)/9576 + (50358871*chifm4*pms->eta*nom*v5l)/47880 + (2827873*chifm2*pms->eta2*nom*v5l)/1140 - (110341*chifm4*pms->eta2*nom*v5l)/1140 + (142889*chifm2*pms->eta*nom2*v5l)/342 + (167111*chifm4*pms->eta*nom2*v5l)/855 + (142889*chifm2*pms->eta2*nom*pms->sigx2*v5l)/285 - (23873*chifm4*pms->eta2*nom*pms->sigx2*v5l)/285 - (142889*chifm2*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/1140 + (23873*chifm4*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/1140 + (142889*chifm2*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/1140 - (23873*chifm4*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/1140 + (142889*chifm2*pms->eta2*pms->kappa1*nom*pms->sigx2*v5l)/570 - (23873*chifm4*pms->eta2*pms->kappa1*nom*pms->sigx2*v5l)/570 - (142889*chifm2*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/1140 + (23873*chifm4*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/1140 - (142889*chifm2*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/1140 + (23873*chifm4*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/1140 + (142889*chifm2*pms->eta2*pms->kappa2*nom*pms->sigx2*v5l)/570 - (23873*chifm4*pms->eta2*pms->kappa2*nom*pms->sigx2*v5l)/570 - (142889*chifm2*pms->dm*pms->eta*nom*pms->sigx*pms->sx*v5l)/285 + (23873*chifm4*pms->dm*pms->eta*nom*pms->sigx*pms->sx*v5l)/285 + (142889*chifm2*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/570 - (23873*chifm4*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/570 - (142889*chifm2*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/570 + (23873*chifm4*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/570 - (142889*chifm2*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/570 + (23873*chifm4*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/570 - (142889*chifm2*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/570 + (23873*chifm4*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/570 - (142889*chifm2*pms->eta*nom*pms->sx2*v5l)/285 + (23873*chifm4*pms->eta*nom*pms->sx2*v5l)/285 - (142889*chifm2*pms->eta*pms->kappa1*nom*pms->sx2*v5l)/570 + (23873*chifm4*pms->eta*pms->kappa1*nom*pms->sx2*v5l)/570 - (142889*chifm2*pms->eta*pms->kappa2*nom*pms->sx2*v5l)/570 + (23873*chifm4*pms->eta*pms->kappa2*nom*pms->sx2*v5l)/570 + (744352*chifm2*pms->eta2*nom2*v5l2)/171 - (2985472*chifm4*pms->eta2*nom2*v5l2)/855;
	REAL8 PartPN4e02=(-235*chifm2)/12 + (41*chifm2*pms->eta)/6 - (287*chifm2*nom)/12 + (41*chifm2*pms->eta*nom)/6 + (5*chifm2*nom2)/3 + 2*chifm2*pms->eta*pms->sigx2 - (chifm2*pms->kappa1*pms->sigx2)/2 + (chifm2*pms->dm*pms->kappa1*pms->sigx2)/2 + chifm2*pms->eta*pms->kappa1*pms->sigx2 - (chifm2*pms->kappa2*pms->sigx2)/2 - (chifm2*pms->dm*pms->kappa2*pms->sigx2)/2 + chifm2*pms->eta*pms->kappa2*pms->sigx2 + 2*chifm2*pms->eta*nom*pms->sigx2 - (chifm2*pms->kappa1*nom*pms->sigx2)/2 + (chifm2*pms->dm*pms->kappa1*nom*pms->sigx2)/2 + chifm2*pms->eta*pms->kappa1*nom*pms->sigx2 - (chifm2*pms->kappa2*nom*pms->sigx2)/2 - (chifm2*pms->dm*pms->kappa2*nom*pms->sigx2)/2 + chifm2*pms->eta*pms->kappa2*nom*pms->sigx2 - 2*chifm2*pms->dm*pms->sigx*pms->sx + chifm2*pms->kappa1*pms->sigx*pms->sx - chifm2*pms->dm*pms->kappa1*pms->sigx*pms->sx - chifm2*pms->kappa2*pms->sigx*pms->sx - chifm2*pms->dm*pms->kappa2*pms->sigx*pms->sx - 2*chifm2*pms->dm*nom*pms->sigx*pms->sx + chifm2*pms->kappa1*nom*pms->sigx*pms->sx - chifm2*pms->dm*pms->kappa1*nom*pms->sigx*pms->sx - chifm2*pms->kappa2*nom*pms->sigx*pms->sx - chifm2*pms->dm*pms->kappa2*nom*pms->sigx*pms->sx - 2*chifm2*pms->sx2 - chifm2*pms->kappa1*pms->sx2 - chifm2*pms->kappa2*pms->sx2 - 2*chifm2*nom*pms->sx2 - chifm2*pms->kappa1*nom*pms->sx2 - chifm2*pms->kappa2*nom*pms->sx2 - (40402*chifm2*pms->eta*nom*v5l)/21 + (3404*chifm2*pms->eta2*nom*v5l)/5 + (344*chifm2*pms->eta*nom2*v5l)/3 + (688*chifm2*pms->eta2*nom*pms->sigx2*v5l)/5 - (172*chifm2*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/5 + (172*chifm2*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/5 + (344*chifm2*pms->eta2*pms->kappa1*nom*pms->sigx2*v5l)/5 - (172*chifm2*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/5 - (172*chifm2*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/5 + (344*chifm2*pms->eta2*pms->kappa2*nom*pms->sigx2*v5l)/5 - (688*chifm2*pms->dm*pms->eta*nom*pms->sigx*pms->sx*v5l)/5 + (344*chifm2*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/5 - (344*chifm2*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/5 - (344*chifm2*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/5 - (344*chifm2*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/5 - (688*chifm2*pms->eta*nom*pms->sx2*v5l)/5 - (344*chifm2*pms->eta*pms->kappa1*nom*pms->sx2*v5l)/5 - (344*chifm2*pms->eta*pms->kappa2*nom*pms->sx2*v5l)/5 + (3584*chifm2*pms->eta2*nom2*v5l2)/3;
	REAL8 PartPN4e00=-9./2 + (7*pms->eta)/3 - (7*nom)/2 + (7*pms->eta*nom)/3 + 4*nom2 + pms->eta*pms->sigx2 - (pms->kappa1*pms->sigx2)/4 + (pms->dm*pms->kappa1*pms->sigx2)/4 + (pms->eta*pms->kappa1*pms->sigx2)/2 - (pms->kappa2*pms->sigx2)/4 - (pms->dm*pms->kappa2*pms->sigx2)/4 + (pms->eta*pms->kappa2*pms->sigx2)/2 + pms->eta*nom*pms->sigx2 - (pms->kappa1*nom*pms->sigx2)/4 + (pms->dm*pms->kappa1*nom*pms->sigx2)/4 + (pms->eta*pms->kappa1*nom*pms->sigx2)/2 - (pms->kappa2*nom*pms->sigx2)/4 - (pms->dm*pms->kappa2*nom*pms->sigx2)/4 + (pms->eta*pms->kappa2*nom*pms->sigx2)/2 - pms->dm*pms->sigx*pms->sx + (pms->kappa1*pms->sigx*pms->sx)/2 - (pms->dm*pms->kappa1*pms->sigx*pms->sx)/2 - (pms->kappa2*pms->sigx*pms->sx)/2 - (pms->dm*pms->kappa2*pms->sigx*pms->sx)/2 - pms->dm*nom*pms->sigx*pms->sx + (pms->kappa1*nom*pms->sigx*pms->sx)/2 - (pms->dm*pms->kappa1*nom*pms->sigx*pms->sx)/2 - (pms->kappa2*nom*pms->sigx*pms->sx)/2 - (pms->dm*pms->kappa2*nom*pms->sigx*pms->sx)/2 - pms->sx2 - (pms->kappa1*pms->sx2)/2 - (pms->kappa2*pms->sx2)/2 - nom*pms->sx2 - (pms->kappa1*nom*pms->sx2)/2 - (pms->kappa2*nom*pms->sx2)/2 - (25252*pms->eta*nom*v5l)/105 + (1424*pms->eta2*nom*v5l)/15 + (512*pms->eta*nom2*v5l)/5 + (128*pms->eta2*nom*pms->sigx2*v5l)/5 - (32*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/5 + (32*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx2*v5l)/5 + (64*pms->eta2*pms->kappa1*nom*pms->sigx2*v5l)/5 - (32*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/5 - (32*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx2*v5l)/5 + (64*pms->eta2*pms->kappa2*nom*pms->sigx2*v5l)/5 - (128*pms->dm*pms->eta*nom*pms->sigx*pms->sx*v5l)/5 + (64*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/5 - (64*pms->dm*pms->eta*pms->kappa1*nom*pms->sigx*pms->sx*v5l)/5 - (64*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/5 - (64*pms->dm*pms->eta*pms->kappa2*nom*pms->sigx*pms->sx*v5l)/5 - (128*pms->eta*nom*pms->sx2*v5l)/5 - (64*pms->eta*pms->kappa1*nom*pms->sx2*v5l)/5 - (64*pms->eta*pms->kappa2*nom*pms->sx2*v5l)/5 + (16384*pms->eta2*nom2*v5l2)/25;
	REAL8 PartPN3e010=(23922845804215*chifm2*pms->dm*pms->sigx)/2075394244608 - (6857994797935*chifm4*pms->dm*pms->sigx)/64856070144 + (2954397067293*chifm6*pms->dm*pms->sigx)/8540717056 - (453903041083475*chifm8*pms->dm*pms->sigx)/1037697122304 + (48411662696233*chifm10*pms->dm*pms->sigx)/259424280576 + (23922845804215*chifm2*pms->dm*nom*pms->sigx)/2075394244608 - (6857994797935*chifm4*pms->dm*nom*pms->sigx)/64856070144 + (2954397067293*chifm6*pms->dm*nom*pms->sigx)/8540717056 - (453903041083475*chifm8*pms->dm*nom*pms->sigx)/1037697122304 + (48411662696233*chifm10*pms->dm*nom*pms->sigx)/259424280576 + (23922845804215*chifm2*pms->sx)/691798081536 - (6857994797935*chifm4*pms->sx)/21618690048 + (8863191201879*chifm6*pms->sx)/8540717056 - (453903041083475*chifm8*pms->sx)/345899040768 + (48411662696233*chifm10*pms->sx)/86474760192 + (23922845804215*chifm2*nom*pms->sx)/691798081536 - (6857994797935*chifm4*nom*pms->sx)/21618690048 + (8863191201879*chifm6*nom*pms->sx)/8540717056 - (453903041083475*chifm8*nom*pms->sx)/345899040768 + (48411662696233*chifm10*nom*pms->sx)/86474760192 + (62199399090959*chifm2*pms->dm*pms->eta*nom*pms->sigx*v5l)/86474760192 - (6513681362363*chifm4*pms->dm*pms->eta*nom*pms->sigx*v5l)/2702336256 + (44303210157591*chifm6*pms->dm*pms->eta*nom*pms->sigx*v5l)/5337948160 - (457391699983951*chifm8*pms->dm*pms->eta*nom*pms->sigx*v5l)/43237380096 + (489064258712537*chifm10*pms->dm*pms->eta*nom*pms->sigx*v5l)/108093450240 + (62199399090959*chifm2*pms->eta*nom*pms->sx*v5l)/28824920064 - (6513681362363*chifm4*pms->eta*nom*pms->sx*v5l)/900778752 + (132909630472773*chifm6*pms->eta*nom*pms->sx*v5l)/5337948160 - (457391699983951*chifm8*pms->eta*nom*pms->sx*v5l)/14412460032 + (489064258712537*chifm10*pms->eta*nom*pms->sx*v5l)/36031150080;
	REAL8 PartPN3e08=(8286900895*chifm2*pms->dm*pms->sigx)/1137825792 - (53615809447*chifm4*pms->dm*pms->sigx)/1517101056 + (1654491793*chifm6*pms->dm*pms->sigx)/28094464 - (136594354825*chifm8*pms->dm*pms->sigx)/4551303168 + (8286900895*chifm2*pms->dm*nom*pms->sigx)/1137825792 - (53615809447*chifm4*pms->dm*nom*pms->sigx)/1517101056 + (1654491793*chifm6*pms->dm*nom*pms->sigx)/28094464 - (136594354825*chifm8*pms->dm*nom*pms->sigx)/4551303168 + (8286900895*chifm2*pms->sx)/379275264 - (53615809447*chifm4*pms->sx)/505700352 + (4963475379*chifm6*pms->sx)/28094464 - (136594354825*chifm8*pms->sx)/1517101056 + (8286900895*chifm2*nom*pms->sx)/379275264 - (53615809447*chifm4*nom*pms->sx)/505700352 + (4963475379*chifm6*nom*pms->sx)/28094464 - (136594354825*chifm8*nom*pms->sx)/1517101056 + (21545942327*chifm2*pms->dm*pms->eta*nom*pms->sigx*v5l)/47409408 - (254619833503*chifm4*pms->dm*pms->eta*nom*pms->sigx*v5l)/316062720 + (24810239091*chifm6*pms->dm*pms->eta*nom*pms->sigx*v5l)/17559040 - (137644207037*chifm8*pms->dm*pms->eta*nom*pms->sigx*v5l)/189637632 + (21545942327*chifm2*pms->eta*nom*pms->sx*v5l)/15803136 - (254619833503*chifm4*pms->eta*nom*pms->sx*v5l)/105354240 + (74430717273*chifm6*pms->eta*nom*pms->sx*v5l)/17559040 - (137644207037*chifm8*pms->eta*nom*pms->sx*v5l)/63212544;
	REAL8 PartPN3e06=(1689785*chifm2*pms->dm*pms->sigx)/415872 - (7254109*chifm4*pms->dm*pms->sigx)/831744 + (497891*chifm6*pms->dm*pms->sigx)/92416 + (1689785*chifm2*pms->dm*nom*pms->sigx)/415872 - (7254109*chifm4*pms->dm*nom*pms->sigx)/831744 + (497891*chifm6*pms->dm*nom*pms->sigx)/92416 + (1689785*chifm2*pms->sx)/138624 - (7254109*chifm4*pms->sx)/277248 + (1493673*chifm6*pms->sx)/92416 + (1689785*chifm2*nom*pms->sx)/138624 - (7254109*chifm4*nom*pms->sx)/277248 + (1493673*chifm6*nom*pms->sx)/92416 + (4393441*chifm2*pms->dm*pms->eta*nom*pms->sigx*v5l)/17328 - (34449541*chifm4*pms->dm*pms->eta*nom*pms->sigx*v5l)/173280 + (7466217*chifm6*pms->dm*pms->eta*nom*pms->sigx*v5l)/57760 + (4393441*chifm2*pms->eta*nom*pms->sx*v5l)/5776 - (34449541*chifm4*pms->eta*nom*pms->sx*v5l)/57760 + (22398651*chifm6*pms->eta*nom*pms->sx*v5l)/57760;
	REAL8 PartPN3e04=(3323*chifm2*pms->dm*pms->sigx)/1824 - (2183*chifm4*pms->dm*pms->sigx)/1824 + (3323*chifm2*pms->dm*nom*pms->sigx)/1824 - (2183*chifm4*pms->dm*nom*pms->sigx)/1824 + (3323*chifm2*pms->sx)/608 - (2183*chifm4*pms->sx)/608 + (3323*chifm2*nom*pms->sx)/608 - (2183*chifm4*nom*pms->sx)/608 + (43199*chifm2*pms->dm*pms->eta*nom*pms->sigx*v5l)/380 - (10367*chifm4*pms->dm*pms->eta*nom*pms->sigx*v5l)/380 + (129597*chifm2*pms->eta*nom*pms->sx*v5l)/380 - (31101*chifm4*pms->eta*nom*pms->sx*v5l)/380;
	REAL8 PartPN3e02=(chifm2*pms->dm*pms->sigx)/2 + (chifm2*pms->dm*nom*pms->sigx)/2 + (3*chifm2*pms->sx)/2 + (3*chifm2*nom*pms->sx)/2 + (156*chifm2*pms->dm*pms->eta*nom*pms->sigx*v5l)/5 + (468*chifm2*pms->eta*nom*pms->sx*v5l)/5;
	REAL8 PartPN3e00=(pms->dm*pms->sigx)/3 + (pms->dm*nom*pms->sigx)/3 + pms->sx + nom*pms->sx + (32*pms->dm*pms->eta*nom*pms->sigx*v5l)/5 + (96*pms->eta*nom*pms->sx*v5l)/5;
	REAL8 PartPN2e012=(-31858128517448053*chifm2)/946379775541248 + (273074849099381935*chifm4)/473189887770624 - (4250441456484795*chifm6)/1298188992512 + (7237919439832013023*chifm8)/946379775541248 - (1835883883067765255*chifm10)/236594943885312 + (11065637715060109*chifm12)/3894566977536 - (31858128517448053*chifm2*nom)/946379775541248 + (273074849099381935*chifm4*nom)/473189887770624 - (4250441456484795*chifm6*nom)/1298188992512 + (7237919439832013023*chifm8*nom)/946379775541248 - (1835883883067765255*chifm10*nom)/236594943885312 + (11065637715060109*chifm12*nom)/3894566977536 - (223006899622136371*chifm2*pms->eta*nom*v5l)/118297471942656 + (826926368011027585*chifm4*pms->eta*nom*v5l)/59148735971328 - (12458057208281685*chifm6*pms->eta*nom*v5l)/162273624064 + (20881369315947618289.*chifm8*pms->eta*nom*v5l)/118297471942656 - (5249070924315061907*chifm10*pms->eta*nom*v5l)/29574367985664 + (31456279784120387*chifm12*pms->eta*nom*v5l)/486820872192;
	REAL8 PartPN2e010=(-23922845804215*chifm2)/1037697122304 + (7574267273395*chifm4)/32428035072 - (3328251651585*chifm6)/4270358528 + (515628012131687*chifm8)/518848561152 - (110495569248737*chifm10)/259424280576 - (23922845804215*chifm2*nom)/1037697122304 + (7574267273395*chifm4*nom)/32428035072 - (3328251651585*chifm6*nom)/4270358528 + (515628012131687*chifm8*nom)/518848561152 - (110495569248737*chifm10*nom)/259424280576 - (167459920629505*chifm2*pms->eta*nom*v5l)/129712140288 + (22936426944445*chifm4*pms->eta*nom*v5l)/4053504384 - (9755116004655*chifm6*pms->eta*nom*v5l)/533794816 + (1487584801195241*chifm8*pms->eta*nom*v5l)/64856070144 - (1579618093384009*chifm10*pms->eta*nom*v5l)/162140175360;
	REAL8 PartPN2e08=(-8286900895*chifm2)/568912896 + (59215628299*chifm4)/758550528 - (1863854085*chifm6)/14047232 + (155169428869*chifm8)/2275651584 - (8286900895*chifm2*nom)/568912896 + (59215628299*chifm4*nom)/758550528 - (1863854085*chifm6*nom)/14047232 + (155169428869*chifm8*nom)/2275651584 - (58008306265*chifm2*pms->eta*nom*v5l)/71114112 + (179317006309*chifm4*pms->eta*nom*v5l)/94818816 - (5462962155*chifm6*pms->eta*nom*v5l)/1755904 + (447663196267*chifm8*pms->eta*nom*v5l)/284456448;
	REAL8 PartPN2e06=(-1689785*chifm2)/207936 + (8011753*chifm4)/415872 - (560895*chifm6)/46208 - (1689785*chifm2*nom)/207936 + (8011753*chifm4*nom)/415872 - (560895*chifm6*nom)/46208 - (11828495*chifm2*pms->eta*nom*v5l)/25992 + (24261223*chifm4*pms->eta*nom*v5l)/51984 - (1643985*chifm6*pms->eta*nom*v5l)/5776;
	REAL8 PartPN2e04=(-3323*chifm2)/912 + (2411*chifm4)/912 - (3323*chifm2*nom)/912 + (2411*chifm4*nom)/912 - (23261*chifm2*pms->eta*nom*v5l)/114 + (7301*chifm4*pms->eta*nom*v5l)/114;
	REAL8 PartPN2e02=-chifm2 - chifm2*nom - 56*chifm2*pms->eta*nom*v5l;
	REAL8 PartPN2e00=-1 - nom - (64*pms->eta*nom*v5l)/5;
	REAL8 PartPN0e00=1;
	return vfm*(PartPN0e00 + (PartPN2e00 + e010*PartPN2e010 + e012*PartPN2e012 + e02*PartPN2e02 + e04*PartPN2e04 + e06*PartPN2e06 + e08*PartPN2e08)*vfm2 + (PartPN3e00 + e010*PartPN3e010 + e02*PartPN3e02 + e04*PartPN3e04 + e06*PartPN3e06 + e08*PartPN3e08)*vfm3 + (PartPN4e00 + e02*PartPN4e02 + e04*PartPN4e04 + e06*PartPN4e06 + e08*PartPN4e08)*vfm4);
}

REAL8 calculate_invsqpsiddot(INT n, INT m, REAL8 lval, BBHCore *core)
{
    BBHDynParams *pms = core->pms;
    BBHDynVariables *var = core->var;

    REAL8 v5l = var->vom5*lval;
    REAL8 v5l2 = v5l*v5l;

    REAL8 m2 = m*m, n2 = n*n;
    REAL8 sqme2p = sqrt(1. - var->e02);
    REAL8 sqme2p2 = sqme2p*sqme2p;
    REAL8 sqme2p3 = sqme2p2*sqme2p;
    REAL8 sqme2p5 = sqme2p3*sqme2p2;
    REAL8 sqme2p6 = sqme2p3 * sqme2p3;
    REAL8 sqme2p7 = sqme2p6 * sqme2p;
    REAL8 sqme2p9 = sqme2p6 * sqme2p3;
    REAL8 sqme2p10 = sqme2p9*sqme2p;
    REAL8 sqme2p15 = sqme2p10*sqme2p5;

    REAL8 e016 = var->e015*var->e0;
    REAL8 e018 = var->e015*var->e03;

    REAL8 vom11 = var->vom6*var->vom5;
    REAL8 pref = sqrt(5) * pow(1. - var->e02, 7./4.) / sqrt( (96. + 292.*var->e02 + 37.*var->e04)*m*vom11*pms->eta );
    REAL8 PN0 = 1.;
    REAL8 PN2 = (((16*(-4969 + 924*pms->eta) + 98*var->e04*(-2243 + 1446*pms->eta) + var->e06*(-11717 + 8288*pms->eta) + 8*var->e02*(-49969 + 19950*pms->eta))*m*sqme2p5 + 56*n*(3*(-1 + var->e02)*(-1. + var->e02)*(-224 - 276*var->e02 + 75*var->e04)*sqme2p + 8*(-1536 - 1760*var->e02 - 858*var->e04 + 329*var->e06)*pms->eta*v5l))*var->vom2)/(112*(96 + 292*var->e02 + 37*var->e04)*m*sqme2p7);

    REAL8 PN3 = ((m*sqme2p6*(78033715200*pms->dm*(5136 + 26512*var->e02 + 13936*var->e04 + 621*var->e06)*pms->sigx - (179789679820800 + 1010380544409600*var->e02 + 47093347123200*var->e04 + 3705385446604800*var->e06 - 6228810398361600*var->e08 + 23280334705627776*var->e010 - 62023162920413520*var->e012 + 186636591503717147*var->e014)*CST_PI*sqme2p10 + 468202291200*(2528 + 11812*var->e02 + 5303*var->e04 + 201*var->e06)*pms->sx) + 93640458240*n*(pms->dm*pms->sigx + 3*pms->sx)*(-3305*var->e08 + 655*var->e010 + var->e06*(4545 - 8932*pms->eta*sqme2p*v5l) + 96*(15 + 352*pms->eta*sqme2p*v5l) + 4*var->e02*(-745 + 9376*pms->eta*sqme2p*v5l) + var->e04*(-355 + 14136*pms->eta*sqme2p*v5l)))*var->vom3)/(936404582400*(96 + 292*var->e02 + 37*var->e04)*m*sqme2p9);

    REAL8 PN4 = -1/3386880*((-5*m2*sqme2p10*(3*var->e012*(-365500800*(-5 + 2*pms->eta) + (1273481691 - 2992407264*pms->eta + 498009344*pms->eta2)*sqme2p) - 252*var->e010*(-93393328*pms->eta2*sqme2p + pms->eta*(305383680 + 709079342*sqme2p - 4400928*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2*sqme2p) + 7*(-109065600 - 42628651*sqme2p + 2664*pms->sigx2*(9*sqme2p + 118*(1 + pms->dm)*pms->kappa2*sqme2p + 118*pms->kappa1*(sqme2p - pms->dm*sqme2p))) + 4400928*(-pms->kappa1 + pms->kappa2 + pms->dm*(2 + pms->kappa1 + pms->kappa2))*pms->sigx*sqme2p*pms->sx + 4400928*(2 + pms->kappa1 + pms->kappa2)*sqme2p*pms->sx2) - 12*var->e08*(-101307578400 - 80261768767*sqme2p - 35152992980*pms->eta2*sqme2p + 81856656*pms->sigx2*sqme2p + 1523580912*pms->kappa1*pms->sigx2*sqme2p - 1523580912*pms->dm*pms->kappa1*pms->sigx2*sqme2p + 1523580912*pms->kappa2*pms->sigx2*sqme2p + 1523580912*pms->dm*pms->kappa2*pms->sigx2*sqme2p - 147127680*sqme2p3 - 84*pms->eta*(-482417040 + (-1791688505 + 36275736*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2)*sqme2p - 571872*sqme2p3) + 3047161824*(-pms->kappa1 + pms->kappa2 + pms->dm*(2 + pms->kappa1 + pms->kappa2))*pms->sigx*sqme2p*pms->sx + 3047161824*(2 + pms->kappa1 + pms->kappa2)*sqme2p*pms->sx2) - 384*var->e04*(-1288985278*pms->eta2*sqme2p - 21*pms->eta*(62872320 - 194346311*sqme2p + 3928176*sqme2p3 + 1008*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2*(77527*sqme2p - 2340*sqme2p3)) + 4*(825199200 - 620924414*sqme2p + 31260348*sqme2p3 + 1323*pms->sigx2*sqme2p*(3639 + 2*(-1 + pms->dm)*pms->kappa1*(-77527 + 2340*sqme2p2) - 2*(1 + pms->dm)*pms->kappa2*(-77527 + 2340*sqme2p2))) - 21168*(-pms->kappa1 + pms->kappa2 + pms->dm*(2 + pms->kappa1 + pms->kappa2))*pms->sigx*sqme2p*(-77527 + 2340*sqme2p2)*pms->sx + 21168*(2 + pms->kappa1 + pms->kappa2)*(77527*sqme2p - 2340*sqme2p3)*pms->sx2) - 128*var->e06*(-3714016887*pms->eta2*sqme2p - 63*pms->eta*(-20527416 - 307681693*sqme2p + 9281580*sqme2p3 + 336*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2*(107354*sqme2p - 777*sqme2p3)) + 2*(-1616534010 - 6441967067*sqme2p + 327837321*sqme2p3 + 5292*pms->sigx2*sqme2p*(4386 + (-1 + pms->dm)*pms->kappa1*(-107354 + 777*sqme2p2) - (1 + pms->dm)*pms->kappa2*(-107354 + 777*sqme2p2))) - 21168*(-pms->kappa1 + pms->kappa2 + pms->dm*(2 + pms->kappa1 + pms->kappa2))*pms->sigx*sqme2p*(-107354 + 777*sqme2p2)*pms->sx + 21168*(2 + pms->kappa1 + pms->kappa2)*(107354*sqme2p - 777*sqme2p3)*pms->sx2) - 256*var->e02*(2065150080 + 1395692891*sqme2p - 80082072*pms->eta2*sqme2p + 9557352*pms->sigx2*sqme2p + 615988800*pms->kappa1*pms->sigx2*sqme2p - 615988800*pms->dm*pms->kappa1*pms->sigx2*sqme2p + 615988800*pms->kappa2*pms->sigx2*sqme2p + 615988800*pms->dm*pms->kappa2*pms->sigx2*sqme2p + 131618088*sqme2p3 - 47755008*pms->kappa1*pms->sigx2*sqme2p3 + 47755008*pms->dm*pms->kappa1*pms->sigx2*sqme2p3 - 47755008*pms->kappa2*pms->sigx2*sqme2p3 - 47755008*pms->dm*pms->kappa2*pms->sigx2*sqme2p3 - 126*pms->eta*(6556032 + 5942483*sqme2p + 527856*sqme2p3 + 4032*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2*(2425*sqme2p - 188*sqme2p3)) - 508032*(-pms->kappa1 + pms->kappa2 + pms->dm*(2 + pms->kappa1 + pms->kappa2))*pms->sigx*sqme2p*(-2425 + 188*sqme2p2)*pms->sx + 508032*(2 + pms->kappa1 + pms->kappa2)*(2425*sqme2p - 188*sqme2p3)*pms->sx2) - 768*(40642560 + 173236309*sqme2p - 9730224*pms->eta2*sqme2p + 254016*pms->sigx2*sqme2p + 29465856*pms->kappa1*pms->sigx2*sqme2p - 29465856*pms->dm*pms->kappa1*pms->sigx2*sqme2p + 29465856*pms->kappa2*pms->sigx2*sqme2p + 29465856*pms->dm*pms->kappa2*pms->sigx2*sqme2p - 23212224*sqme2p3 - 4064256*pms->kappa1*pms->sigx2*sqme2p3 + 4064256*pms->dm*pms->kappa1*pms->sigx2*sqme2p3 - 4064256*pms->kappa2*pms->sigx2*sqme2p3 - 4064256*pms->dm*pms->kappa2*pms->sigx2*sqme2p3 - 504*pms->eta*(32256 + 230257*sqme2p - 61152*sqme2p3 + 4032*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2*(29*sqme2p - 4*sqme2p3)) - 2032128*(-pms->kappa1 + pms->kappa2 + pms->dm*(2 + pms->kappa1 + pms->kappa2))*pms->sigx*sqme2p*(-29 + 4*sqme2p2)*pms->sx + 2032128*(2 + pms->kappa1 + pms->kappa2)*(29*sqme2p - 4*sqme2p3)*pms->sx2)) - 1008*m*n*sqme2p6*(15*var->e014*(-253305 + 2072*pms->eta)*sqme2p + 4*var->e012*(45*(-5372628*sqme2p + 48433*(1 + pms->dm)*pms->kappa2*pms->sigx2*sqme2p + 48433*pms->kappa1*pms->sigx2*(sqme2p - pms->dm*sqme2p)) + 4358970*(-pms->kappa1 + pms->kappa2 + pms->dm*(2 + pms->kappa1 + pms->kappa2))*pms->sigx*sqme2p*pms->sx + 4358970*(2 + pms->kappa1 + pms->kappa2)*sqme2p*pms->sx2 - 21*pms->eta*(5*(-1722373 + 41514*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2)*sqme2p - 8763202*v5l) - 149325932*pms->eta2*v5l) + 16*var->e04*(-840*pms->eta*(-23470 + 28257*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2)*sqme2p + 15*(473257*sqme2p + 791196*(1 + pms->dm)*pms->kappa2*pms->sigx2*sqme2p + 1881936*sqme2p3 + 791196*pms->kappa1*pms->sigx2*(sqme2p - pms->dm*sqme2p)) + 528*pms->eta*(-22792331 + 558992*(-1 + pms->dm)*pms->kappa1*pms->sigx2 - 558992*(1 + pms->dm)*pms->kappa2*pms->sigx2)*v5l + 448*pms->eta2*(14532295 + 1317624*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2)*v5l + 168*(-pms->kappa1 + pms->kappa2 + pms->dm*(2 + pms->kappa1 + pms->kappa2))*pms->sigx*pms->sx*(141285*sqme2p - 3513664*pms->eta*v5l) + 168*(2 + pms->kappa1 + pms->kappa2)*pms->sx2*(141285*sqme2p - 3513664*pms->eta*v5l)) + 96*var->e06*(-35*pms->eta*(-246823 + 44418*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2)*sqme2p + 105*(-196387*sqme2p + 7403*(1 + pms->dm)*pms->kappa2*pms->sigx2*sqme2p - 27522*sqme2p3 + 7403*pms->kappa1*pms->sigx2*(sqme2p - pms->dm*sqme2p)) + 16*pms->eta*(-60441508 + 795011*(-1 + pms->dm)*pms->kappa1*pms->sigx2 - 795011*(1 + pms->dm)*pms->kappa2*pms->sigx2)*v5l + 56*pms->eta2*(11884255 + 454292*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2)*v5l + 14*(-pms->kappa1 + pms->kappa2 + pms->dm*(2 + pms->kappa1 + pms->kappa2))*pms->sigx*pms->sx*(111045*sqme2p - 1817168*pms->eta*v5l) + 14*(2 + pms->kappa1 + pms->kappa2)*pms->sx2*(111045*sqme2p - 1817168*pms->eta*v5l)) + 3*var->e010*(5*(185689547*sqme2p + 2616264*(1 + pms->dm)*pms->kappa2*pms->sigx2*sqme2p + 8438976*sqme2p3 + 2616264*pms->kappa1*pms->sigx2*(sqme2p - pms->dm*sqme2p)) - 224*pms->eta2*(-4719047 + 417508*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2)*v5l + 112*(-pms->kappa1 + pms->kappa2 + pms->dm*(2 + pms->kappa1 + pms->kappa2))*pms->sigx*pms->sx*(233595*sqme2p + 835016*pms->eta*v5l) + 112*(2 + pms->kappa1 + pms->kappa2)*pms->sx2*(233595*sqme2p + 835016*pms->eta*v5l) - 16*pms->eta*(35*(1510844 + 46719*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2)*sqme2p + 4*(25922635 + 730639*(-1 + pms->dm)*pms->kappa1*pms->sigx2 - 730639*(1 + pms->dm)*pms->kappa2*pms->sigx2)*v5l)) - 192*var->e02*(5*(-1303051*sqme2p + 78960*(1 + pms->dm)*pms->kappa2*pms->sigx2*sqme2p - 149184*sqme2p3 + 78960*pms->kappa1*pms->sigx2*(sqme2p - pms->dm*sqme2p)) - 1792*pms->eta2*(132617 + 28488*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2)*v5l + 672*(-pms->kappa1 + pms->kappa2 + pms->dm*(2 + pms->kappa1 + pms->kappa2))*pms->sigx*pms->sx*(1175*sqme2p + 75968*pms->eta*v5l) + 672*(2 + pms->kappa1 + pms->kappa2)*pms->sx2*(1175*sqme2p + 75968*pms->eta*v5l) - 4*pms->eta*(35*(-43961 + 5640*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2)*sqme2p + 16*(-10862057 + 398832*(-1 + pms->dm)*pms->kappa1*pms->sigx2 - 398832*(1 + pms->dm)*pms->kappa2*pms->sigx2)*v5l)) - 32256*(5*(1799*sqme2p + 264*(1 + pms->dm)*pms->kappa2*pms->sigx2*sqme2p + 1440*sqme2p3 + 264*pms->kappa1*pms->sigx2*(sqme2p - pms->dm*sqme2p)) - 1536*pms->eta2*(301 + 48*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2)*v5l + 48*(-pms->kappa1 + pms->kappa2 + pms->dm*(2 + pms->kappa1 + pms->kappa2))*pms->sigx*pms->sx*(55*sqme2p + 1536*pms->eta*v5l) + 48*(2 + pms->kappa1 + pms->kappa2)*pms->sx2*(55*sqme2p + 1536*pms->eta*v5l) - 4*pms->eta*(55*(35 + 12*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2)*sqme2p + 32*(-9481 + 288*(-1 + pms->dm)*pms->kappa1*pms->sigx2 - 288*(1 + pms->dm)*pms->kappa2*pms->sigx2)*v5l)) - 2*var->e08*(15*(30308585*sqme2p + 6469722*(1 + pms->dm)*pms->kappa2*pms->sigx2*sqme2p + 7060032*sqme2p3 + 6469722*pms->kappa1*pms->sigx2*(sqme2p - pms->dm*sqme2p)) + 224*pms->eta2*(2353475 + 4325676*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2)*v5l + 84*(-pms->kappa1 + pms->kappa2 + pms->dm*(2 + pms->kappa1 + pms->kappa2))*pms->sigx*pms->sx*(2310615*sqme2p - 11535136*pms->eta*v5l) + 84*(2 + pms->kappa1 + pms->kappa2)*pms->sx2*(2310615*sqme2p - 11535136*pms->eta*v5l) - 6*pms->eta*(315*(424161 + 102694*(2 + pms->kappa1 + pms->kappa2)*pms->sigx2)*sqme2p + (112378696 - 80745952*(-1 + pms->dm)*pms->kappa1*pms->sigx2 + 80745952*(1 + pms->dm)*pms->kappa2*pms->sigx2)*v5l))) + 1270080*n2*(48*pow(-1 + var->e02, 3)*(344064 + 818176*var->e02 + 562752*var->e04 + 31112*var->e06 - 155154*var->e08 + 24675*var->e010)*pms->eta*v5l + sqme2p*(2752434*var->e014 - 625725*e016 + 50625*e018 + var->e04*(665136 - 366936064*pms->eta2*v5l2) - 9216*(49 + 16384*pms->eta2*v5l2) - 98*var->e012*(51381 + 70688*pms->eta2*v5l2) - 768*var->e02*(-1491 + 450560*pms->eta2*v5l2) + 11*var->e08*(284085 + 2454784*pms->eta2*v5l2) - 24*var->e06*(180165 + 5358592*pms->eta2*v5l2) + 3*var->e010*(899463 + 12044032*pms->eta2*v5l2))))*var->vom4)/( pow(96 + 292*var->e02 + 37*var->e04, 2)*m2*sqme2p15);
    // return pref;
    return pref*(PN0 + PN2 + PN3 + PN4);
}

REAL8 calc_et_by_vom(REAL8 vom, BBHDynParams *pms)
{
    REAL8 e0 = pms->eini;
    REAL8 chixBye = pow(e0, 4./19.)*pow(1. + 121.*e0*e0/304., 290./2299.) / pow(1. - e0*e0, 1./3.);
    REAL8 chix = chixBye/pow(vom/pms->vomini, 2./3.);
    REAL8 X2 = chix*chix;
    REAL8 X3 = X2*chix;
    REAL8 X4 = X3*chix;
    REAL8 X5 = X4*chix;
    return X5 / (1.947627405784601 - 3.2626522812518073*chix + 2.6617331910331887*X2 -
        0.5402961833237743*X3 + 0.04198313682829807*X4 + X5);
}

INT calc_QSPA_emode(INT n, INT m, REAL8Vector *freqsVec, BBHCore *core,
    REAL8Vector **ret_ReAmpQpVec, REAL8Vector **ret_ImAmpQpVec,
    REAL8Vector **ret_ReAmpQcVec, REAL8Vector **ret_ImAmpQcVec,
    REAL8Vector **ret_PhaseVec)
{
    INT status;
    REAL8 vom;
    REAL8 et;
    REAL8 k, lval, tval;
    REAL8Vector *ReAmpQpVec = CreateREAL8Vector(freqsVec->length);
    REAL8Vector *ImAmpQpVec = CreateREAL8Vector(freqsVec->length);
    REAL8Vector *ReAmpQcVec = CreateREAL8Vector(freqsVec->length);
    REAL8Vector *ImAmpQcVec = CreateREAL8Vector(freqsVec->length);
    REAL8Vector *PhaseVec = CreateREAL8Vector(freqsVec->length);
    COMPLEX16 Qp, Qc, AmpQp, AmpQc;
    REAL8 invsqpsiddot;
    for (INT i = 0; i < freqsVec->length; i++) {
        vom = Calculate_vom(n, m, freqsVec->data[i], core);
        et = calc_et_by_vom(vom, core->pms);
        SetBBHCoreDynVariables(et, vom, core);
        lval = Calculate_l(core);
        tval = Calculate_t(core);
        k = calculate_k(core->var, core->pms);
        invsqpsiddot = calculate_invsqpsiddot(n, m, lval, core);
        //Qpc = calculate_QpcWaveform_emode(n, m, lval, core);
        status = calculate_QpcWaveform_eexp_emode(n, m, lval, core, &Qp, &Qc);
        AmpQp = CST_SQRT2PI * invsqpsiddot * Qp;
        AmpQc = CST_SQRT2PI * invsqpsiddot * Qc;
        // print_debug("vom = %.5e, et = %.5e, l = %.5e, t = %.5e, invsqpsiddot = %.5e, Qpc = %.5e + I %.5e\n",
        //     vom, et, invsqpsiddot, creal(Qpc), cimag(Qpc));
        ReAmpQpVec->data[i] = creal(AmpQp);
        ImAmpQpVec->data[i] = cimag(AmpQp);
        ReAmpQcVec->data[i] = creal(AmpQc);
        ImAmpQcVec->data[i] = cimag(AmpQc);
        PhaseVec->data[i] = (m + n*k)*lval - CST_2PI*tval*freqsVec->data[i] + CST_PI_4;
    }
    *ret_ReAmpQpVec = ReAmpQpVec;
    *ret_ImAmpQpVec = ImAmpQpVec;
    *ret_ReAmpQcVec = ReAmpQcVec;
    *ret_ImAmpQcVec = ImAmpQcVec;
    *ret_PhaseVec = PhaseVec;
    return X_SUCCESS;
}

INT calculate_QWaveformVec(REAL8Vector *tSIVec, REAL8Vector *lVec, 
    REAL8Vector *etVec, REAL8Vector *vomVec, 
    BBHCore *core, AntennaPatternF *apf,
    REAL8Vector **QVec)
{
    REAL8Vector *ret_QVec = CreateREAL8Vector(lVec->length);
    REAL8 QQ;
    for (INT i = 0; i < lVec->length; i++) {
        SetBBHCoreDynVariables(etVec->data[i], vomVec->data[i], core);
        QQ = calculate_QWaveform(tSIVec->data[i], lVec->data[i], core, apf);
        ret_QVec->data[i] = QQ;
    }
    *QVec = ret_QVec;
    return X_SUCCESS;
}


INT calc_QSPA_Allemode(REAL8Vector *freqsVec, BBHCore *core,
    REAL8Vector **ret_ReQpVec, REAL8Vector **ret_ImQpVec, 
    REAL8Vector **ret_ReQcVec, REAL8Vector **ret_ImQcVec)
{
    INT status;
    REAL8 vom;
    REAL8 et;
    REAL8 k, lval, tval;
    REAL8Vector *ReQpVec = CreateREAL8Vector(freqsVec->length);
    REAL8Vector *ImQpVec = CreateREAL8Vector(freqsVec->length);
    REAL8Vector *ReQcVec = CreateREAL8Vector(freqsVec->length);
    REAL8Vector *ImQcVec = CreateREAL8Vector(freqsVec->length);

    for (INT i=0; i < freqsVec->length; i++) {
        ReQpVec->data[i] = 0;
        ImQpVec->data[i] = 0;
        ReQcVec->data[i] = 0;
        ImQcVec->data[i] = 0;
    }

    INT n, m;
    COMPLEX16 Qp, Qc, QQ, AmpQp, AmpQc;
    REAL8 invsqpsiddot, phase;
    for (INT ikl = 0; ikl < n_scpart_Func; ikl++) {
        m = scpart_Func_lkList[ikl][0];
        n = scpart_Func_lkList[ikl][1];
        for (INT i = 0; i < freqsVec->length; i++) {
            vom = Calculate_vom(n, m, freqsVec->data[i], core);
            et = calc_et_by_vom(vom, core->pms);
            SetBBHCoreDynVariables(et, vom, core);
            lval = Calculate_l(core);
            tval = Calculate_t(core);
            phase = (m + n*k)*lval - CST_2PI*tval*freqsVec->data[i] + CST_PI_4;
            k = calculate_k(core->var, core->pms);
            invsqpsiddot = calculate_invsqpsiddot(n, m, lval, core);
            // Qpc = calculate_QpcWaveform_emode(n, m, lval, core);
            status = calculate_QpcWaveform_eexp_emode(n, m, lval, core, &Qp, &Qc);
            AmpQp = CST_SQRT2PI * invsqpsiddot * Qp;
            AmpQc = CST_SQRT2PI * invsqpsiddot * Qc;
            // print_debug("vom = %.5e, et = %.5e, l = %.5e, t = %.5e, invsqpsiddot = %.5e, Qpc = %.5e + I %.5e\n",
            //     vom, et, invsqpsiddot, creal(Qpc), cimag(Qpc));
            Qp = AmpQp * cexp(I*phase);
            Qc = AmpQc * cexp(I*phase);
            ReQpVec->data[i] += creal(Qp);
            ImQpVec->data[i] += cimag(Qp);
            ReQcVec->data[i] += creal(Qc);
            ImQcVec->data[i] += cimag(Qc);
        }
    }
    *ret_ReQpVec = ReQpVec;
    *ret_ImQpVec = ImQpVec;
    *ret_ReQcVec = ReQcVec;
    *ret_ImQcVec = ImQcVec;
    return X_SUCCESS;
}

INT calc_QstrainSPA_Allemode(REAL8 MT, REAL8Vector *freqsVec, BBHCore *core, AntennaPatternF *apf,
    REAL8Vector **ret_ReQVec, REAL8Vector **ret_ImQVec)
{
    INT status;
    REAL8 vom;
    REAL8 et;
    REAL8 k, lval, tval;
    REAL8Vector *ReQVec = CreateREAL8Vector(freqsVec->length);
    REAL8Vector *ImQVec = CreateREAL8Vector(freqsVec->length);

    for (INT i=0; i < freqsVec->length; i++) {
        ReQVec->data[i] = 0;
        ImQVec->data[i] = 0;
    }

    INT n, m;
    COMPLEX16 Qp, Qc, QQ, AmpQp, AmpQc;
    REAL8 Fp, Fc, phase;
    REAL8 invsqpsiddot;
    for (INT ikl = 0; ikl < n_scpart_Func; ikl++) {
        m = scpart_Func_lkList[ikl][0];
        n = scpart_Func_lkList[ikl][1];
        for (INT i = 0; i < freqsVec->length; i++) {
            vom = Calculate_vom(n, m, freqsVec->data[i], core);
            et = calc_et_by_vom(vom, core->pms);
            SetBBHCoreDynVariables(et, vom, core);
            lval = Calculate_l(core);
            tval = Calculate_t(core);
            Fp = calculate_barFplus_t(MT*tval, apf);
            Fc = calculate_barFcross_t(MT*tval, apf);
            phase = (m + n*k)*lval - CST_2PI*tval*freqsVec->data[i] + CST_PI_4;
            k = calculate_k(core->var, core->pms);
            invsqpsiddot = calculate_invsqpsiddot(n, m, lval, core);
            // Qpc = calculate_QpcWaveform_emode(n, m, lval, core);
            status = calculate_QpcWaveform_eexp_emode(n, m, lval, core, &Qp, &Qc);
            AmpQp = CST_SQRT2PI * invsqpsiddot * Qp;
            AmpQc = CST_SQRT2PI * invsqpsiddot * Qc;
            // print_debug("vom = %.5e, et = %.5e, l = %.5e, t = %.5e, invsqpsiddot = %.5e, Qpc = %.5e + I %.5e\n",
            //     vom, et, invsqpsiddot, creal(Qpc), cimag(Qpc));
            QQ = AmpQp * cexp(I*phase) * Fp + AmpQc * cexp(I*phase) * Fc;
            // if (isnan(creal(QQ)) || isnan(cimag(QQ)))
            // print_debug("\n\tAmpQp = %.5e + I%.5e, phase = %.5e, Fp = %.5e\n\tAmpQc = %.5e + I%.5e, phase = %.5e, Fc = %.5e\n", 
            //     creal(AmpQp), cimag(AmpQp), phase, Fp,
            //     creal(AmpQc), cimag(AmpQc), phase, Fc);
                // print_debug("Q(%d,%d) = (%.5e + I %.5e)\n\tQp = (%.5e + I %.5e), Qc = (%.5e + I %.5e)\n",
                //         m, n, creal(QQ), cimag(QQ),
                //         creal(Qp), cimag(Qp),
                //         creal(Qc), cimag(Qc));
            ReQVec->data[i] += creal(QQ);
            ImQVec->data[i] += cimag(QQ);
        }
    }
    *ret_ReQVec = ReQVec;
    *ret_ImQVec = ImQVec;
    return X_SUCCESS;
}
